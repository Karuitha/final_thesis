---
#####################
## thesis metadata ##
#####################
title: |
  Empirical Evaluation of the Possible \
  Impacts of the Transformation of \
  Microfinance Institutions in Africa
author: John King'athia Karuitha
college: Graduate School of Business Administration
university: University of the Witwatersrand, Johannesburg
university-logo: templates/wits.jpg
submitted-text: A thesis submitted for the degree of
degree: Doctor of Philosophy in Finance
degreedate: "`r format(Sys.Date(), '%A, %B %d, %Y')`"
abstract: |
  `r paste(readLines("front-and-back-matter/_abstract.Rmd"), collapse = '\n  ')`
declaration: |
  `r paste(readLines("front-and-back-matter/_declaration.Rmd"), collapse = '\n  ')`
acknowledgements: |
  `r paste(readLines("front-and-back-matter/_acknowledgements.Rmd"), collapse = '\n  ')`
dedication: For my parents Justus King'athia and Veronicah Wanjiku; My daughter Veronicah Wanjiku; My siblings Margaret Njeri, Martha Wangari, Ann Nyaguthii, Caroline Wothaya, and Thomas Kimondo.
abbreviations: "front-and-back-matter/abbreviations" # path to .tex file with abbreviations

#######################
## bibliography path ##
#######################
bibliography: references.bib

########################
## PDF layout options ###
#########################
## submitting a master's thesis ##
# set masters-submission: true for an alternative, anonymous title page with 
# candidate number and word count
masters-submission: false
candidate-number: 123456
word-count: 10052

# if you want to use a different title page altogether, provide a path to a 
# .tex file here and it will override the default Oxford one
# alternative-title-page: front-and-back-matter/alt-title-page-example.tex

## correction highlighting ##
corrections: false

## binding / margins ##
page-layout: nobind #'nobind' for equal margins (PDF output), 'twoside' for two-sided binding (mirror margins and blank pages), leave blank for one-sided binding (left margin > right margin)

## position of page numbers ##
ordinary-page-number-foot-or-head: foot #'foot' puts page number in footer, 'head' in header
ordinary-page-number-position: C  #C = center, R = right, L = left. If page layout is 'twoside', O = odd pages and E = even pages. E.g. RO,LE puts the page number to the right on odd pages and left on even pages
chapter-page-number-foot-or-head: foot #you may want it to be different on the chapter pages
chapter-page-number-position: C

## position of running header ##
running-header: true #indicate current chapter/section in header?
running-header-foot-or-head: head
running-header-position-leftmark: LO #marks the chapter. If layout is 'nobind', only this is used.
running-header-position-rightmark: RE  #marks the section.

draft-mark: false # add a DRAFT mark?
draft-mark-foot-or-head: foot ##'foot' = in footer, 'head' = in header
draft-mark-position: C

## section numbering ##
section-numbering-depth: 3 # to which depth should headings be numbered?

## tables of content ##
toc-depth: 3 # to which depth should headings be included in table of contents?
lof: true # include list of figures in front matter?
lot: true # include list of tables in front matter?
mini-toc: true  # include mini-table of contents at start of each chapter? (this just prepares it; you must also add \minitoc after the chapter titles)
mini-lot: false  # include mini-list of tables by start of each chapter?
mini-lof: false  # include mini-list of figures by start of each chapter?

## code block spacing ##
space-before-code-block: 10pt
space-after-code-block: 8pt

## linespacing ##
linespacing: 22pt plus2pt # 22pt is official for submission & library copies
frontmatter-linespacing: 17pt plus1pt minus1pt #spacing in roman-numbered pages (acknowledgments, table of contents, etc.)

### other stuff ###
abstractseparate: false  # include front page w/ abstract for examination schools?
hidelinks: false # false to highlight clickable links with a colored border
includeline-num: false

### citation and bibliography style ###
bibliography-heading-in-pdf: References

# biblatex options #
# unless you run into 'biber' error messages, use natbib as it lets you customise your bibliography directly
use-biblatex: true
bib-latex-options: "style=authoryear, sorting=nyt, backend=biber, maxcitenames=2, useprefix, doi=true, isbn=false, uniquename=false" #for science, you might want style=numeric-comp, sorting=none for numerical in-text citation with references in order of appearance

# natbib options #
# natbib runs into fewer errors than biblatex, but to customise your bibliography you need to fiddle with .bst files
use-natbib: false # to use natbib, set this to true, and change "output:bookdown::pdf_book:citation_package:" to "natbib"
natbib-citation-style: authoryear #for science, you might want numbers,square
natbib-bibliography-style: ACM-Reference-Format #or plainnat or some .bst file you download



#####################
## output options  ##
#####################
output:
  bookdown::pdf_book:
    citation_package: biblatex
    template: templates/template.tex
    keep_tex: true
    pandoc_args: "--lua-filter=scripts_and_filters/colour_and_highlight.lua"
  bookdown::bs4_book: 
    css: 
      - templates/bs4_style.css
      - templates/corrections.css # remove to stop highlighting corrections
    theme:
      primary: "#6D1919"
    repo: https://github.com/ulyngs/oxforddown
    pandoc_args: "--lua-filter=scripts_and_filters/colour_and_highlight.lua"
  bookdown::gitbook:
    css: templates/style.css
    config:
      sharing:
        facebook: false
        twitter: yes
        all: false
  bookdown::word_document2:
    toc: true   
link-citations: true
documentclass: book
always_allow_html: true #this allows html stuff in word (.docx) output
# The lines below make the 'knit' button render the whole thesis to PDF, HTML, or Word
# When outputting to PDF, you can clean up the files LaTeX generates by running 
# 'file.remove(list.files(pattern = "*.(log|mtc|maf|aux|bbl|blg|xml)"))' in the R console
knit: (function(input, ...) {bookdown::render_book(input, output_format = "bookdown::pdf_book")})
#knit: (function(input, ...) {bookdown::render_book(input, output_format = "bookdown::bs4_book")})
#knit: (function(input, ...) {bookdown::render_book(input, output_format = "bookdown::gitbook")})
#knit: (function(input, ...) {bookdown::render_book(input, output_format = "bookdown::word_document2")})
---


```{r install_packages, include=FALSE}
source('scripts_and_filters/install_packages_if_missing.R')
```

```{r create_chunk_options, include=FALSE, eval=knitr::is_latex_output()}
source('scripts_and_filters/create_chunk_options.R')
source('scripts_and_filters/wrap_lines.R')
```

<!--
Include the create_chunk_options chunk above at the top of your index.Rmd file
This will include code to create additional chunk options (e.g. for adding author references to savequotes)
and to make sure lines in code soft wrap
If you need to create your own additional chunk options, edit the file scripts/create_chunk_options.R
-->

<!-- This chunk includes the front page content in HTML output -->
```{r ebook-welcome, child = 'front-and-back-matter/_welcome-ebook.Rmd', eval=knitr::is_html_output()}
```

<!--chapter:end:index.Rmd-->

---
#########################################
# options for knitting a single chapter #
#########################################
output:
  bookdown::pdf_document2:
    template: templates/brief_template.tex
    citation_package: biblatex
  bookdown::html_document2: default
  bookdown::word_document2: default
documentclass: book
bibliography: references.bib
always_allow_html: true
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
- \usepackage[default]{sourcesanspro}
- \usepackage[T1]{fontenc}
- \usepackage{amsmath}
- \usepackage{dcolumn}
- \usepackage{url}
---

```{block type='savequote', quote_author='(ref:cicero-quote)', include=knitr::is_latex_output()}
“Asking for investors to come is the wrong direction completely. … If you are inviting investment from the market, they are looking for their return. That is the wrong message. Micro-credit should not be presented to investors as a ground for making a lot of money out of the poor people – that is a shame."
```
(ref:cicero-quote) --- Prof. Muhammad Yunus.

<!-- 
Notes for adding an opening quote in PDF output:
i) add the reference for the quote with the chunk option quote_author="my author name",
ii) include=knitr::opts_knit$get('rmarkdown.pandoc.to') == 'latex' means that these quotes are only included when output is latex (in HTML output, it would appear by the end of the previous page)
iii) You can't use markdown syntax inside chunk options, so if you want to e.g. italicise a book name in the quote reference use a 'text reference': Create a named piece of text with '(ref:label-name) My text', then link to this in the chunk option with quote_author='(ref:label-name)'
-->

# Introduction {#Introduction}
\minitoc <!-- this will include a mini table of contents-->

<!-- LaTeX normally does not indent the first line after a heading - however, it does so after the mini table of contents. You can manually tell it not to with \noindent -->

## Background to the Study
```{r, echo = FALSE, message = FALSE, warning = FALSE}

library("pacman")
library("bookdown") 
library("broom") 
library("car") 
library("caret") 
library("corrplot") 
library("dtplyr")
library("excelR") 
library("GGally") 
library("ggalt") 
library("ggeasy") 
library("gghalves") 
library("ggrepel")  
library("ggthemes") 
library("gmnl") 
library("gmodels") 
library("gplots") 
library("gridExtra") 
library("gtable")
library("here") 
library("janitor") 
library("kableExtra") 
library("knitr") 
library("lme4") 
library("lmtest")
library("magrittr") 
library("margins") 
library("mice") 
library("nnet") 
library("pacman") 
library("patchwork") 
library("pcse")
library("pglm") 
library("plm") 
library("prettydoc") 
library("pROC") 
library("psych") 
library("Rchoice") 
library("rDEA")
library("readxl")
library("rmarkdown") 
library("skimr") 
library("stargazer") 
library("tidymodels") 
library("tidyverse")
library("treemapify") 
library("viridis") 
library("wesanderson") 
library("zoo")

#########################################
options(digits = 3)
options(scipen=999)
options(knitr.kable.NA = "-")
theme_set(ggthemes::theme_clean())
#########################################
```

\noindent Advocates of Microfinance institutions (MFIs) hail the industry for availing financial services to the poor and the financially excluded. Data from 2015, for example, shows that MFIs disbursed \$92.4 billion to 116.6 million borrowers and accepted $58.9 billion from 98.4 million depositors [@market2014global]. Supporters of Microfinance (MF) further associate it with improved household welfare [@meador2017food; @you2013role], increased purchasing power and a higher employment rate [@raihan2017macro; @lopatta2016microfinance]. Also, MF supporters contend that it leads to improved gender parity [@mafukata2017reciprocal; @zhang2017microfinance] and enables families to cope with the effects of climate change [@fenton2017role] among other benefits ^[The quotation comes from an interview of Professor Muhammad Yunus. The video is available at <https://nextbillion.net/an-interview-with-muhammad-yunus/>]. 

Other researchers, however, have uncovered mixed outcomes from Microfinance (MF) interventions. For example, @ganle2015microcredit found that while some women indeed get empowered due to access to credit, most have little control over the subsequent spending. At the same time, a significant proportion suffers harassment from MF agents' for failing to repay the loans. @van2012impact also arrive at a similar conclusion.

On the other extreme, some scholars dispute the benefits of MF altogether. For instance, some researchers posit that MF does not boost employment and education among the rural poor [@bauchet2013micro]. Other researchers link micro-credit to increased child labour [@hazarika2008household], raised gender inequalities in access to finance [@zulfiqar2017does], and reduced entrepreneurial spirit among the poor [@field2013does]. The apprehension around the high interest rates charged by MFIs and inappropriate lending practices that fail to account for the target clients' social, cultural, and economic context is also gaining prominence [@chester2016one]. Taken together, the case against MF paints a bleak future of MF. Some studies recommend a re-examination of the MF business model and call for better industry regulation [@johnson2013microfinance; @ghosh2013microfinance]. Without reforms, conclude @chester2016one, "the MF industry could not only ruin the lives of many borrowers but also ruin itself" (pp. 28). 

Despite these contradicting views, MFIs continue to attract interest from governments, state agencies, donor organisations, philanthropists and increasingly commercial capital providers. Initially, MFIs ran on the non-governmental organisation (NGO) model relying chiefly on donors to finance their operations [@d2017ngos]. The NGO oriented model has emphasised the social mission of MFIs- that is, availing financial services to the poor and the financially excluded [@ashta2012compartamos]. The model played down the profit motive [@ashta2012compartamos]. 

However, some MFIs have been transforming their institutional structure from NGOs to commercial entities [@d2017ngos]. This study evaluates the possible impacts of the transformation of MFIs on their financial sustainability and outreach to the financially excluded. The shift happens when an MFI converts from a donor-funded NGO to a regulated financial institution (RFI) that derives its capital primarily from commercial sources. The rationale for the transformation is that it would enable MFIs to access commercial sources of capital and lead to improved financial sustainability, efficiency, and social performance [@louis2013financial]. 

Other benefits of the transformation include improved customer service, a more extensive range of products, and enhanced control and governance[@srnec2008transformation]. Consumers and other stakeholders would also reap the benefits of regulating MFIs directly [@meagher2006microfinance] and indirectly [@hartarska2007regulated]. Nevertheless, the process of transformation is complicated and dependent on the country-specific regulatory framework. Thus, although most research delineates a point in time when an MFI ceases to be an NGO and becomes a commercial entity, there are essential preparations before the transformation that are often overlooked [@d2017ngos]. 

The transformation of MFIs leads to a change in their capital structure and hence, governance. As research in corporate finance indicates, there is a link between the capital structure of corporations and their financial performance. For example, family-owned businesses with lower leverage exhibit higher profitability [@hamid2015capital] in line with the pecking order theory of capital structure. Other studies indicate that leverage is positively related to performance [@fosu2013capital;@berger2006capital], including MFIs [@kar2012does] in line with the agency theory. The effects of capital structure on financial performance may vary across industries, regions, and even depending on the performance metric chosen.

However, MFIs have a double bottom line. Transformed MFIs strive to perform well financially as well as socially. Turning a profit enables MFIs to be sustainable going concerns. On the other hand, social performance is the source of legitimacy for MFIs and the critical reason for receiving donations and subsidies. MFIs should offer financial services to the section of the population neglected by the mainstream financial institutions. The existence of a social mission and financial goals makes it harder to evaluate the effects of capital structure on MFI performance compared to purely commercial firms. 

There is an extensive body of research on the effects of the transformation of MFIs. Much of this research has compared the performance of MFIs before and after the conversion. There is a consensus that the conversion of MFIs can affect both the financial and social performance of the transformed MFIs [@chahine2010social; @mersland2010microfinance]. However, there is disagreement regarding the direction and magnitude of the effects of transformation [@mersland2010microfinance; @d2017ngos]. 

Similarly, the few studies that examine the effects of the resultant capital structures of the transformed MFIs on their performance have uncovered mixed results. For instance, @bogan2012capital established that the use of grant capital by MFIs led to decreased sustainability and operational self-sufficiency. @hoque2011commercialization and @kar2012does reveal a negative relationship between leverage and outreach, whereas @kyereboah2007determinants finds the opposite using data from Ghana. Accordingly, this study examines the determinants of financing sources by MFIs in Africa.

For MFIs that have transformed, researchers have yet to establish the factors that influence their level of sustainability and outreach. Much of the research examines financial and social performance separately instead of being the two sides of the same coin. Moreover, although a substantial number of MFIs have transformed, some still operate as NGOs. Little research that questions why some MFIs convert while others retain the NGO model. If financial sustainability for MFIs is so desirable, then it is not apparent why some MFIs would stick to an NGO, not-for-profit model that is not sustainable. 

In light of the highlighted deficiencies, this study has the broad objective of evaluating the possible impacts of the institutional transformation of Microfinance institutions in Africa. The study utilises a sample dataset comprising 775 MFIs from 40 countries in Africa available. The data is available from the Microfinance Information Exchange (MIX) and the MIX market database of the World Bank.

## NGOs to Banks: Rationale for Transforming MFIs
\noindent Critics of the NGO based model of MFIs cited its unsustainability and blamed it for crowding out alternative providers of MF services [@kota2007microfinance] while masking internal inefficiencies in MFIs [@caseau2020impact]. Moreover, donors could not be relied upon to fund MFIs indefinitely. Also, dependence on donor funding left the MFIs exposed to global macroeconomic shocks [@d2017ngos], which spread across countries through the financial system [@schnabl2012international]. For instance, the global financial crisis led to a decline in development assistance and capital flows to developing countries which, in turn, affected MFI financing [@leach2012global; @wagner2013vulnerability]. 

Thus, in the absence of alternative sources of finance, MFIs are likely to experience funding shortages in crisis periods [@constantinou2011financial]. Additionally, researchers have uncovered a link between countries' state of bilateral political relationships and the flow of funds to MFIs [@garmaise2013cheap]. Consequently, a diplomatic or trade row could also affect the flow of funding to MFIs, especially in the characteristically vulnerable developing countries.  Thus, the NGO model is not only unsustainable but also susceptible to both political and economic dynamics. 

This backdrop was a realisation that availing financial services to the poor could be pursued as a profit-based value proposition [@rhyne1999microfinance]. The introduction of the profit element meant that MFIs could carry out their services without relying extensively on donations and subsidies [@duvendack2015mis]. In the long run, the sustainability arising from the transformation of MFIs would enable them to expand access to financial services to the poor and the financially excluded [@brown2012microfinance; @sarma2011ngo]. However, given that the central focus of MF was on the poor, researchers began to question the compatibility of the pro-poor agenda of MFIs with the profit-oriented school of thought. At the heart of the debate, which continues to date, is that commercialisation of MFIs could result in mission drift ^[mission drift occurs when, upon the conversion from the NGO to the commercial model, the MFIs place more emphasis on attaining the financial objectives. This leads to a reduced focus on the social goals of MFI of alleviating poverty by availing financial services to the poorest of the poor and the financially excluded segments of the society.]  away from serving the poor in pursuit of profits [@im2015profits; @mia2017mission]. 

Literature is abundant on the question of whether the transformation of MFIs causes mission drift. Some studies assume that the transformation results in mission drift [@mia2017mission; @wagenaar2012institutional; @lopatta2017sustainable; @roberts2013endogeneity]. Other scholars find the transformation beneficial or at least not causing mission drift [@im2015profits;@lutzenkirchen2012microfinance; @quayes2012depth; @mersland2010microfinance]. Another strand of related research uncovers both positive and negative results from the transformation[@kar2012does;@caudill2009microfinance]. There is also lots of research on the effects of the conversion on social versus financial outcomes and efficiency [@bogan2012capital; @kar2012does; @tchuigoua2014institutional; @khachatryan2017performance]. However, little research has probed the questions raised in this study. The following section is an overview of the transformation of MFIs globally and in Africa.

## Overview of the Transformation of MFIs
\noindent In 1992, PRODEM, an MFI in Bolivia converted into Bancosol, a commercial bank. This change marked the beginning of the transformation of MFIs to commercial entities. Since then, numerous MFIs have transformed (Table 1.1.). Most of the initial MFIs transformed into commercial banks or finance companies, apart from Card Rural Bank, which changed to a rural bank and Banco ADEMI, which turned into a commercial development bank. This trend has been consistent to this day. Beyond the MFIs highlighted in Table 1.1, other MFIs that have transformed outside Africa include BRAC (Bangladesh) and ACLEDA (Cambodia).      

```{r, echo = FALSE}
library(tibble)

tribble(~ NGO_name, ~ New_name, ~ New_structure, ~ CountryYear, 

"PRODEM", "BANCOSOL", "Commercial Bank", "Bolivia, 1992",

"CORPOSOL", "FINANSOL", "Commercial Finance Company", "Colombia, 1993",

"AMPES", "Financiera Calpia", "Finance Company", "El Salvador, 1995",

"PRO CREDITO", "Caja Los Andes", "Finance Company", "Bolivia, 1995", 

"CARD", "CARD Rural Bank", "Rural Bank", "The Philippines, 1995",

"ADEMI", "Banco-ADEMI", "Commercial Development Bank", 
  
  "Dominican Republic, 1998", 

"ACP", "MIBANCO", "Commercial Bank", "Peru, 1998", 

"K-REP", "K-REP Bank", "Commercial Bank", "Kenya, 1999") %>% 
  
  kableExtra::kbl(., caption = "Sample of Transformed MFIs Globally", 
      
  booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  kableExtra::footnote(general = "Source: Campion and White (1999)",
           
  general_title = "")
```

In Africa, many MFIs have changed to commercial entities from the year 2000 and beyond. In Uganda, for instance, the Bank of Uganda granted an operating license to Uganda Microfinance Union (UMU) three years after starting off the road to the transformation. Several MFIs have transformed into commercial entities in Kenya, including Faulu (2010) and the Kenya Women Finance Trust (2010). OIBM in Malawi (2002), PRIDE (2009) in Tanzania and OI-SASL (2013) in Ghana has also transformed into commercial entities.

The examination of the transformation of the MF industry should sensibly start with the review of the changing landscape in the national financial sectors. Typical characteristics of financial sectors in most countries include Intense competition, increased innovation, and rapid technological changes. Consequently, the MF services space is no longer the preserve of MFIs. The industry has attracted mainstream commercial banks, MF-oriented commercial banks, credit unions, building societies, and insurance companies. Financial technology (FinTech) firms have also come in (individually or in partnership with mainstream financial institutions) by offering mobile ^[An example of this is M-Shwari, a mobile-based platform operated by Safaricom and the Commercial Bank of Africa. It allows customers to save and borrow money using their mobile phones. The savings also attract interest.], internet-based ^[Kiva Micro funds (commonly referred to as kiva.org) is an example of an internet-based MF services provider. KIVA operates in more than 80 countries, offering microloans to end poverty. Other examples include Branch (branch.co) and Tala (tala.co).]  MF service and peer-to-peer/crowdlending ^[Peer to peer lending, also called crowdlending, is a system where loan applicants are connected to investors with cash to lend through an online platform. Note that the platform providers do not take deposits or lend out their money but link borrowers to prospective lenders. Cumplo and prosper.com are among the prominent examples of these kinds of MF services providers.]  (Table 1.2). Although some researchers have argued that the digital divide could limit the effectiveness of FinTech based MFIs outfits [@yartey2017subaltern; @fd2017], the prevalence of low-cost smartphones indicates that digital MF could be the future of the industry [@yum2012wisdom]. To sum up, the changing MF landscape means that MF providers have to streamline their operations to improve their efficiency and maintain relevance in the market. 

Furthermore, although MF was initially targeted at the poorest of the poor, predominantly living in remote rural villages where mainstream banks could not reach, MFIs now target all the financially excluded individuals. Thus, MFIs (and their competitors) offer MF services in urban areas and even operate in developed countries [@kota2007microfinance]. This paradigm shift has had several implications. For example, there has been a rise of microfinance-oriented commercial banks that were never MFIs initially. In other cases, some commercial banks have acquired MFIs, and thus incorporated them into the mainstream commercial banking portfolio. In some other instances, there have also been mergers between an MFI and a commercial bank ^[Equity Bank in Kenya is an example of a microfinance oriented commercial bank. MFIs such as CONFIE in Nicaragua and Genesis in Guatemala arose from mergers between an MFI and a commercial bank.]. 

Moreover, there have been mergers between MFIs. In the most extreme cases, MFIs have converted entirely into commercial banks and have been duly regulated under banking laws. This rapidly shifting landscape may also inform the need for MFIs to transform to efficiently compete in a market gaining traction amongst players from mainstream financial industries.

```{r, echo = FALSE}
tribble(~ MF_Provider, ~ Country, ~ Platform,
        
          "KIVA Microfund", "Global", "The Internet",
        
          "Stonehenge Telkom", "Global", "The Internet/ Mobile",
        
           "M-Shwari", "Kenya", "Mobile", 
        
            "AYE Microfinance", "India", "The Internet/ Mobile", 
        
            "CUMPLO", "Chile", "The Internet (Peer to peer)", 
        
            "Prosper.com", "USA", "The Internet (Peer to peer)", 
        
           "Popfunding.com", "South Korea", "The Internet (Peer to peer)") %>% 
  
  kableExtra::kbl(., caption = "Sample of Internet and Mobile MF Providers", 
      
  booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' Compilation from the Literature", 
           
           general_title = "")
```

The transformation of MFIs is not without its challenges. In a particularly extreme case, the conversion of MFIs to for-profit entities was declared unconstitutional in Kosovo [@hasani2013ustav] ^[The Kosovar Civil Society Foundation (KCSF), FOL Movement, Kosovo Democratic Institute (KDI) and 55 NGOs filed a suit challenging the legality of the conversion of Microfinance NGOs into joint-stock companies. In 2013, the transformation was declared unconstitutional in the Republic. The full judgement is available on the following site, http://www.gjk-ks.org/repository/docs/KO97_12_AGJ_ANG.pdf]. Also, three additional categories of problems arise in converting MFIs into for-profit legal corporations: the integration into the formal financial system, ownership and governance, and organisational development [@campion1999institutional]. The integration of the transformed MFIs into the formal financial system raises several challenges. For example, the political and economic environment determines the timing of successful transformations. Thus, the economic and political climate is an essential factor to consider [@kenya2012transforming]. 

Transformation also implies setting up a board that oversees the running of the organisation. The board typically sets the mission and vision of the organisation as well as its investment strategy. Thus, an ineffective board could hinder the implementation of transformation [@campion1999institutional] and even the performance of an MFI post-transformation. Lastly, issues such as the organisational culture and human resource development are critical to a successful transition. For most MFIs that have moved from the NGO model, the management has to alter the organisation's culture to cater to a commercial, and thus, a more customer-centric orientation [@christen2001commercialization]. These adjustments have resulted in substantial costs of training and mentorship.

## Motivation for the study
\noindent Different schools of thought hold differing views regarding the potential consequences of the transformation of MFIs. The sustainability perspective ^[The sustainability approach to the provision of microfinance is also called the financial systems approach. The approach assumes that the integration of MF with the mainstream financial sector is the only way to ensure that MF could achieve extensive outreach without continued donor dependency [@rhyne1999microfinance] considers the transformation as desirable for MFIs to attain financial self-sufficiency. On the other hand, the welfare standpoint sees the transformation as conflicting with the social mission of MFIs. The win-win approach attempts to reconcile both the welfare and the sustainability perspectives by bringing together the potential benefits from both schools of thought [@kodongo2013individual]. The debate between the three schools of thought has dominated the research on the institutional transformation in MFIs. 

A broad range of research has documented the institutional change in the MF industry (prominent first examples include,@ledgerwood1998microfinance and @ledgerwood2006transforming). The subsequent studies examined the effects of the change on the trade-off between financial sustainability and social performance. A remarkable pioneering example of research in this area is that of @frank2008stemming, who found that transformation led to a higher client outreach, higher growth in the loan portfolio, and higher product diversification. More importantly, they established that conversion allowed more women customers to access services, although the overall percentage of women receiving the services declined. Subsequent studies support their view, for example, [@hartarska2012governance; @bos2015practice ;@d2017ngos]. 

A substantial extension of studies on the transformation of MFIs has examined the financing structures in the transformed MFIs. There are mixed outcomes from the research. For instance, [@bogan2012capital] examined the relationship between capital structure and MFI efficiency and sustainability. The study uncovers a link between capital structure, MFI size, and financial performance. Specifically, there is a negative relationship between the use of grants and financial performance. These results are close to the outcomes of the research by [@hudon2011efficiency]. They also found a positive relationship between grant financing and financial performance, which turns negative beyond a certain threshold, in line with @d2017ngos. 

A related study by @kar2012does found no relationship between debt financing and breadth of outreach and women participation as loan clients and recommended research along this line about equity financing. Subsequent analysis has not resolved this stalemate [@hoque2011commercialization; @kyereboah2007determinants; @khachatryan2017performance; @d2017ngos]. The mixed outcomes from previous studies motivate the focus on the effects of capital structure on the performance of MFIs in this research. 

Much of the existing strand of research on MFI transformation stems from the perceived possibility of mission drift by MFIs that have undergone the change from the NGO based model to the commercial model. The primary manifestation of the transformation has been the domination of debt, deposits, and equity in the capital structure of the transformed MFIs (The Microfinance Information Exchange, 2017). Figure 1.1 shows the funding structure of 1330 MFIs globally that avail their data to the MIX pooled database. The regional disparity in the financing structure is particularly striking. In Latin America and the Caribbean (LAC), Eastern Europe and Central Asia (ECA), East Asia and the Pacific (EAP), and Africa, MFI source their capital mainly from deposits. In contrast, MFIs in South Asia get most of the capital from borrowings. In North Africa and the Middle East, debt and equity are equally likely to be a source of funding for MFIs. 

Except for the MENA region, equity consistently consists of less than 25% of the funding of MFIs, with the figure being lowest in Africa (18%), LAC (18%), and ECA (16%). Debt is a chief funding source compared to equity, with four of the six regions having debt accounting for more than 25% of the total funding. The exception is Africa and LAC, where borrowings account for 11% and 18% of the total financing. Notable also is the tiny proportion of deposits to total capital observed in the MENA region. The regional disparity in financing patterns for MFIs provokes several questions. Why is there such a regional disparity in capital structures among MFIs? 

Moreover, in the African setting, do such regional disparities exist? If the disparities exist, then what explains the differences? This study also seeks the determinants of the observed financing structures among transformed MFIs to inform policy-making for the MF sector and target the entire capital market. This study addresses this open issue from the capital structure perspective regarding the financing of hybrid organisations.   

The examination of the drivers of the financing structure of MFIs is necessary because the transformation of MFIs implies that both the proportion and the importance of donor funding would be declining in most MFIs. The increasing importance of commercial financing from the commercial interest perspective should be the foundation from which researchers examine whether or not transformed MFIs are achieving financial sustainability and social mission. It is only when such research establishes how the business orientation affects the social mission of MFIs that the need for corrective action gets flagged timeously.

```{r, echo = FALSE, fig.cap="Funding structure of MFIs Across the Globe by Region (2015)"}
tribble(~ Region, ~ Equity, ~ Deposits, ~ Borrowings,
        
        "South Asia", "0.23", "0.34", "0.43", 
        
        "MENA", "0.43", "0.14", "0.43", 
        
        "LAC", "0.18", "0.64", "0.18", 
        
        "ECA", "0.16", "0.53", "0.31", 
        
        "EAP", "0.23", "0.50", "0.26", 
        
        "SSA", "0.18", "0.70", "0.11") %>% 
  
  pivot_longer(cols = -Region, 
               
               names_to = "Source", values_to = "Proportion") %>% 
  
  mutate(Proportion = as.numeric(Proportion)) %>% 
  
  ggplot(mapping = aes(x = fct_reorder(Region, Proportion, max), y = Proportion, fill = Source)) + 
  
  geom_col(position = "fill") + 
  
  labs(x = "Proportion", y = "Region", 
       
       title = "Sources of Capital for MFIs", 
       
       caption = "Source: Authors construction from MIX data") +
  
  theme(legend.position = "bottom") +
  
  scale_fill_brewer(palette = "Dark2") +
  
  coord_flip()
```

Although the transformation of NGOs has its merits, most MFIs have still not transformed[@d2017ngos]. Therefore, the key outputs of this study are the motives behind some MFIs transforming while other MFIs retain the NGO model. The current literature has been overly concerned with the transformed MFIs and has not addressed this issue. Even among the transformed MFIs, researchers have not uncovered the drivers of the decision by MFIs to change and the necessary preconditions for transformation. The existing research takes for granted that MFIs transform to be sustainable. Given the benefits of transformation touted in the numerous studies, then most MFIs should have already converted. 

Moreover, as @morduch2019challenges argues, if there is no trade-off between financial performance and social performance of transformed MFIs, NGOs would not exist. However, this is not the case. Therefore, it appears that some additional factors influence the decision by MFI to either transform or retain the NGO model. As noted, there is no conclusive evidence on the effects of MFI transformation on their performance. These contradicting results could be because of numerous unknown reasons. It is in order, therefore, to establish the factors that influence the sustainability and outreach of transformed MFIs. Similarly, establishing the factors that moderate the relationship between capital structure on the one hand and the financial performance and social performance of MFIs in Africa is a novel contribution to the research. 

Recent literature also suggests that the performance of MFIs is dependent on the broader macroeconomic conditions as well @ahlin2011does, and is country-specific [@d2017ngos]. Thus, in the analysis of the institutional transformation of MFIs, cross-country and regional differences must be factored in. However, most studies have not considered the cross country and regional variations. Failure to consider regional disparities means that the extant research fails to capture local contextual peculiarities. 

These regional differences motivate the choice of MFIs in Africa as the unit of analysis. By focusing on Africa, the study isolates the regional and country heterogeneity of the effects of transformation. This issue could have affected the results of research based on pooled global datasets. Thus, the output of the study are unique to Africa and therefore more actionable. To sum up this section, the study significantly extends the existing literature on MFI transformation. The following section outlines the purpose statement.

## Purpose Statement
\noindent This research evaluates the transformation of MFIs in Africa and how this transformation impacts the financial and social performance of MFIs and financial inclusion on the continent. 

## Research Questions
\noindent The study specifically seeks answers to the following research questions.

1.	Why do some MFIs in Africa transform into the commercial model while others retain the NGO Model?
2.	To what extent has the institutional transformation of MFIs in Africa affected financial inclusion?
3.	After transformation, what factors explain the joint level of sustainability and outreach by MFIs in Africa?
4.	What are the drivers of financial efficiency, social efficiency and socio-financial efficiency of MFIs in Africa?
5.	What are the factors that influence the choice of financing sources by transformed MFIs in Africa? 


## Significance of the Study
\noindent In pursuing the stated objectives, this study fills a theoretical deficiency in the capital structure of quasi-commercial organisations that have a social dimension of value. The context of shareholder and debt holder importance was the foundation of capital structure and agency theories. Arguments from this genesis have not factored in corporations with extra dimensions of value, such as achieving social goals. As a case in point, `Modigliani and Miller` capital structure theory may not be entirely applicable to MFIs where value also has a social facet. In the Modigliani and Miller capital structure theory, the value of a firm is the sum of equity and debt components in the capital structure of a corporation. The value of a company is an increasing function of the debt proportion of capital structure up to the point where the costs of financial distress outweigh the benefits of the interest tax shield. The empirical output has implications on policy direction relating to MFIs in Africa. 

The study also has a variety of policy implications. These policy implications are related to the research objectives. For instance, what are the factors that drive MFIs to transform or fail to transform? The answer to this question would inform the crafting of supportive policies if transformation is indeed desirable. Similarly, uncovering the drivers of financial inclusion, outreach, and sustainability of MFIs after the conversion would inform policy-making supporting financial inclusion. Establishing the determinants of financing sources would allow policy-making to ease fundraising by MFIs. If the drive for institutional transformation is to achieve the desired effects, then the change in the MFI funding structures must not compromise social objectives. If the conversion of MFIs negatively affects social performance, there would be no way to justify the transformation of MFIs. The change of MFIs should improve their sustainability, but not to the detriment of social performance. 

Also, if the transition results in a decline in social performance, then the transformation could be treated as the transition point of transformed MFIs into the mainstream banking system [@kent2013bankers]. Therefore, it is crucial to investigate the outcomes of the change to inform the design of a framework that would not expose the poor and financially excluded to the same level of exclusion by the financial system that MFIs ought to address. Doing this would be equivalent to allowing MFIs to use the underprivileged as a ladder to climb into the mainstream system and abandoning them shortly after, which raises ethical questions. Similarly, identifying factors that influence the choice of financing structures has implications for the design of policies aimed at the capital market. For the same reasons, identifying factors that influence the social performance of transformed MFIs is also helpful, not just for policy design but also for managerial decision making. 

Finally, the efficiency of MFIs is a significant determinant of both the financial and social performance of MFIs. According to the efficiency theory, the positive relationship between concentration and profitability is indicative of the tendency of firms that are efficient to be successful and hence dominant in their industries [@lipczynski2005industrial]. Efficiency gains could result from economies of scale and cost-saving schemes initiated by the management. Enhanced efficiency by MFIs is, therefore, desirable. However, the efficiency of MFIs should encompass both financial and social dimensions. The entry of commercial sources of capital may affect both the financial and social efficiency of MFIs in line with agency theory. Therefore, it is vital to establish the relationship between capital structure and efficiency to inform both the management and stakeholders of the dynamics in the MFI sector regarding effectiveness in the new era of commercial funding.

## Key Findings of the Research
The research examined the transformation of MFIs in Africa. In this section, I summarize the findings for each of the research questions. 

1. *Why do some MFIs in Africa transform into the commercial model while others retain the NGO Model?*

In addressing this research question, I applied logit, probit and multinomial logit models to evaluate the factors that drive NGO-type MFIs to convert to commercial profit-oriented MFIs. The results show that at the firm level, age and size influence transformation. Legal tradition, institutional quality, and stock market development are significant factors at the country level. Specifically, larger and older MFIs are less likely to be NGOs. These results suggest that as MFIs mature, they tend to convert to the commercial model either due to pressure from donors or the decision by management to pursue the double bottom line as they get more financially sustainable and as donor support subsides. MFIs in civil law countries are also less likely to be NGOs, while those in countries that follow other legal traditions are more likely to adopt the commercial model. Again,  Institutional quality raises the chances of MFI conversion to the commercial model. Institutional quality captures a wide range of governance measures that enhance contract enforcement and property rights. Hence, countries with stronger institutions tend to attract more private investments and hence the higher rate at which MFIs adopt the commercial model. Stock market capitalisation and private credit to GDP have a negative relationship with transformation. The development of capital markets corresponds to better access to financial services, a pre-condition for financial inclusion. Hence, MFIs in countries with well-developed financial markets will likely be competing against established financial intermediaries for the existing market. The competition limits the financial viability of MFIs. Hence, MFIs in these markets will likely remain NGOs that serve small population in the fringes of the market. 


2. *To what extent has the institutional transformation of MFIs in Africa affected financial inclusion?*

In this analysis, I used the fixed effects and random effects models to examine how the transformation of microfinance institutions to the profit-oriented model has affected financial inclusion in Africa. I used three indicators of financial inclusion. To the proxy depth of MFI outreach, I used the per cent of female borrowers and average loan balance per borrower. Gross loans to total assets proxied the breadth of outreach. The primary independent variable was the legal form of MFIs: NGOs, NBFIs, commercial banks, cooperatives and rural banks. The control variables were age, region, operating expense to assets ratio, donations to assets ratio, capital to assets ratio, asset structure, MFI size (logarithm of assets), education and profit margin. Our results show that the change from the NGO model to the commercial models could negatively affect the depth of financial outreach, especially given that NGOs characteristically have better outreach to women and advance smaller denomination loans on average than for-profit MFIs. Also, NGOs have higher median gross loans to assets ratio than other legal forms of MFIs except for credit unions/cooperatives. Overall, the results indicate the potential mission drift, where MFIs that convert to the for-profit model focus more on financial sustainability to the detriment of outreach to the unbanked. 

3. *What are the drivers of financial efficiency, social efficiency and socio-financial efficiency of MFIs in Africa?*

In this objective, I examined the drivers and levels of financial efficiency, social efficiency, and socio-financial efficiency of microfinance institutions (MFIs) in Africa for 2000-2019. I estimated MFI financial efficiency, social efficiency, and joint financial and social efficiency (socio-efficiency) of MFIs in Africa using the output-oriented Data Envelopment Analysis (DEA). The inputs to the DEA model were equity and liabilities and operating expenses to assets ratio. The social performance outputs in the DEA model were the per cent of female borrowers and the average loan balance per borrower, noting that a lower average loan balance corresponds to deeper outreach. Operational self-sufficiency, a ratio of revenue to operating expenses, was the corresponding financial output measure. I then bootstrapped the efficiency scores. These scores were the dependent variables in the subsequent fixed and random effects regressions. Broadly, our results show a trend of declining financial efficiency by MFIs but no discernible trend in social and socio-financial efficiency. However, NGOs have markedly better social efficiency and socio-financial efficiency scores than other legal forms of MFIs. Surprisingly, only cooperatives and rural banks consistently outperform NGOs financially. The proxies for financial sector development, stock market capitalization to GDP and private credit to GDP,  have a negative relationship with social and socio-financial efficiency. Financial efficiency has an inverse relationship with both the size and asset structure of MFIs. These results suggest that the commercialization of MFIs does not necessarily improve their financial sustainability.


4. *After transformation, what factors explain the joint level of sustainability and outreach by MFIs in Africa?*

Drawing from the classification matrix by @chattopadhyay2017applicability I examined the extent to which MFIs in Africa meet their dual objectives and the factors that drive the attainment of financial and social goals. I captured social goals using the per cent of female borrowers, while the operational self-sufficiency (OSS) captured financial performance. The code zero captured MFIs with a proportion of female borrowers greater or equal to 0.5, and an OSS of at least one. MFIs that did not meet any of these thresholds took a code of one. The other two categories (2 and 3) captured MFIs that achieved one goal and failed in the other. I applied a multinomial logit model. The results show that most MFIs in Africa attain the dual objectives, at 35.88% compared to 14.76% that fail in both missions. 23.85% fail socially but succeed financially, and 25.55% succeed socially while failing financially. In total, 61.43% of MFIs attain their social goals. 40.31% fail financially. However, these results vary across the legal status of an MFI. Rural banks and NGOs are more likely to achieve the dual goals than banks, NBFIs and credit unions. Accordingly, the legal status of an MFI is the most significant driver of the extent of the achievement of the dual goals. NGOs have the highest likelihood of achieving both financial and social goals. This result highlights the risk of mission drift should MFIs convert to the for-profit model. Larger MFIs have a higher chance of meeting financial and social goals. Likewise, larger firms are more likely to succeed socially while failing financially, meaning that larger firms emphasise social impact. Age raises the probability that an MFI will fail financially and socially, as does stock market capitalisation to GDP that proxies capital markets development. Lastly, MFIs in countries following civil law and other legal traditions are more likely to meet at least one of the objectives, unlike MFIs in common law countries. 

5. *What are the factors that influence the choice of financing sources by transformed MFIs in Africa?* 

This research item examined the sources of finance for MFIs in Africa and their associated drivers. The indicators of financing sources were debt-equity ratio (leverage) and capital to assets ratio (equity), deposits to assets ratio (deposits), and donations to assets ratio (donations). We used fixed and random effects models with each of the financing sources as the dependent variables. The significant determinants of financing at the firm level are size, age, legal status, and profitability consistent with theory. For example, asset structure varies inversely with leverage. At the country level, institutional quality (KKM) varies inversely with deposits and donations. Interestingly, coefficients of financial development are not significant across all financial structure proxies, going against stylised facts on the macro-level drivers of firms’ financing structure. The results suggest that firm-level factors are more relevant in determining the financing structure of MFIs. 

## Outline of the Study

\noindent The remainder of the work is organised into five standalone chapters of coherent, identifiable aspects of the economics of microfinance in the African context. The proceeding paragraphs highlights each of the chapters. 

**Chapter Two**: This chapter explores the factors behind the transformation of MFIs in Africa from NGOs to commercial, profit-seeking entities that rely more on commercial rather than donor funding. Much of the extant research has looked into the potential effects of the transformation. However, few seek the answer as to why MFIs choose or abstain from converting in the first place. The answer to this question would benefit policy makers in dealing with sustainable financial inclusion in Africa and beyond. The analysis rests on the institutional theory of the causes of change in organizations [@scott2005institutional; @powell2012new], noting that MFIs have been under increasing pressure to be financially sustainable [@d2013unsubsidized].  

**In chapter three**: In this chapter, I examine the way the transformation of MFIs from NGOs to commercial, profit-seeking enterprises has affected financial inclusion in Africa using the fixed and random-effects models. The study draws from the agency and capital structure theories given that transformed MFIs rely less on donations and subsidies and more on capital markets for funding. Commercial funders could push managers to emphasize financial performance at the expense of social goals [@sarma2011ngo]. Considering this, the essay examines how the shift has affected lending to women, average loan sizes and gross loans. The study fills a gap in the literature given that much of the existing literature examines the effects of transformation using global datasets, which could mask regional heterogeneity as @d2017ngos suggests.

**Chapter four**: Chapter four assesses levels of financial efficiency, social efficiency, and joint social and financial efficiency (socio-financial efficiency) of MFIs in Africa. The chapter also evaluates the factors that drive these efficiencies. The analysis is in light of the transformation of MFIs from NGOs to commercial entities where agency conflicts could make MFIs less inclined to avail financial services to the financially excluded in favour of profits [@serrano2014microfinance]. I apply the data envelopment analysis (DEA) approach to quantify the extent that MFIs in Africa translate their assets into financial and social outcomes, which is a novel contribution to financial inclusion in Africa.  

**Chapter five**: Chapter 5 examines the factors that drive the simultaneous achievement of financial and social goals by MFIs in Africa. In this section, I use the multinomial logit model to examine the extent to which MFIs simultaneously achieve both their financial and social goals. I construct the dependent variable using the matrix developed by @chattopadhyay2017applicability as described in section 1.8 above. The output from this section complement those in chapter 4 but using a different methodology for robustness. 

**Chapter six**: Chapter 6 examines the funding sources by MFIs in Africa, including the factors determining the sources of financing. The mainstream capital structure theory does not address hybrid organisations with a dual mission, such as MFIs. The results would be useful at informing decisions about financing alternatives for MFIs that would best suit their hybrid nature, more so to meet their social goals while remaining financially sustainable. 

**Conclusion**: Finally, the study concludes by summarising findings, offering policy recommendations, and pointing out possible directions for future research.





<!--chapter:end:02-rmd-basics-markdown.Rmd-->

---
output:
  #bookdown::html_document2: default
  #bookdown::word_document2: default
  bookdown::pdf_document2:
    template: templates/brief_template.tex
    citation_package: biblatex
bib-humanities: true
documentclass: book
bibliography: references.bib
always_allow_html: true
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
- \usepackage[default]{sourcesanspro}
- \usepackage[T1]{fontenc}
- \usepackage{amsmath}
- \usepackage{dcolumn}
- \usepackage{url}
---

```{block type='savequote', quote_author='(ref:edgar-quote)', include=knitr::is_latex_output()}
“All is changed, save the river and the hill--
Even they are changed.
Only the burning sun and the quiet stars are the same.
And we--we, the memories, stand here in awe,
Our eyes closed with the weariness of tears--
In immeasurable weariness."
```
(ref:edgar-quote) --- Edgar Lee Masters.


# Transformation of Microfinance Institutions in Africa {#cites-and-refs} 
\chaptermark{Transformation of MFIs in Africa}
\minitoc <!-- this will include a mini table of contents-->

\begin{center}

\textbf{ABSTRACT}

\end{center}

```{r, echo = FALSE, message = FALSE, warning = FALSE}

library("pacman")
library("bookdown") 
library("broom") 
library("car") 
library("caret") 
library("corrplot") 
library("dtplyr")
library("excelR") 
library("GGally") 
library("ggalt") 
library("ggeasy") 
library("gghalves") 
library("ggrepel")  
library("ggthemes") 
library("gmnl") 
library("gmodels") 
library("gplots") 
library("gridExtra") 
library("gtable")
library("here") 
library("janitor") 
library("kableExtra") 
library("knitr") 
library("lme4") 
library("lmtest")
library("magrittr") 
library("margins") 
library("mice") 
library("nnet") 
library("pacman") 
library("patchwork") 
library("pcse")
library("pglm") 
library("plm") 
library("prettydoc") 
library("pROC") 
library("psych") 
library("Rchoice") 
library("rDEA")
library("readxl")
library("rmarkdown") 
library("skimr") 
library("stargazer") 
library("tidymodels") 
library("tidyverse")
library("treemapify") 
library("viridis") 
library("wesanderson") 
library("zoo")

#########################################
options(digits = 3)
options(scipen=999)
options(knitr.kable.NA = "-")
theme_set(ggthemes::theme_clean())
#########################################
```

We examine the factors that drive non-governmental organisation type of microfinance institutions to convert to the commercial, profit-oriented model. Using data from the World Bank and the International Monetary Fund (IMF), we ran logit, probit, and multinomial logit regressions, with NGOs as the base outcome. At the firm level, age and size influence transformation, whereas legal tradition, institutional quality, and stock market development are significant factors at the country level. More specifically, older firms are less likely to be NGOs, as are MFIs in civil law countries. Larger MFIs and MFIs located in countries with “other” legal traditions are more likely to follow the commercial model. We also found that institutional quality increases the likelihood of conversion, while stock market size has a negative relationship with transformation. These models are statistically significant, and their associated results remain robust to removing outliers and other checks.

\vspace{10mm}

**Key Words**: Microfinance, Transformation, NGO, Commercial, Africa.

\vspace{5mm}
**JEL Classification**: G210, G230

\newpage


## Background
The modern micro-finance (MF) industry draws its popularity from the promise of providing appropriate and affordable financial services to the population under-served by mainstream financial intermediaries [@morduch1999microfinance; @morduch2000microfinance]. The motivation for reaching out to the unbanked draws from researchers and development practitioners' view that financial inclusion leads to welfare improvements.  As an example, some scholars associate access to finance with more business start-ups, higher savings rates, improved health, less child mortality, and higher education attainment by the poor, although some scholars downplay these findings [@klapper2015role; @o2017systematic; @shahriar2017lender]. Much of the initial efforts to provide financial services to the unbanked rested on Microfinance. Microfinance refers to either the practice of delivering appropriate and affordable financial facilities to the financially excluded or the providers of such micro and small denomination financial services [@ledgerwood2006transforming] ^[The quote at the beginning of the chapter is from the poem *Edith Conant* by Edgar Lee Masters in @masters2007spoon]. 

Pioneer Microfinance Institutions (MFIs), like Grameen Bank, primarily operated as Non-Governmental Organisations (NGOs), following the welfare approach, where the profitability of the institution played a second role to availing financial services to the poor [@chahine2010social; @d2017ngos].  However, the paradigm shift is towards the financial systems approach where MFIs operate under commercial principles, leading to charges of "financialisation" of poverty [@mader2015financialization], with the relatively higher interest rates charged to the clients equated to a "poverty penalty" [@chen2017microfinance]. Some scholars and practitioners argue that MFIs following the profit-oriented commercial model are subject to "mission drift" though more financially sustainable". Mission drift refers to situations where MFIs lessens their commitment to availing financial services to the financially excluded to pursue profits [@jia2016commercialization; @mia2017mission]. 

However, given the social mission inherent in MF, MFIs following the financial systems approach risk their legitimacy in society and local and international donor community, a significant source of funding even for commercial MFIs [@nason2018behavioral]. For these reasons, some researchers and development practitioners vouch for the welfare approach, where MFIs focus primarily on the mission to reach the financially excluded without emphasising profits. Most MFIs following the welfare approach are non-governmental organisations (NGOs). Though not subject to mission drift, the NGO model is over-reliant on volatile local and international donor funds and government subsidies [@garmaise2013cheap; @d2017aid]. Additionally, NGOs may crowd out the efficient, commercial-oriented microfinance providers  [@kota2007microfinance], which may hurt aggregate welfare in the long run.

The win-win school attempts to reconcile the commercial model and welfare approach to microfinance. Adherents of the win-win school postulate that it is possible to achieve both financial sustainability (that is, turn a profit) and, at the same time, reach the financially excluded [@kodongo2013individual]. As a case in point, some researchers argue that MFIs could strive to generate profits by offering financial services to the relatively well-off at market rates. The MFIs could then use the returns to subsidise the provision of financial services to the poor under a form of price discrimination, leading to "mission expansion" as opposed to mission drift [@mersland2010microfinance]. 

Globally, the shift from the pure welfare approach of MF provision is gaining ground. Most of the transformed MFIs operate at some point on the continuum between the NGO, welfare model and the commercial, profit-oriented approach [@armendariz2013subsidy; @d2013unsubsidized; @hishigsuren2006transformation]. It all started in 1992 in Bolivia when Prodem, an NGO, converted to a commercial bank, Bancosol [@fernando2004micro; @creedy2018types]. Since then, many MFIs worldwide have converted from NGOs to commercial firms seeking to make profits. 

This article explores the factors that drive the transformation of MFIs from NGOs to for-profit firms in Africa. To this end, we use a panel dataset of 705 MFIs in Africa from the MIX pooled database, with additional data from the World Bank like the World Development Indicators (WDI), the Worldwide Governance Index (WGI), and the Global Financial Development Database (GFDD). We focus on Africa, given the relatively low levels of financial inclusion on the continent [@demirguc2018global]and the shortcomings inherent in combining data from different regions that may yield results that are not actionable. As @d2017ngos and @wang2015ownership suggest, the nature and performance of MFIs are country-specific. Hence, research focusing on particular regions, countries or even firms could better inform policymaking. 

This article contributes to the literature in two main ways. First, the study sheds light on the drivers of the transformation of microfinance institutions in Africa. Much of the literature has not examined this phenomenon, focusing, instead, on the shift's consequences and how MFIs can balance financial and social missions [@d2013unsubsidized; @forkusam2014does; @mia2017mission]. We believe that our analysis could form a reasonable starting point for analysing the transformation of MFIs in other regions or countries. Second, we detail the linkages between the drivers of micro-finance institutions' transformation, showing how they interact to change the likelihood of conversion. We highlight the pitfalls that bedevil analysis of pooled data from heterogeneous sources, which may mask crucial differences or similarities between the analysis units. 

The rest of the article is structured as follows. Section 2.3 presents the theoretical underpinnings and empirical findings related to the study. Subsequently, in section 2.3.1, we summarise the findings of this study before delving into the analysis method and attendant results in sections 2.4 and 2.5, respectively. Section 2.6 concludes.

## Related Literature
Much of the early literature on the institutional change of MFIs dealt with the theoretical, philosophical, and historical basis for transforming MFIs from NGOs to commercial firms and the potential impacts of such conversion [@campion1999institutional; @christen2001commercialization; @gutierrez201920; @zaby2019science]. Views of scholars on the transformation of MFIs drew from the institutional theory. The theory seeks to explain persistence and convergence in organisations, including change and de-institutionalisation within firms [@scott2004institutional]. For MFIs, the transformation has picked pace with the dominance of neoliberalism after the cold war [@ostry2017]. 

The institutional theory holds that the institutional environment is more influential in developing formal structures in organisations than market pressures [@maggio1991]. Coercion is one form of pressure from the institutional environment that makes organisations adopt institutional structures and practices. Institutional theorists note that stakeholders could force firms to adopt specific organisational structures and practices without critical scrutiny to gain legitimacy in the institutional environment [@scott2004institutional; @martinez2017coercive]. 

With this hindsight, @bateman2010doesn traces the pressure to convert MFIs from NGOs to the commercial model to the rise of neo-liberalism and the insistence that firms be financially self-sufficient instead of relying on government subsidies and, in the case of MFIs, donor funds. The wave of economic liberalisation and privatisation commenced in the early 1990s due to neo-liberalism [@silva1998neoliberalism]. Researchers point to pressure from financiers of MF such as USAID and the World Bank as a significant driver for the decision for MFIs to transform [@ostry2017]. 

However, given that MFIs have a social mission, the transition to a profit-oriented positioning is bound to conflict with the social objectives and threaten the MF industry's legitimacy [@ramus2017; @nason2018behavioral]. Specifically, the quest to satisfy both financial goals and the social mission is likely to conflict, which may cause "mission drift" [@mersland2010microfinance; @mia2017mission], where MFIs give greater priority to profitability than outreach to the unbanked. 

Nonetheless, the push from donors to transform MFIs seems to contradict the slow pace of the transformation. NGOs still form a substantial proportion of MFIs in Africa, accounting for 32%, second only to Non-Bank Financial Institutions (NBFIs) at 40% [@market2017global]. A question arises regarding the factors behind the persistence of certain organisational forms of MFI provision in Africa and globally. @pashkova2016business tackled this question. They found that the cooperative model is prevalent in economies with civil law systems, low inflation levels, and high economic growth rates. 

In contrast, NGO type MFIs feature in countries with high inflation rates and low economic growth levels, meaning that NGOs help the poor cope during challenging economic times. The commercial banking model features most in economies with common law legal systems. However, the study by Pashkova, et al. does not explicitly address the transformation question, factors that determine the transformation of MFIs from NGOs to a commercial model, which we explicitly address in this article.

The capacity of the capital markets and their antecedents may raise the propensity for the transformation of MFIs. MFIs in countries with well-developed capital markets can efficiently or more readily issue debt and equity instruments and raise public deposits  [@allen2013resolving; @allen2014african]. Available literature points to legal tradition, governance, and education, as drivers of financial development in a country [@rajan1998financial; @baltagi2009financial]. By extension, these variables drive economic growth by the financial development-economic growth nexus literature [@claessens2003financial]. The size of an MFI in terms of assets base, structure, and tangibility could enhance its capital acquisition capacity in line with the trade-off theory of capital structure [@barclay2005capital; @gwatidzo2009corporate; @ojah2016effects]. 

@ledgerwood2006transforming attribute the financing structure, hence the organisational form of an MFI, to the institutional life cycle. For instance, in the early stages, most MFIs operate as NGOs relying on donations and concessionary funds, given that commercial funders deem them too risky. Later, they use government subsidies and equity funding from NGOs and public investors to supplement their funding. In the final consolidation phase, most MFIs rely on debt, using foreign donors as guarantees. Deposits also play a prominent role in this consolidation phase as MFIs increasingly adopt the commercial model. 

Thus, the age of an MFI may have a bearing on both the capital structure and organisational structure. Regulatory provisions relating to the ways MFIs can raise capital and historical legacies on saving and lending [@bayai2016financing] may explain the remaining firm, country and regional disparities. The agency conflict that follows the introduction of debt and equity brings to the fore the potential conflict between optimising financial returns and sticking to the social mission of MFIs,  the second central strand of research on MFI conversion  [@nurmakhanova2015trade; @bayai2016financing; @abdulai2017trade; @awaworyi2018sustainability]. 

Quality of institutions features prominently in explaining the investment climate in a country. Researchers have primarily explained away the "Lucas Paradox" using the differences in, among others, the institutions, especially the capacity to enter into and enforce contracts and guarantees against state appropriation of private property - property rights [@azemar2013has; @goktan2015explanation]. MFI transformation connotes the entry of private, profit-oriented capital that seeks returns and favours countries with refined institutions. Moreover, researchers have variously cited the quality of institutions as drivers of the ease with which firms, MFIs included, can access private funds by fostering a well developed financial ecosystem [@huang2010political; @kaidi2019financial]. In this case, the financial system would consist of equity and debt markets where private investors could buy stakes in or lend funds to the MFIs that seek to go commercial. The following section highlights the results of the study. 

### Summary of Results
The output from the data analysis shows that at the country level, it is legal tradition, stock markets development, and governance (institutional quality) that relate significantly to the likelihood of the transformation of MFIs. At the firm level, the age and size of the MFI raise the probability of conversion. There is also a robust time trend towards the commercialisation of MFIs which points to the growing acceptance of microfinance's profit orientation. Regional differences are also evident with North Africa represented by NGOs in the sample data, probably due to religious constraints. GDP growth rate and education levels are not significant determinants of the probability of transformation. However, like the stock market to GDP, private credit to GDP has a negative coefficient, suggesting sensibly that the availability of larger financial markets does not support MFIs' model conversion.

Precisely, the probability of an MFI transforming declines with the increase in age, with older MFIs more likely to follow the NGO model than younger MFIs. In contrast, bigger MFIs have a higher likelihood of transforming to the commercial model, while smaller MFIs retain the NGO status. Also, MFIs in common law countries have a higher chance of changing than civil law countries. However, MFIs located in countries with other legal traditions (that is, not civil or common law traditions - see Appendix 6)  that have the highest probability of going commercial. Stock market development relates negatively with the likelihood of transformation of MFIs, likely because people in countries with well developed financial markets are more likely served by the mainstream financial system, relying less on microfinance. However, only stock market development is a significant driver of the financial development indicators, with private credit having a negative but insignificant effect of transformation. As expected, governance/ institutional quality positively relates to the chance of a conversion. Regionally, the sample data has only NGOs for North Africa, reflecting religious aversion to for-profit microfinance operating in majority Muslim countries. Importantly, there is a potent time trend towards the commercialisation of MFIs which points to a triumph of the commercial approach to microfinance over the welfare model. GDP growth rate shows mixed results but is insignificant. In the next section, we describe the methodology applied in the study.


```{r, echo = FALSE, message = FALSE, warning = FALSE}
## legal traditions 
### Common law countries in Africa
common <- tibble(country = c("Botswana", "Gambia, The", "Ghana", "Kenya", "Lesotho", "Liberia", "Malawi", "Namibia", "Nigeria", "Sierra Leone", "South Africa", "South Sudan", "Sudan", "Eswatini", "Tanzania", "Uganda", "Zambia", "Zimbabwe"), trad = c(rep("common", 18)))

### Civil law countries in Africa
civil <- tibble(country = c("Algeria", "Benin", "Burkina Faso", "Cameroon", "Central African Republic", "Chad", "Comoros", "Congo, Rep.", "Cote d'Ivoire", "Gabon", "Guinea", "Madagascar", "Mali", "Mauritania", "Morocco", "Niger", "Senegal", "Togo", "Tunisia"), trad = c(rep("civil", 19)))

### Other legal traditions in Africa
others <- tibble(country = c("Equatorial Guinea", "Angola", "Burundi", "Cape Verde", "Congo, Dem. Rep.", "Egypt, Arab Republic of", "Ethiopia", "Eritrea", "Guinea-Bissau", "Mozambique", "Rwanda"), trad = c(rep("others", 11)))

###Putting them all together
legal <- rbind(common, civil, others)
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Bond market data - private and public bond market capitalization to GDP
bonds <- read_excel("bonds_oluoch.xlsx") %>% 
  
  janitor::clean_names()

```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Add the financial development index to the dataset
## Countries not part of Africa
mideast <- c("Bahrain", "Iran, Islamic Rep.", "Iraq", "Israel", "Jordan", "Kuwait", "Lebanon", "Malta", "Oman", "Qatar", "Saudi Arabia", "Syrian Arab Republic", "United Arab Emirates", "West Bank and Gaza", "Yemen, Rep.")

## Load the financial structure data
finstr <- read_excel("FinancialStructureDatabase20191018.xlsx", sheet = 4) %>% 
  
  ## Select desired variables
  select(country, region, year, pcrdbgdp, stmktcap, stvaltraded, stturnover, listco_pc) %>% 
  
  ### Filter out regions not in Africa or middle east
  filter(region == "Sub-Saharan Africa" | region == "Middle East & North Africa") %>% 
  ### Filter out countries in middle east and select year 1999 onwards
  filter(!country %in% mideast, year >= 1999) %>% 
  
## Replace NAs
          group_by(country) %>% 
  
          mutate(pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
                 
                 pcrdbgdp = replace_na(pcrdbgdp, 0),
                 
                 stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE)),
                 
                 stmktcap = replace_na(stmktcap, 0)) %>% ungroup() %>% 
  
## Join with the bonds data
  left_join(bonds, by = c("country", "year")) %>% 
  
## rename bonds columns 
  rename(prbonds = outstanding_t_bonds_percent_gdp, 
         
         pubonds = outstanding_c_bonds_percent_gdp) %>% 
  
  ## Replace NAs in public bond and private bond markets 
  mutate(pubonds = replace_na(pubonds, 0), 
         
         prbonds = replace_na(prbonds, 0)) %>% 
  
         ## Rename Ivory Coast
         mutate(country = if_else(country == "Côte d'Ivoire", "Cote d'Ivoire", 
                                  
                                  country))

## View missing data points
#mice::md.pattern(finstr)

#finstr %>% select(pcrdbgdp, stmktcap) %>% cor(.) %>% 
  
  #corrplot(method = "number", type = "lower")
```



```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Read in the dataset 
my_data <- read_csv("amelia.csv") %>% 

## Region
mutate(region = if_else(region == "Middle East and North Africa", 
                        
                        "North_Africa", region)) %>% 

# Clean the names 
janitor::clean_names() %>% 
  
# Set up factor variables 
## legal status 
mutate(currentlegalstatus = factor(currentlegalstatus, 
                           levels = c("NGO", "Bank", "NBFI", 
                            "Credit Union/ Cooperative", 
                            "Rural Bank")), 
      ## Age
      age = factor(age, levels = c("New", "Young", "Mature")),
       
      ## Region 
      region = factor(region, levels = c("North_Africa", "Africa"))) %>% 
  
      ## Add the financial structure data     
      left_join(finstr, by = c("country", "year")) %>% 
  
      ## Add a binary variable for the legal dummy- NGO vs Others
      mutate(currentlegaldummy = case_when(currentlegalstatus == "NGO" ~ "NGO",
                                           
                                           TRUE ~ "others"),
      
        currentlegaldummy = factor(currentlegaldummy, levels = c("NGO", "others")),
        
        legal_tradition = factor(legal_tradition, 
                                 
                                 levels = c("Common", "Civil", "Other"))) %>% 
  ## Select required variables 
  select(mfiid, mfiname, year, country, currentlegaldummy, currentlegalstatus, 
         
         age, legal_tradition, region.x, asset_structure, 
         
         assets, kkm, education, pcrdbgdp, stmktcap, prbonds, gdp_growth_annual) %>% 
  
          ## Rename region
         rename(region = region.x) %>% 
  
  group_by(country) %>% 
  
  mutate(kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         education = replace_na(education, median(education, na.rm = TRUE)),
         prbonds = replace_na(prbonds, median(prbonds, na.rm = TRUE)),
         pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
         stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(mfiid) %>% 
  
  mutate(asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)), assets = replace_na(assets, median(assets, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(region) %>% 
  
  mutate(education = replace_na(education, median(education, na.rm = TRUE)),
         
         kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         
         gdp_growth_annual = replace_na(gdp_growth_annual, 
                                        
         median(gdp_growth_annual, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(currentlegalstatus) %>% 
  
  mutate(assets = replace_na(assets, median(assets, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  mutate(dummy = if_else(currentlegaldummy == "NGO", 0, 1)) %>% 
  
  mutate(assets = log(assets + 1),
         
         pcrdbgdp = log(pcrdbgdp + 1),
         
         stmktcap = log(stmktcap + 1),
         
         prbonds = log(prbonds + 1)) %>% 
  
  select(-asset_structure) %>% 
  
  add_count(mfiid, name = "count") %>% 
  
  mutate(currentlegalstatus = fct_recode(currentlegalstatus, Coop = "Credit Union/ Cooperative"))
  
## Write a csv for the data
my_data %>% write.csv(., "data.csv")

## Visualize missing data
#md.pattern(data)
## Amelia::missmap(data)

## MFIs with three (3) or more years of data
data3 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 3)
  
data3 %>% write.csv(., "data3.csv")

## MFIs with three (3) or more years of data
data5 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 5)  
  
data5 %>% write.csv(., "data5.csv")
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Analysis function
panel_logit <- function(data, depvar, indepvars,
                        effect = c("individual", "time", "twoways"),
                        model = c("random", "pooling", "within", "between"),
                        print.level = 4,
                        method = c("bgfs", "nr"),
                        family = binomial('logit'),
                        na.action = na.rm, 
                        index = c("mfiid", "year")){
 
   effect <- match.arg(effect)
   model <- match.arg(model)
   method <- match.arg(method)
   
  pglm(depvar ~ indepvars, 
       data = data, 
       na.action = na.action, 
       effect = effect,
       model = model, 
       family = family, 
       index = index)
}
```

## Method
The article uses three empirical estimation approaches, the binary logit and probit models and the multinomial logit model, given that our dependent variable is discrete and error terms may not be normally distributed [@cramer2002origins]. For the logit and probit models, MFIs following the NGO model take a code of zero and NBFIs, credit unions/ cooperatives, and rural banks forms taking a code of one. NGOs still take a zero-code for the multinomial logit model, with commercial banks, NBFIs, credit unions, and Rural Banks taking codes of one, two, three, and four, respectively. The multinomial logit model will help uncover factors that drive the choice of a particular legal form by NGOs adopting the commercial model. NGOs converting to the commercial model can turn to commercial banks, credit unions, NBFIs, or rural banks. The following section lays out and describes the models, variables, and data sources. 

### The Model, Variables Description and Data Sources
We use the model below to run both logit and probit regressions on a panel dataset of 705 MFIs in Africa. Assuming the error term $\epsilon$ follows a logistic distribution [@czepiel2002maximum], we have,

\begin{equation}
y_{it} = log(\frac{p_{it}}{(1-p_{it})} ) = \alpha + x_{it} + \varepsilon_{it}
\end{equation}

where,

\begin{equation}
p_{it}  =  \frac{1}{1 +  e^{- z_{it} } } 
\end{equation}

and

\begin{equation}
1 + p_{it}  =  \frac{1}{1 +  e^{z_{it} } }, for z_{it} = f(x_{it})
\end{equation}


In the model, $y_{it}$ is the current legal status of the MFI, the dependent variable which is a dummy with zero, representing NGOs as the base outcome. The other legal forms of MFIs take a code of one. The symbol $x_{it}$ represents a vector of independent variables: age, size, capital market development, legal tradition, GDP growth rate, and institutional quality. Additionally, we include year dummies to cater for the trends towards commercialisation. 

The multinomial logit model extends the binary logit model to more than two unordered levels (discrete choices). The data at hand meets the requirements for running a multinomial logit model as the dependent variable (the legal status of each MFI) has one outcome for each case. Also, the independent variables do not faultlessly predict the dependent variable [@petrucci2009primer]. Suppose we have a dependent variable $y$ consisting of $K$ choices for $K>=2$. Further, let the independent variables be $x_1, x_2,………. x_n$, we can specify the multinomial logit model as follows. 

\begin{equation}
log(\frac{prob(k/X)}{prob(K/X)}) =   \beta_{0}^{k}  x_{0}  + \beta_{1}^{k}  x_{1} +  \cdots + \beta_{p}^{k}  x_{p}, for k = 1 \cdots K-1
\end{equation}

$y$ is the dependent variable, in this case, one of NGO, commercial bank, NBFI, credit union or rural bank and $x$ is a vector of independent variables.

If $K>2$, then we have a multinomial logit with $K-1$ set of equations. Where $K=2$, the model is the binary logit model denoted in equation one (1) where we have one equation. Note that we have arbitrarily assigned the last category (K) as the reference in this case. Any other group can serve as a reference and hence not be part of the equations set. 

One of the significant drawbacks of the multinomial logit is the violation of the assumption of the independence of irrelevant alternatives (IIA). @cheng2007testing ) illustrate this assumption using the blue bus- red bus example. If the choice between car transport and a red bus, and given that the probability of choosing a bus is $0.8$, and $0.2$ for a car, then the bus's odds over car transport is 4. Suppose we introduce a third alternative, the blue bus. If the probabilities of choosing a red bus, blue bus, and car transport are $0.6$, $0.25$, $0.15$, respectively, the assumption holds since the odds of selecting a red bus over a car are still $4$. If the odds are different from $4$, then the model violates the IIA, and the multinomial model is not fit for the data. In our case, we plausibly see the assumption holding because the legal status of an individual MFI is independent of the legal status of other MFIs. Table 2.1 (next page) describes the variables in detail. 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
tribble(~ Variable_Description, "1. Current Legal Status (Dependent Variable): This is the dependent variable. For logit and probit models, we create a dummy variable with the MFIs following the NGO Model getting a code of zero, and one in the case of non-bank financial institutions (NBFIs), rural banks, and credit unions/ cooperatives. We assign codes of zero to four for the multinomial logit model for NGOs, Banks, NBFIs, Cooperatives and Rural Banks, respectively. The data are available from the Microfinance Information Exchange, MIX (See source in note 1 below).", "", "2.	Age: The period in which the MFI has been in operation. MFIs fall into one of three groups: new (1-4 years), young (4-8 years), and mature (over 8 years). The data are available from MIX.", "", "3. Legal Tradition (Legal): The indicator is a dummy variable with common law countries coded 0, civil law countries 1, and 2 otherwise as per the classification by Oto-Peralías and Romero-Ávila (2014). Appendix 6 shows the classification of countries into respective legal traditions", "", "4. Size (Assets): We proxy the size of MFI with the natural logarithm of total assets, again using MIX data.", "", "5. Governance/ Institutional Quality (KKM): We take the first principal component of the WGI developed by Daniel Kaufmann, Aart Kraay and Massimo Mastruzzi (KKM) that is available on the World Bank's Worldwide Governance Indicators, WGI (See source in note 3 below).", "", "6. Private Credit to GDP (pcrdbgdp): We capture the total amount of credit advanced to the private sector by financial intermediaries as a proxy for capital markets development concerning the banking sector following Ito and Kawai (2018). The data source is the Global Financial Development Database (GFDD) of the World Bank (See note 4).", "", "7. Stock market capitalisation to GDP (stmktcap): We capture the  extent of stock market development using the ratio of stock market capitalisation to GDP to proxy the extent to which firms can raise equity capital. Although Africa's equity markets are thin, some relatively large stock markets like South Africa, Egypt, Nigeria, Kenya, and Ghana exist. The data are from the GFDD.", "", "8. GDP annual growth rate (gdp_growth_annual): This is the year on year growth in output adjusted for inflation and sourced from the World Development Indicators (WDI) (See note 2).", "", "9. Education (EDUC): The indicator is a ratio of the gross enrolment in secondary school to the gross primary school enrolment as defined in the literature (Allen et al., 2013, 2014). The data are from the WDI.", "") %>% 
  
  kbl(., caption = "Description of Variables", booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(number = c("MIX Database on www.themix.org and https://datacatalog.worldbank.org/dataset/mix-market", "WDI on https://databank.worldbank.org/source/world-development-indicators.", "WGI/ KKM on https://databank.worldbank.org/source/worldwide-governance-indicators.", "GFDD on https://www.worldbank.org/en/publication/gfdr/data/global-financial-development-database"), number_title = "Notes",
    
           general = "Source: Authors' construction from the literature",
           general_title = "")
  
  #knitr::kable(caption = "Description of variables")
```


## Data Analysis and Results
### Exploratory Data Analysis
In this section, we visualise the data and then describe the variables in the model. 

#### Data visualisation
Figure 2.1 below shows the summary statistics and scatter plots for the independent numeric variables. The summaries show a high correlation between education on the one hand and private bond market capitalisation to GDP, stock market capitalisation to GDP, and private credit to GDP on the other at around 0.5. As literature shows, higher education levels coincide with greater participation of individuals in capital markets as financial inclusion levels rise [@allen2013resolving; @allen2014african; @ito2018quantity]. The stock market capitalisation to GDP and private bond market capitalisation to GDP correlates vastly, at 0.73. Typically, debt markets mature first, followed by stock markets, and their development levels are highly correlated  [@levine1999stock]. Other variables that show a high correlation include private credit to GDP on the one hand and private bond market capitalisation to GDP, and stock market capitalisation to GDP at 0.32 and 0.47. Institutional quality (KKM) also correlates with education, private credit to GDP and private bond market capitalisation [@yartey2008determinants]. 

With this hindsight, we drop education and private bond market capitalisation from the model. Note that much of the private credit to GDP ratio's variation already reflects the stock market's GDP ratio. Also, education reflects in general capital market development as documented in the literature [@allen2013resolving; @allen2014african]. We also note that North Africa has only NGOs in the model, perhaps due to faith [@allen2013resolving; @allen2014african; @hassan2018religious]. Hence, we exclude the region in the model. There could be country-specific effects that we capture using the quality of governance (KKM) [@kunvcivc2014institutional] and the annual GDP growth rate [@butkiewicz2006institutional]. 

Figure 2.2 shows that mature MFIs dominate the dataset across all legal forms and particularly dominant among rural banks, NGOs, and cooperatives. Turning to the prevalence of MFIs by legal status, cooperatives dominate civil law countries. Simultaneously, NGOs, NBFIs, commercial banks and rural banks dominate common law countries, which researchers have documented [@pashkova2016business]. For other legal traditions, NBFIs and cooperatives dominate. As noted, North Africa has only NGOs in the dataset, which could indicate the religious constraints towards interest charging financial intermediaries  [@hassan2018religious]. Finally, while commercial banks and NBFIs show a higher asset base, NGOs and credit unions are not large. Commercial banks assets could be more extensive due to statutory minimum capital requirement resulting from their desire to optimise economies of scale [@aiyar2016does].  

Turning to Figure 2.3, country-level governance matter more for commercial MFIs- commercial banks and NBFIs, compared to NGOs and rural banks in line with the link in the literature between investment, governance, and property rights [@claessens2003financial]. Commercial banks, rural banks, and NGOs dominate countries with higher stock market development levels, while NBFIs and cooperatives trail, noting that cooperatives may be relatively less inclined to obtain funding from stock markets [@porter1987economic]. The result could indicate the importance of equity capital for commercial banks and NGOs, while NBFIs tend to rely more on private equity and debt. Indeed, the data shows NBFIs dominate in countries where private credit to GDP is highest, followed by cooperatives and NGOs, while commercial banks and rural banks come last. Lastly, commercial banks, NBFIs and rural banks tend to dominate countries with higher GDP growth rates. Higher GDP growth implies higher profitability that allows commercial MFIs to thrive. Low GDP growth means that the not-for-profit NGOs and member-oriented cooperatives tend to succeed as a cushion to the vulnerable in society and fill the void left by the commercial MFIs.

\newpage

\blandscape

```{r, fig.cap = "Correlations Between Independent Variables", echo = FALSE, message = FALSE, warning = FALSE, fig.width=9, fig.height=6}
my_data %>%
  
  select(assets, kkm, education, 
         
         pcrdbgdp, stmktcap, prbonds, gdp_growth_annual) %>% 
  
         GGally::ggpairs() + labs(title = "", 
                                  
                                  caption = "Source: Authors' construction from the literature")
  
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Median function
median_n <- function(x){median(x, na.rm = TRUE)}
```

############################################ 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
theme_niwot <- function(){
  theme_bw() +
    theme(axis.text = element_text(size = 7), 
          axis.title.x = element_blank(),
          axis.title.y = element_text(size = 8),
          axis.line.x = element_line(color="black"), 
          axis.line.y = element_line(color="black"),
          panel.border = element_blank(),
          panel.grid.major.x = element_blank(),                                          
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          panel.grid.major.y = element_blank(),  
          plot.margin = unit(c(1, 1, 1, 1), units = , "cm"),
          plot.title = element_text(size = 10, vjust = 1, hjust = 0),
          legend.text = element_text(size = 8),          
          legend.title = element_blank(),                              
          legend.position = c(0.95, 0.15), 
          legend.key = element_blank(),
          legend.background = element_rect(color = "black", 
                                           fill = "transparent", 
                                           size = 2, linetype = "blank"))
}
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
###########################################
#' ggplot Flat Violin
#' @export
#' @details Copy-pasted from https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R
#' somewhat hackish solution to:
#' https://twitter.com/EamonCaddigan/status/646759751242620928
#' based mostly on copy/pasting from ggplot2 geom_violin source:
#' https://github.com/hadley/ggplot2/blob/master/R/geom-violin.r
#' @examples:
#' ggplot(diamonds, aes(cut, carat)) +
#'   geom_flat_violin() +
#'   coord_flip()
#' @import ggplot2
geom_flat_violin <- function(mapping = NULL, data = NULL, stat = "ydensity",
                             position = "dodge", trim = TRUE, scale = "area",
                             show.legend = NA, inherit.aes = TRUE, ...) {
  layer(
    data = data,
    mapping = mapping,
    stat = stat,
    geom = GeomFlatViolin,
    position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = list(
      trim = trim,
      scale = scale,
      ...
    )
  )
}

#' @rdname ggplot2-ggproto
#' @format NULL
#' @usage NULL
#' @export
GeomFlatViolin <-
  ggproto("GeomFlatViolin", Geom,
          setup_data = function(data, params) {
            data$width <- data$width %||%
              params$width %||% (resolution(data$x, FALSE) * 0.9)

            # ymin, ymax, xmin, and xmax define the bounding rectangle for each group
            data %>%
              group_by(group) %>%
              mutate(ymin = min(y),
                     ymax = max(y),
                     xmin = x,
                     xmax = x + width / 2)

          },

          draw_group = function(data, panel_scales, coord) {
            # Find the points for the line to go all the way around
            data <- transform(data, xminv = x,
                              xmaxv = x + violinwidth * (xmax - x))

            # Make sure it's sorted properly to draw the outline
            newdata <- rbind(plyr::arrange(transform(data, x = xminv), y),
                             plyr::arrange(transform(data, x = xmaxv), -y))

            # Close the polygon: set first and last point the same
            # Needed for coord_polar and such
            newdata <- rbind(newdata, newdata[1,])

            ggplot2:::ggname("geom_flat_violin", GeomPolygon$draw_panel(newdata, panel_scales, coord))
          },

          draw_key = draw_key_polygon,

          default_aes = aes(weight = 1, colour = "grey20", fill = "white", size = 0.5,
                            alpha = NA, linetype = "solid"),

          required_aes = c("x", "y")
  )


"%||%" <- function(a, b) {
  if (!is.null(a)) a else b
}
###########################################################
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# plotting function
plotter <- function(data, x , y, z, xlabel, ylabel, title){
  
  library(tidyverse)
  library(ggthemes)
  library(gghalves)
  library(ggalt)  
  library(ggrepel)  # for annotations
  library(viridis)  # for nice colors
  library(broom)  # for cleaning up models
  library(treemapify)  # for making area graphs
  library(wesanderson)  # for nice colors
  
  ggplot(data = data, mapping = aes(x = reorder({{x}}, {{y}}, median_n), 
  y = {{y}}, fill = {{z}})) + 
  geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8, aes(fill = {{z}})) +
  geom_half_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) + 
    geom_point(position = position_jitter(width = 0.15), size = 1, alpha = 0.1) + 
    scale_y_log10() + labs(y = ylabel, x = xlabel, 
  title = title) + 
  theme_niwot() + 
  theme(legend.position = "none") + 
  stat_summary(fun = mean, geom = "point", 
                size = 1, color = "red")}

##################################################
second_plotter <- function(data, x , y, z, xlabel, ylabel, title){

library(ggalt)  
library(ggrepel)  # for annotations
library(viridis)  # for nice colours
library(broom)  # for cleaning up models
# devtools::install_github("wilkox/treemapify")
library(treemapify)  # for making area graphs
library(wesanderson)  # for nice colours

  ggplot(data = data, 
           mapping = aes(x = reorder({{x}}, {{y}}, median_n), y = {{y}}, fill = {{z}})) +
    
    # The half violins
    geom_flat_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) +
    
    # The points
    geom_point(aes(y = {{y}}, color = {{x}}), 
    
    position = position_jitter(width = 0.15), size = 1, alpha = 0.1) +
    
    # The boxplots
    geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8) +
    
    # \n adds a new line which creates some space between the axis and axis title
    labs(x = xlabel, y = ylabel, title = title) +
    
    # Removing legends
    guides(fill = FALSE, color = FALSE) +
    
    # Setting the limits of the y axis
    #scale_y_continuous(limits = c(0, 1.2)) +
    
    # Picking nicer colours
    scale_fill_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    scale_colour_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    theme_niwot() + scale_y_log10()
}

##################################################
# plotting scatter diagrams 
plotter_scatter <- function(data, x, y, z, 
                            xlab, ylab, title) {
  
  # Load libraries
  library(tidyverse)
  library(gghalves)
  library(ggeasy)
  library(ggthemes)
  
  # write the function
  data %>% ggplot(aes(x = {{x}}, y = {{y}}, col = {{z}})) + 
    
    geom_point(shape = 1, size = 2) + 
    
    labs(x = xlab, y = ylab, title = title)
}
```


```{r, fig.cap = "Distribution and Asset Base of MFIs in Africa by Legal Status", echo = FALSE, message = FALSE, warning = FALSE, fig.width=9, fig.height=6}
## Current legal status vs age
(my_data %>% 
  
  ggplot(mapping = aes(x = fct_rev(fct_infreq(currentlegalstatus)), fill = age)) + 
  
  geom_bar() + scale_fill_brewer(palette = 7) + 
  
  labs(x = "", y = "Count", 
       
       title = "Panel A: Current Legal Status by Age") + 
   
   theme(legend.title = element_blank(), 
         
         legend.position = "top", 
         
         plot.title = element_text(size = 8)) + 


## Current legal status vs legal tradition
my_data %>% 
  
ggplot(mapping = aes(x = fct_rev(fct_infreq(currentlegalstatus)), 
                     
                     fill = legal_tradition)) + 
  
  geom_bar() + 
  
  scale_fill_brewer(palette = 2) + 
  
  labs(x = "", y = "", 
       
       title = "Panel B: Current Legal Status by Legal Tradition") + 
  
  theme(legend.title = element_blank(), legend.position = "top",
        
        plot.title = element_text(size = 8))) /

## Current legal status vs region
(my_data %>% 
  
ggplot(mapping = aes(x = fct_rev(fct_infreq(currentlegalstatus)), 
                     
                     fill = region)) + 
  
  geom_bar() + 
  
  scale_fill_brewer(palette = 9) + 
  
  labs(x = "Current Legal Status", y = "Count", 
       
       title = "Panel C: Current Legal Status by Region") + 
  
  theme(legend.title = element_blank(), 
        
        legend.position = "top", 
        
        plot.title = element_text(size = 8)) + 


## Current legal status vs assets
second_plotter(my_data, x = fct_reorder(currentlegalstatus, assets, median), 
           
          y = assets, z = currentlegalstatus, xlabel = "Current Legal Status", 
          
          ylabel = "Assets", title = "Panel D: Assets of MFIs by Legal Status"))  + 
  
  plot_annotation(title = "", caption = "Source: Authors' construction from MIX data")
```

```{r, fig.cap = "Governance, Capital Market Development and Legal Status of MFIs in Africa", echo = FALSE, message = FALSE, warning = FALSE, fig.width=9, fig.height=6}
#######################################
## Current legal status vs governance
(second_plotter(my_data, x = fct_reorder(currentlegalstatus, kkm), y = kkm, 
               
               z = currentlegalstatus, 
               
               xlabel = "Legal Status", ylabel = "Country Governance Index (KKM)", 
               
               title = "Panel A: Country Level Governance and MFI legal status") +



######################################
## Current legal status vs stock market capitalization
second_plotter(my_data, x = fct_reorder(currentlegalstatus, stmktcap), y = stmktcap, 
               
               z = currentlegalstatus, 
               
               xlabel = "Legal Status", ylabel = "Stock Market Development", 
               
               title = "Panel B: Stock Market Development and Legal Status of MFIs")) /




################################################
## Current legal status vs Private credit to GDP
(second_plotter(my_data, x = fct_reorder(currentlegalstatus, pcrdbgdp), y = pcrdbgdp, 
               
               z = currentlegalstatus, 
               
               xlabel = "Legal Status", ylabel = "Private Credit to GDP", 
               
               title = "Panel C: Private Credit to GDP and Legal Status of MFIs") +


## Current legal status vs GDP growth 
second_plotter(my_data, x = fct_reorder(currentlegalstatus, gdp_growth_annual), 
               
               y = gdp_growth_annual, 
               
               z = currentlegalstatus, 
               
               xlabel = "Legal Status", ylabel = "GDP Growth Rates (% Annual)", 
               
               title = "Panel D: GDP Growth Rates and Legal Status of MFIs")) +


plot_annotation(title = "", caption = "Source: Authors' construction from MIX data \n
                Arranged in Ascending order of the median score")
```

\elandscape

\newpage

#### Summary Statistics
Categorical variables summarised in Table 2.2 have no missing values. There are 1,280 NGOs against 3502 MFIs that are either commercial banks (619), NBFIs (1318), cooperatives (1427), or rural banks (138). As noted, even with the transformation of MFIs, NGOs still form a substantial number of MFIs, with the country to country variations [@d2017ngos]. While 2558 MFIs are mature, 1200 are new, and 1024 are young. The result may indicate a slowdown in the establishment of new MFIs as donations become more unreliable. 1877 MFIs are from common law countries, with Civil law countries accounting for 1849, while 1056 come from other legal traditions. It is notable, as shown in Appendix 6, that most countries in Africa are either common law (18) or civil law(19), with relatively fewer nations in the 'other' legal traditions category (11) [@oto2014distribution]. It is also worth noting that North Africa accounts for only 166 observations in the data against 4616 observations in the sample dataset. Table 2.3 shows the summary statistics for the numeric variables where assets, governance (KKM), and GDP growth rates account for the highest variation. 

Table 2.4 and Table 2.5 shows that NGOs, NBFIs, and commercial banks dominate common law countries. In civil law countries, it is cooperatives, NGOs, and NFIs that are most prevalent. In other legal traditions, it is NBFIs and credit unions that dominate. The result could indicate that the relatively well-developed capital markets in common law countries allow private, for-profit MFIs to thrive while not displacing NGOs. It means that NGOs in common law countries mainly serve niche markets where commercial MFIs find it uneconomical to reach. The relatively weak capital markets in civil law countries mean that cooperatives are central, with NGOs playing a significant role. Commercial MFIs like commercial banks and cooperatives' presence is low due to capital constraints. Turning to age in Table 6, most of the mature MFIs in the sample data are cooperatives, NGOs, and commercial banks in that order, while most of the new MFIs are NBFIs, cooperatives and commercial banks respectively. The results could indicate the increasing acceptance of the commercial model with newer MFIs going commercial. Table 2.7 shows the correlation between age and size, with larger MFIs more likely to be older. 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data$dummy <- factor(my_data$dummy, labels = c("ngo", "other"))

## Summary statistics for factor variables 
my_data %>% 
  
  select(currentlegaldummy, currentlegalstatus, 
         
         age, legal_tradition, region) %>% 
  
  skim_without_charts() %>% 
  
  select(-complete_rate, -skim_type, -factor.ordered, 
         
         -n_missing, -factor.n_unique) %>% 
  
  rename(Variable = skim_variable, 
         
         Counts = factor.top_counts) %>% 
  mutate(Counts = str_replace_all(Counts, "[oO]th", "Others"),
         
         Counts = str_replace_all(Counts, "Coo", "Cooperative"),
         
         Counts = str_replace_all(Counts, "NBF", "NBFI"),
         
         Counts = str_replace_all(Counts, "Ban", "Bank"),
         
         Counts = str_replace_all(Counts, "Mat", "Mature"),
         
         Counts = str_replace_all(Counts, "You", "Young"),
         
         Counts = str_replace_all(Counts, "Com", "Common"),
         
         Counts = str_replace_all(Counts, "Civ", "Civil"), 
         
         Counts = str_replace_all(Counts, "Afr", "Sub-Saharan Africa"),
         
         Counts = str_replace_all(Counts, "Nor", "North Africa"), 
         
         Variable = str_to_sentence(Variable)
         
         ) %>% 
  
mutate(Variable = case_when(Variable == "Currentlegaldummy" ~ "Current legal status dummy",
                            
                            Variable == "Currentlegalstatus" ~ "Current legal status",
                            
                            TRUE ~ Variable
                            
                            
                            )
       
       
       
       ) %>% 
  
kableExtra::kbl(., caption = "Summary statistics for categorical variables", 
      
  booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
  general_title = "")
```



```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Summary statistics for numeric variables 
my_data %>% 
  
  select(assets, kkm, education, 
         
         pcrdbgdp, stmktcap, prbonds, gdp_growth_annual) %>% 
  
  skim_without_charts() %>% 
  
  select(-skim_type, -n_missing) %>% 
  
  rename(Variable = skim_variable, Complete = complete_rate, 
         
         Mean = numeric.mean, SD = numeric.sd,Min = numeric.p0,
         
         Q1 = numeric.p25, Median = numeric.p50, Q3 = numeric.p75,
         
         Max = numeric.p100) %>% 
  mutate(Complete = 4782) %>% 
  
  rename(N = Complete) %>% 
  
  kbl(., caption = "Summary statistics for numeric variables", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           general_title = "")
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
prop.table(table(my_data$legal_tradition, my_data$currentlegalstatus),1) %>% 
  
  kbl(., caption = "Legal Status of MFIs in Africa Disaggregated by Legal Tradition", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "",
           
           number = "Horizontals total to 100",
           
           number_title = "Note: ")
```

\newpage

### Results of the Regression Model

Table 2.11 shows the output from both the logit and probit regression analysis. We ran the analysis using the entire dataset, then filter MFIs with three or more years and five or more years of data and rerun the regression (as indicated in the bottom panel of the regression tables). We also include a time dummy, although these results are not in the regression tables. However, there is also a robust positive time trend towards commercialisation of MFIs, indicating relatively fewer NGO type MFIs over time as more MFIs opt for the commercial model. The trend is indicative of the gains that the sustainability school has made. However, NGOs still form a substantial proportion of MFIs. In this section, we examine each variable and its relative contribution to the transformation of MFIs. Note that we use the logit model in column 1 of Table 2.9 to interpret the discussion results. However, the interpretation is also applicable to the other models presented in the Table.


```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  count(legal_tradition, currentlegalstatus) %>% 
  
  group_by(currentlegalstatus) %>% 
  
  mutate(prop = n / sum(n)* 100) %>% 
  
  select(-n) %>% 

  pivot_wider(names_from = currentlegalstatus, values_from = prop) %>% 
  
  kbl(., caption = "Breakdown of Legal Status of MFIs by Legal Traditions, Percent", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "",
           
           number = "Verticals total to 100",
           
           number_title = "Note: ")
```


#### Age

New MFIs are more likely to adopt a commercial model than either young or mature ones, given the coefficients' negative sign. The observation may reflect the increasing acceptance of the financial systems approach to microfinance, making it harder for new entrants to attract donor funding [@d2017ngos]. We postulate that older MFIs, being the pioneers and hence already well-acquainted with donors, find it easier to raise funds through donations and elicit state subsidies [@d2013unsubsidized; @mia2017mission]. Established MFIs have a historical relationship with donors. They are likely to attract funds, more so from donors that favour the welfare approach to microfinance, to reach out to the financially excluded first before pursuing profits. The results are in line with those in Table 6, which shows the distribution of MFI legal status disaggregated by age.  While only 18% of NGOs are new, 27.3% are young, while about 30% are mature, an upward trend. By comparison, the other legal status either decline or are relatively constant.


```{r, echo = FALSE, message = FALSE, warning = FALSE}
prop.table(table(my_data$age, my_data$currentlegalstatus),1) %>% 
  
  kbl(., caption = "Legal Status of MFIs in Africa Disaggregated by Age", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "")
```


The coefficients of the logit model show that young MFIs (4-8 years) are 0.474 as likely to be in the commercial category than the new MFIs (0-4 years), ceteris paribus. This result means that new MFIs are likely to be commercial while older MFIs are most likely NGOs. ^[Relative risk ratios allow for easier interpretation of the logit models. To compute the ratio, we exponentiate the coefficients. For instance, the coefficient for young MFIs is -0.747, so the relative risk ratio is $e^{-0.747}$, which gives 0.474. In other words, the odds of having the commercial model of microfinance is 1 - 0.474 = 0.526 in the sample dataset.], we find that keeping all the other variables constant, young MFIs roughly one half less likely to be commercial than new MFIs. Likewise, mature MFIs are a third as likely to be commercial compared to new MFIs ^[Again, we exponentiate the coefficient -1.2 to get $e^{-1.2} = 0.301$]. The finding is also consistent with the intense time effect towards commercialisation which points to the increased acceptance of the commercial model of MFIs. The probit model also shows similar results. 

Having started their operations before the neo-liberal tradition took hold, older MFIs have created goodwill with donors that enable them to solicit donations and subsidies easily. Mature MFIs could also have evolved business models to be financially sustainable without converting to the commercial model. For instance, mature MFIs tend to have a broader asset base meaning they have a more diverse customer base (see Table 6). Besides, they may have emphasised the social mission in their vision, mission, and organisational cultures to such an extent that both the MFI and the donor community find it hard to pull back [@ramus2017; @berbegal2019impact].

```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  group_by(age) %>% 
  
  summarize(Min_size = min(assets),
    
            Mean_size = mean(assets), 
            
            Median_size = median(assets),
            
            Max_size = max(assets)) %>% 
  
  rename(Age = age) %>% 
  
kbl(., caption = "Size (Assets) of MFIs in Africa Disaggregated by Age", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "")
  
```


Younger MFIs, on the other hand, cropped up when the paradigm shift to the institutional approach was taking shape. It means, therefore, that donors were reluctant to extend funds to such organisations. Hence, the MFIs had to supplement the little donor funding and government subsidies by raising funds from the capital markets. The thinking is consistent with the literature that shows the extent to which donor funding is volatile and especially sensitive to geopolitical realignments [@garmaise2013cheap; @d2017aid] and business cycles [@wagner2013vulnerability].
 
#### Legal Tradition

As noted, we have grouped countries in the sample data into their respective legal traditions following @oto2014distribution. MFIs in civil law countries have a lower chance of transformation compared to those from common law countries ^[Appendix 6 shows a breakdown of the legal traditions in Africa]. However, MFIs in countries under "other" legal traditions have the highest likelihood of adopting the commercial model. The result is in line with the literature that shows the law's central place in finance [@la2013law]. Specifically, holding all other variables constant, MFIs in civil law countries are 0.656 ($e^{-0.421}$) as likely as those in common law countries to follow the commercial model, meaning that most of them remain NGOs, following the not-for-profit, welfare approach. The odds of MFIs in civil law countries being commercial is 0.344 ($1 - 0.656$). On the contrary, MFIs in countries that follow other legal traditions are twice ($e^{0.744}$) as likely to be commercial instead of NGOs, with the odds being 1.1 ($2.1 - 1.1$). 

Table 2.4 show the breakdown of MFI legal forms by the country's legal tradition. The table shows the dominance of NGOs (32.3%), commercial banks (24.6%) and NBFIs (31%) in common law countries. Cooperatives (52.4%), NGOs (30.4%), and NBFIs (15.8%) dominate civil law countries, while NBFIs (42%), cooperatives (34.8%), and banks (12.6%) are more common in other legal traditions. There are very few banks (1.4%) and NBFIs (15.8%) in civil law countries. Given the low levels of financial development in many civil law countries, there is a commercially viable gap for profit-oriented MFIs to fill. The gap raises the odds of MFI transformation happening more frequently in civil law countries than in countries following common law and other legal traditions. 

On the contrary, the prevalence of commercial MFIs in common law countries could hold due to the higher levels of capital market development, reflecting the relative ease of acquiring funds [@schnyder2018twenty]. The relative ease of acquiring capital from stock and bond markets could make it less likely that NGOs would prevail, making the commercial model more likely. The substantial number of NGOs in common law countries would fill the gap left by commercial MFIs due to the infeasibility of serving some clients, for instance, due to geographic remoteness or extreme poverty. There is little literature in law and finance that examines other legal traditions, such as Portuguese/ Spanish traditions as in Mozambique, Angola, Equatorial Guinea, and countries with unique traditions like Ethiopia that was never a colony. The results for the "other" legal practices in Africa's setting warrant further analysis. Table 2.5 confirms these results, showing, for instance, that 47.34% of NGOs are in common law countries, 43.91 in civil law countries and the rest in other legal traditions. Common law countries have the bulk of banks (74.47%) and NBFIs (44.2%). Rural banks are almost entirely a common law phenomenon.  

#### Size (Log of Total Assets)

All else being constant, larger MFIs in terms of assets are more likely to adopt the commercial model than the relatively smaller MFIs with fewer assets. Perhaps large MFIs can sustain their operations independent of donations and subsidies [@d2013unsubsidized]. They have a higher capacity to attract money from the capital markets, given their strong assets base (as collateral) and track record. Everything else remaining the same, a unit increase in the asset base of an MFI raises the probability of transformation by 1.27 ($e^{0.240}$), with the odds of being in the commercial model being 0.27 ($1.27 - 1$). 

Abundant literature in Africa and beyond, such as @gwatidzo2009corporate and @kodongo2015capital, show that the size of an MFI is an essential determinant of firms' capital structures, the mix of long term sources of funds. In this case, larger firms could easily avail collateral for funds and tend to be more open in providing information that financial intermediaries require to assess creditworthiness. On the other hand, small firms are informationally opaque [@beck2014sme; @kersten2017small]. Small firms, for example, may not afford to generate audited financial reports. Moreover, larger firms are likely to be mature with a solid business record, creating goodwill among the providers of funds [@beck2008finance]. The size of MFIs could also reflect the extent of property rights protection that is harder to enforce in countries with weak governance [@johnson2002property; @claessens2003financial]. A fragile institutional environment makes it difficult for firms to grow due, in part, to poor access to capital and the high costs of formalising business [@hansen2004reconsidering]. Next, we examine country-level governance / institutional quality. 

#### Country Level Governance/ Institutional Quality (KKM)

We capture governance or institutional quality by taking the first principal component of the KKM Worldwide Governance Indicators (WGI) indices [@kraay2010worldwide]. Governance (KKM Index) positively relates to the odds of transforming. All else remaining the same, when the governance index in a country rises by one unit, MFIs in the given country are 1.1 ($e^{0.095}$) times more likely to be in the commercial model than NGOs, meaning that the odds rise by $0.1$ ($1.1 - 1$). The results probably hold due to the importance of property rights in raising confidence among private investors who finance the operations of transformed MFIs (Allen et al., 2013, 2014). Where governance and property rights are weak, most MFIs would likely remain NGOs for longer as investors are reluctant to finance private ventures in line with @johnson2002property and @claessens2003financial. 

Literature shows a positive link between country-level institutional quality and the establishment, growth of private firms [@sobel2008testing]. As captured in the KKM index, institutional quality captures factors that relate directly to the ease of doing business, contract enforcement effectiveness, and the extent of property rights. Where institutional quality is high, we expect private firms to take root, mainly commercial MFIs, primarily commercial banks and NBFIs. On the other hand, where institutional quality is low, NGOs and not-for-profit oriented MFIs may be more prevalent [@kuzey2021link]. Indeed, The results on governance could partly explain the prevalence of NGOs in North Africa in the sample dataset, together with religion. Table 2.8 shows that North Africa fares poorly compared to Sub-Saharan Africa in most governance metrics. Interestingly, Table 2.9 shows that commercial banks and NBFIs are more prevalent in countries with higher institutional quality. 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  group_by(region) %>% 
  
  summarize(Min = min(kkm, na.rm = TRUE),
            Mean = mean(kkm, na.rm = TRUE),
            Median = median(kkm, na.rm = TRUE),
            Max = max(kkm, na.rm = TRUE)) %>% 
  
  rename(Region = region) %>% 
  
  mutate(Region = case_when(Region == "Africa" ~ "Sub-Saharan Africa",
                            TRUE ~ "North Africa")) %>% 
  
  kbl(., caption = "Summary Statistics on Governance in Africa", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "")
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  group_by(currentlegalstatus) %>% 
  
  summarize(Min = min(kkm, na.rm = TRUE),
            Mean = mean(kkm, na.rm = TRUE),
            Median = median(kkm, na.rm = TRUE),
            Max = max(kkm, na.rm = TRUE)) %>% 
  
  kbl(., caption = "Institutional Quality (KKM) and Legal Status of MFIs in Africa", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "")
```


#### Private Credit to GDP

The private credit to GDP inversely relates to the prevalence of commercial models of microfinance, with the relationship primarily insignificant. In this case, private credit refers to an aspect of capital markets development, mainly in the banking sector. It is puzzling that a well-developed credit market does not appear to enhance the prevalence of for-profit MFI models. The results could suggest a weak linkage between MFIs and private capital markets, more so credit from financial intermediaries. Indeed, MFIs exist to serve markets where mainstream intermediaries neglect, meaning the low presence of mainstream banks means a higher prevalence of MFIs to fill the void [@de2007economics]. Where significant, a unit increase in private credit to GDP corresponds to a 0.894 times lower chance that an MFI will be commercial, profit-oriented ($e^{-0.112}$), which corresponds to an odds of -0.114. 

As noted, MFIs, especially the NGO type, exist to fill a financing gap that results from the failure of credit markets to reach the financially excluded, that is, the poor, rural dwellers and women savers and borrowers. If mainstream credit markets are functional, then there is no case for the existence of commercial MFIs, because mainstream banks would fill the gap adequately, leaving no business case for commercial MFIs to exist. However, as no credit market is fully efficient, then NGOs would exist to serve niche markets where financial sustainability is unattainable due to a combination of high costs and low revenues [@de2007economics]. On the other hand, if capital markets are not well developed, there exists a market gap that commercial MFIs could exploit to make a profit [@d2013unsubsidized; @armendariz2013subsidy]. 

#### Stock market capitalisation to GDP

Stock market capitalisation to GDP has a significant negative relationship with the prevalence of commercial MFIs. Precisely, a unit increase of stock market capitalisation corresponds to a 0.721 odds of an MFI adopting the for-profit model. Like private credit to GDP, stock market capitalisation to GDP proxies the level of stock market development, an essential source of long-term finance for corporations, presumably including MFIs. The equity could be from the public or private equity market, which the stock market would proxy reasonably well. In the case of MFIs in the sample dataset, the capital to assets ratio, the ratio of equity capital to assets, shows the importance of equity in financing microfinance. Notably, equity is of greater importance to NGOs than commercial MFIs (see Table 2.10), with NBFIs and commercial banks following in that order. If NGOs are the dominant participants in equity markets, there are lower chances that a well-developed stock market corresponds to more commercial MFIs. The same argument follows that if stock markets are well developed, private and, public credit markets are also well-developed [@schnyder2018twenty]. With well-developed capital markets, financial exclusion incidences are fewer, leaving no vacuum that commercial MFIs could profitably exploit. In such instances, NGOs following the not-for-profit welfare model best serve the few cases of financial exclusion.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
#################################################
original_data <- read_csv("amelia.csv") %>% 
  
  janitor::clean_names() 

#################################################
original_data %>% 
  
  group_by(currentlegalstatus) %>% 
  
  summarise(Mean = mean(capital_asset_ratio, na.rm = TRUE), 
            
            Median = median(capital_asset_ratio, na.rm = TRUE)) %>% 
  
  rename(`Legal Status` = currentlegalstatus) %>% 
  
  kbl(., caption = "Capital Asset Ratio by MFI Legal Status in Africa", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "")
```


#### GDP Annual Growth Rate

The GDP growth rate is not a significant driver of transformation. Where significant, some of the coefficients are positive, while others are negative. The implication is that the macro-environment may not be a substantial driver of MFIs decisions. Most MFIs in developing countries serve the informal sector's financially excluded population with low linkage to the formal economy [@ghosh2013microfinance]. 

#### Time Effects 

The regression model also incorporates year effects, although not reported in the regression results tables. There is a strong trend towards commercialisation, with the commercial model increasingly dominating Africa's MFI landscape. All the year dummies are significant in all the models, the lowest level of significance being 10%. Numerous researchers have noted the trend towards the commercial model. Hence, the abundant research seeks to examine the potential effects of the transformation on financial inclusion targets- the financially excluded [@d2017ngos]. Some scholars claim that the trend may harm financial inclusion.  [@meagher2006microfinance; @hartarska2007regulated]. Others hold the opposing view [@duvendack2015mis]. It appears that the financial sustainability school that seeks commercialisation has the upper hand in Africa, at least in the last two decades.  

```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
## Running the regressions 
### Full dataset
#### Logit
logit_full <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual + 
       factor(year), data = my_data, 
       family = binomial("logit"))

#### Probit
probit_full <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual + 
       factor(year), data = my_data,
       family = binomial("probit"))

### Data >= 3 years
#### Logit
logit_3 <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual + 
       factor(year), data = data3,
       family = binomial("logit"))

#### Probit
probit_3 <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual + 
       factor(year), data = data3,
       family = binomial("probit"))

### Data >= 5 years
#### Logit
logit_5 <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual + 
       factor(year), data = data5, 
       family = binomial("logit"))

#### Probit
probit_5 <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual + 
       factor(year), data = data5,
       family = binomial("probit"))

### Pooled logit
logit_pooled <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual, 
       data = my_data, family = binomial("logit"))

### Pooled probit
probit_pooled <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual, 
       data = my_data, family = binomial("probit"))
```


#### Regional Divide

It is notable that for the sample data, all the MFIs operating in North Africa are NGOs, while the rest of Africa has a MIX of all forms of MFIs ^[Countries in North Africa in the sample data are Morocco and Tunisia]. Religion may be at play in this case, where interest-based for-profit lending is incompatible with the Muslim faith that dominates North Africa [@hassan2018religious]. Also, as noted, North Africa fares worse in governance (KKM) than sub-Saharan Africa, leading to a flawed property rights regime that discourages private investment [@johnson2002property; @claessens2003financial]. 


\newpage

\blandscape

```{r, results = 'asis', echo = FALSE, message = FALSE, warning = FALSE}
## Write out the models using stargazer
stargazer(logit_full, probit_full, logit_3, probit_3, logit_5, probit_5, logit_pooled, probit_pooled, title = "Logit and Probit Models (Standard Errors in Brackets)", font.size = "footnotesize", header = FALSE, omit = c("^factor.", "Constant"), dep.var.labels = "Dummy: Current Legal Status", add.lines = list(c("Year Effects", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "No", "No"), c("Deviance", "677***", "664***", "651***", "648***", "660***", "659***", "619***", "607***"),
c("Data", "Full", "Full", ">3yrs", ">3yrs", ">5yrs", ">5yrs", "Full", "Full")), notes.align = "l")
```

\elandscape

\newpage

```{r, echo = FALSE, message = FALSE, warning = FALSE}
library(tidymodels)
logit_model <- logistic_reg() %>% 
  set_engine("glm") %>% 
  set_mode("classification")
```


### Multinomial Logit Model
We extend the analysis to the multinomial logit model. To reiterate, the multinomial logit model will help uncover factors that drive the choice of a particular legal form by NGOs adopting the commercial model. We present the results of the model in the tables of Appendix 2 through to Appendix 5. As in the binary models, the results confirm the factors that drive the conversion of MFIs from NGOs to commercial models. We base our discussion on the results in Appendix 2, which easily generalises to the other appendices. The results show that as the MFI transitions from being new to young, it is less likely to be a bank, NBFI, credit union, or rural bank due to the coefficients' negative sign. Hence, older firms are more likely to be NGOs in line with the logit model for reasons expounded in the logit model's output.

Similarly, compared to NGOs, mature MFIs are less likely to be commercial banks, NBFIs, cooperatives or rural banks. The results align with the logit model showing that most commercial MFIs are more likely new or young, while NGOs are more likely mature. Again, start-up MFIs are more inclined to the commercial model than the established MFIs. 

Relative to common law countries, MFIs in civil law countries are less likely to be commercial banks, NBFIs, and rural banks and are more likely to be NGOs. However, in civil law countries, MFIs are more likely to be cooperatives than NGOs. Likewise, relative to common law countries, MFIs in other legal traditions are less likely to be commercial banks and rural banks than NGOs and more likely to be credit unions or NBFIs than NGOs. The results illustrate the link between legal tradition and the legal status of MFIs, with NGOs dominating common law countries whilst cooperatives prevail in other legal traditions, including civil law tradition. As noted, the better-developed capital markets in common law countries leave little room for commercial MFIs to thrive. On the contrary, the under-served populace in civil law countries presents ample business opportunities for profit-oriented MFIs [@d2013unsubsidized; @mia2017mission]. 

The results show that as an MFI size increases, the likelihood of shifting from the NGO model to the commercial model rises. However, as firms grow in size, they are less likely to adopt the cooperative model, although the relationship is not significant. MFIs mainly shift from NGOs to commercial banks, rural banks, and NBFIs, but rarely to cooperatives or rural banks. The results highlight the uniqueness of cooperatives and rural banking as microfinance models that serve niche markets. Strictly speaking, cooperatives are quasi-commercial entities. Their mode of operation differs from the other MFIs in terms of clientele and possible geographic reach, reducing size. Similarly, rural banks serve marginalised rural dwellers and are more prevalent in common law countries. Noting that most large MFIs are also mature, it follows that the edge granted by maturity also accrues to larger MFIs [@beck2014sme; @kersten2017small].   

Also, as country-level institutional quality rises, MFIs are more likely to be commercial banks and NBFIs, and less likely cooperatives and rural banks relative to NGOs. Cooperatives and rural banks are less sensitive to institutional quality matters courtesy of their unique markets, even more so than NGOs [@sobel2008testing]. As noted earlier, the commercial, for-profit model could only thrive best in countries where institutional quality is high. However, cooperatives and rural banks in Africa serve unique markets. Rural banks primarily focused on informal rural economies that may have a weak linkage to the formal economy, making governance and institutional quality less relevant.

By way of both stock market to GDP and private credit to GDP, capital market development follows a similar pattern. As in the logit model, MFIs in countries scoring high in private credit to GDP and stock market capitalisation to GDP are less likely to go commercial and more likely to be NGOs. We have argued before that well developed financial market implies a smaller customer base for MFIs and hence the result. The result also concurs with the observation about legal tradition. Because capital markets in civil law countries are less developed, the void tends to be profitably filled by commercial MFIs.In common law countries, capital markets leave few profitable opportunities which NGOs serve [@d2013unsubsidized; @armendariz2013subsidy].

Finally, high GDP growth rates increase the likelihood that an MFI will be a commercial bank, NBFI, or rural bank than NGOs but less likely to be a cooperative or rural bank. As is the case with institutional quality, the economic environment matters most for commercial MFIs that target profit. However, NGOs, cooperatives and rural banks may better serve communities undergoing adverse economic experiences [@ghosh2013microfinance]. Cooperatives obtain capital from members and are obligated to attend to the members regardless of economic uncertainties. NGOs and rural banks specifically target marginalised people. Economic downturns are more likely to raise the level of exclusion and make these forms of MFIs even more relevant [@schnyder2018twenty].  

```{r, results = 'hide', echo = FALSE, message = FALSE, warning = FALSE}
## Full dataset
multinom_full <- multinom(currentlegalstatus ~ age + legal_tradition + assets + kkm + pcrdbgdp + stmktcap + gdp_growth_annual + factor(year), data = my_data)

## Full dataset without cooperatives
multinom_no_coop <- multinom(currentlegalstatus ~ age + legal_tradition + assets + kkm + pcrdbgdp + stmktcap + gdp_growth_annual + factor(year), data = (my_data %>% filter(currentlegalstatus != "Credit Union/ Cooperative ")))

## Full dataset no year effects
multinom_full_ny <- multinom(currentlegalstatus ~ age + legal_tradition + assets + kkm + pcrdbgdp + stmktcap + gdp_growth_annual, data = my_data)

## Full dataset without Cooperatives and Without year effects
multinom_full_no_coop_ny <- multinom(currentlegalstatus ~ age + legal_tradition + assets + kkm + pcrdbgdp + stmktcap + gdp_growth_annual, data = (my_data %>% filter(currentlegalstatus != "Credit Union/ Cooperative ")))
```


### Overall Model Fit
To assess the overall model fit, we generate the `confusion matrix` and statistics in Table 2.12 and figure 4, respectively. For this purpose, we use the models developed by using the whole dataset- Table 2.11 for the logit model and Appendix 2 for the multinomial logit model.

#### Logit Model
Overall, the models are highly significant (at 1% significance levels, see Table 2.11), meaning that they explain why MFIs tend to adopt a given model better than guessing the most prevalent outcome- that every MFI in the sample is not an NGO. In the first row of Table 2.12, we see that the logit model predicted correctly that 304 NGOs were NGOs. The model also accurately predicts that an MFI belongs to other legal forms (Bank, NBFI, Coop, Rural Bank) when they belong to these forms. However, the model fails by predicting 976 cases of MFIs as other legal forms when they are NGOs. Similarly, the model wrongly classifies 126 cases of MFIs of other legal forms as NGOs.  

Overall, the logit model accurately predicts the legal status of an MFI 77% of the time ^[The accuracy is computed as (304 + 3376)/(304 + 976 + 126 + 3376) = 0.77]. The prediction is within the confidence interval captured by the entries `AccuracyLower` and `AccuracyUpper`. If we were to guess that every MFI in the dataset follows the commercial model (that is, not an NGO), we would be accurate 73.2% of the time (referred to as the No Information Rate (NIR) in the `confusion matrix`) [@cavalin2018confusion]. The p-value shows that the accuracy is not due to chance with over 99% confidence, meaning that the accuracy is significantly greater than the NIR [@kleinbaum2002logistic]. 

The model has low `sensitivity`, though, at 23.75%. In this case, sensitivity is a model's ability to accurately predict that an MFI is an NGO when it is an NGO [@marom2010using]. The low `sensitivity` could, in part, be due to the low `prevalence` of NGOs in the dataset (at 26.77%) relative to the commercial forms of MFIs (73.23%). However, the model has very high `specificity` at 96.4%. Specificity is the capacity of the model to predict that an MFI follows the commercial model (NOT an NGO) when it is following the commercial model (is NOT an NGO) [@zeng2020confusion]. Hence, it appears that commercial MFIs have distinct characters that easily allow the model to distinguish them from NGOs. The other metric of interest is the `balanced accuracy` that averages `sensitivity` and `specificity` at 60% [@gorzalczany2016multi]. Overall, the model does better than guessing that every MFI in the sample dataset follows the commercial model (or is NOT an NGO) [@hosmer2013applied]. 

Figure 2.4 shows a visualization of the confusion matrix and the receiver operating characteristics (ROC) curve. Again these visualizations show that the model does well in `specificity`. The ROC curve plots `sensitivity` against $1 - specificity$. For an ideal model, the ROC curve would pass through the point (0,1), which is the top left corner of the curve. A model with a ROC curve being a straight line passing through the origin (the dotted line) does no better than guessing. In this case, the ROC curve shows that the model has significant explanatory power. A related metric the area under the ROC curve called the `area under the curve (AUC)` shown in Table 2.13. AUC is the area between the ROC curve and the x-axis, with higher values of AUC corresponding to a better model. An AUC of 0.5 connotes a model that discriminates the units of analysis no better than guessing and is equivalent to the straight line passing through the origin [@mandrekar2010receiver]. The AUC, in this case, is 0.726 out of a possible maximum of one.  


```{r, echo = FALSE, message = FALSE, warning = FALSE}
############################################################
my_tidy_logit <- logit_model %>% fit(dummy ~ age + legal_tradition + 
       assets + kkm + pcrdbgdp + stmktcap + gdp_growth_annual + factor(year), 
       data = my_data)

my_data <- my_tidy_logit %>% predict(type = "class", new_data = my_data) %>% bind_cols(my_data)

tidy_conf_mat <- my_data %>% conf_mat(truth = dummy, estimate = .pred_class)

###############################################################################

tidy_conf_mat %>% summary() %>% kbl(., caption = "Confusion Matrix and Statistics for the Logit Model", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction",
           
           general_title = "", 
           
           number = "Accuracy > NoInformationRate is significant at 1% confidence level, p = 0.0000",
  
  number_title = "Notes: ")

################################################################
```



\newpage
\blandscape

```{r, fig.cap="Confusion Matrix (left) and ROC Curve", fig.width=9, fig.height=6, echo = FALSE, message = FALSE, warning = FALSE}
## Generating predictions 
my_data <- my_tidy_logit %>% predict(type = "prob", new_data = my_data) %>% bind_cols(my_data)

## ROC Area under curve
my_data %>% roc_auc(truth = dummy, .pred_ngo) %>% kbl(., caption = "ROC Area Under Curve (ROC AUC)", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction",
           
           general_title = "")

## Confusion matrix visualization 
tidy_conf_mat %>% autoplot(type = "heatmap", title = "Confusion Matrix") +
my_data %>% roc_curve(truth = dummy, .pred_ngo) %>% autoplot(title = "ROC Curve")
```

\newpage
\elandscape


\newpage

#### Multinomial Logit Model
The variables that are significant drivers of the transformation of MFIs under the logit and probit models are also significant in the multinomial logit model. We also generate the `confusion matrix` using the `multinomial logit` with the complete data (Table 2.14). The matrix shows that the overall `accuracy` is 56.5%. Note that the overall accuracy is one value for the entire model, the `No Information Rate (NIR)`. Overall `accuracy`, in this case, is the ability to accurately predict that an MFI is an NGO when it is an NGO, a commercial bank when it is a commercial bank, and so on. If we were to guess that every MFI in the model is the cooperative - the most prevalent legal form- we would be right 39.3% of the time, the NIR. The p-value shows that the overall `accuracy` metric is significantly different from the `NIR`. Although the multinomial logit model has a markedly lower accuracy than the logit model, it has a far more demanding task of distinguishing five legal forms of MFIs instead of 2 for the logit model [@kwak2002multinomial]. 

The model's `sensitivity` varies from a low of 47.1% for NBFI to a high of 61.8% for NGOs. The `specificity` is relatively high, ranging from 80.1% for NBFIs to 99.22% for rural banks [@ginting2019hate]. NGOs have a `specificity` of 81.4%, meaning that the model can predict that an MFI is not an NGO when it is not an NGO 81.4% of the time. For rural banks, the model can correctly predict over 99% of the time that an MFI is not a rural bank when it is not a rural bank. The `balanced accuracy` is also reasonably high, with the lowest being NBFIs at 63.9% and the highest at 79.26% for rural banks [@hedeker2003mixed]. 


```{r, echo = FALSE, message = FALSE, warning = FALSE}
multinom_predict <- predict(multinom_full)

conf_matrix <- confusionMatrix(my_data$currentlegalstatus, multinom_predict) 

######## MFI classes
mfis <- c("NGO", "Bank", "NBFI", "Coop", "Rural Bank")

####### Metrics
Accuracy <- c("0.565", "-", "-", "-", "-")

NoInformationRate <- c("0.393", "-", "-", "-", "-")

Kappa <- c(0.414, "-", "-", "-", "-")

sensitivity <- c("0.618", "0.6154", "0.478", "0.584", "0.5930")

specificity <- c("0.814", "0.9298", "0.801", "0.886", "0.9922")

PosPredValue <- c("0.437", "0.5170", "0.474", "0.768", "0.7391")

NegPredValue <- c("0.901", "0.9520", "0.803", "0.767", "0.9849")

Prevalence <- c("0.189", "0.1087", "0.274", "0.393", "0.0360")

DetectionRate <- c("0.117", "0.0669", "0.131", "0.229", "0.0213")

DetectionPrevalence <- c("0.268", "0.1294", "0.276", "0.298", "0.0289")

BalancedAccuracy <- c("0.716", "0.7726", "0.639", "0.735", "0.7926")
 
#####df
df <- rbind(Accuracy, NoInformationRate, Kappa, sensitivity, specificity, PosPredValue, NegPredValue, Prevalence, DetectionRate, DetectionPrevalence, BalancedAccuracy) %>% 
  
  data.frame()

names(df) <- mfis

df %>% 
  
  kableExtra::kbl(., caption = "Confusion Matrix and Statistics for the Multinomial Logit Model", 
      
  booktabs = TRUE) %>% 
  
  kable_classic(full_width = FALSE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction",
           
  general_title = "",
  
  number = c("Accuracy, No information rate and Kappa are the same accross the legal forms of MFIs", "Accuracy > NoInformationRate is significant at 1% confidence level, p = 0.0000"),
  
  number_title = "Notes: ")
```

\newpage

### Regression Diagnostics
This section examines three issues that arise in logit models: extreme values, multicollinearity, and linearity, respectively.

#### Extreme values
Figure 2.4 below shows that the data indeed has influential values. For robustness, we winsorise the data, removing the top 10% and the bottom 10%. Still, the results remain robust, as regression results in Table 2.14 show. It is notable that apart from the change in coefficients' value, the signs remain the same, meaning that influential observations (outliers) are not significant. 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
remove_outliers <- function(x, na.rm = TRUE, ...) {
  qnt <- quantile(x, probs=c(.10, .90), na.rm = na.rm, ...)
  H <- 1.5 * IQR(x, na.rm = na.rm)
  y <- x
  y[x < (qnt[1] - H)] <- NA
  y[x > (qnt[2] + H)] <- NA
  y
}


data_wins <- sapply(my_data[,c("assets", "kkm", "pcrdbgdp", "stmktcap", "gdp_growth_annual")], remove_outliers) %>% 
  
  cbind(my_data[,c("mfiid", "mfiname", "year", "country", "currentlegaldummy", 
"currentlegalstatus", "age", "legal_tradition", "region", "dummy", "count")]) %>% 
  
  na.omit() %>% 
  
  relocate(mfiid:count)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
logit_full_wins <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual + 
       factor(year), data = data_wins, 
       family = binomial("logit"))

#### Probit
probit_full_wins <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual + 
       factor(year), data = data_wins,
       family = binomial("probit"))

logit_full_wins_ny <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual, 
       data = data_wins, 
       family = binomial("logit"))

#### Probit
probit_full_wins_ny <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual, 
       data = data_wins,
       family = binomial("probit"))
```

```{r, results = 'asis', echo = FALSE, message = FALSE, warning = FALSE}
## Write out the models using stargazer
stargazer(logit_full_wins, probit_full_wins, logit_full_wins_ny, probit_full_wins_ny, title = "Regression Results - Logit and Probit Models for Winsorized Data", font.size = "footnotesize", header = FALSE, omit = "^factor.", dep.var.labels = "Dummy: Current Legal Status (Standard Errors in Brackets)", add.lines = list(c("Year Effects", "Yes", "Yes", "No", "No"), c("Deviance", "664***", "657***", "602***", "595***"), c("df", "29", "29", "9", "9"), c("Data", "Winsorized", "Winsorized", "Winsorized", "Winsorized")), notes.align = "l")
```


\blandscape

```{r, fig.cap = "Visualisation of Outliers", echo = FALSE, message = FALSE, warning = FALSE, fig.width=9, fig.height=6}
plot(logit_full, which = 4, id.n = 3, main = "")
```

\elandscape

#### Multicollinearity
The problem of multicollinearity among independent variables leads to unstable coefficients. In the baseline model, however, multicollinearity is not a significant issue because, as per Table 2.15, in all cases, the variance inflation factors(VIFs) are below the 5 (sometimes 10) threshold that several researchers recommend [@gujarati2012econometrics]. Table 2.15 shows the VIFs for each variable. 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
car::vif(logit_full) %>% 
  
  kbl(., caption = "Variance Inflation Factors for Logit Model", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction",
           
           general_title = "")
```

#### Linearity assumptions
Here, we check the linear relationship between independent numeric variables and the logit of the outcome by visually inspecting the scatter plot between each predictor and the logit values. As Figure 2.5  below shows, most variables could reasonably fit a linear model, though not perfectly [@cheng2007testing]. The fitted line uses the Locally Weighted Scatterplot Smoothing (LOESS) method, hence the perceived non-linearity. 

\blandscape

```{r, fig.cap = "Linearity of Independent Variables", echo = FALSE, message = FALSE, warning = FALSE, fig.width=9, fig.height=6}
## Select only continuous variables
linearity <- my_data %>% 
  
  select(where(is.numeric), -mfiid, -year, -prbonds, -dummy, -count)

## Select names of the numeric predictors
predictors <- names(linearity)

## Predict from the model
probabilities <- predict(logit_full, type = "response")

predicted.classes <- ifelse(probabilities > 0.5, "others", "NGO") %>% 
  
  factor(levels = levels(my_data %>% select(currentlegaldummy)))

# Bind the logit and tidying the data for plot
linearity <- linearity %>%
  mutate(logit = log(probabilities/(1-probabilities))) %>%
  gather(key = "predictors", value = "predictor.value", -logit)

ggplot(linearity, aes(logit, predictor.value))+
  geom_point(size = 0.5, alpha = 0.5) +
  geom_smooth(method = "loess") + 
  theme_bw() + 
  facet_wrap(~predictors, scales = "free_y") + 
  ggtitle("")
```

\elandscape

### Other Robustness Checks
In many cases, it is unlikely that a credit union starts as an NGO, given that they primarily serve clients with a similar professional base and geographic background. For this reason, we run a regression, excluding cooperatives, with the results displayed in Appendix 1. The results remain robust in this case, noting that signs of the coefficients do not change. 

## Conclusion
This article examined the factors that drive the transformation of MFIs from the NGO, not-for-profit model to the commercial, for-profit model, focusing on Africa. The analysis shows that at the MFI level, there are three critical factors; age, legal tradition, and size matter. At the aggregate level, it is the country institutional quality and stock market capitalisation that matter. Specifically, older firms are most likely to follow the not-for-profit model, while newer firms are most likely commercial. We expect that older firms are better at attracting donations and subsidies and hence still follow the earlier tradition of microfinance as a welfare tool to aid the financially excluded [@d2017ngos]. For legal tradition, MFIs in civil law countries are the least likely to follow the commercial model relative to those in common law countries. The results align with the finance and law literature, where civil law countries have weaker capital markets. Hence, MFIs have a market void to fill profitably, unlike in common law countries where mainstream markets already fill much of the gap, leaving relatively fewer profit opportunities  [@la2013law; @schnyder2018twenty]. MFIs in countries following other legal traditions other than common law and civil law are most likely to follow the commercial model. 

Turning to size, larger firms tend to adopt the commercial model compared to relatively younger firms. We expect that larger firms are better at attracting commercial capital courtesy of the goodwill and the collateral to pledge when seeking funds publicly. Institutional quality relates positively to adopting the commercial model at the country level, while stock market capitalisation has the opposite effect. Institutional quality affects the ease of contracting, contract enforcement, and property rights [@claessens2003financial]. Private credit to GDP and GDP growth rates are not significant drivers of the conversion of MFIs. However, the coefficients' signs indicate that private credit to GDP, like the stock market to GDP ratio, is inversely related to transformation probability. At the same time, GDP growth shows mixed effects, with significant positive coefficients.


\newpage

## Appendices
### Appendix 1: Binary Models (Excl. Cooperatives)
```{r, results = 'asis', echo = FALSE, message = FALSE, warning = FALSE}
### Pooled logit
logit_pooled_no_coop <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual + factor(year), 
       data = (my_data %>% filter(currentlegalstatus != "Credit Union/ Cooperative ")), family = binomial("logit"))

### Pooled probit
probit_pooled_no_coop <- glm(dummy ~ age + legal_tradition + 
       assets + kkm + 
       pcrdbgdp + stmktcap + gdp_growth_annual + factor(year), 
       data = (my_data %>% filter(currentlegalstatus != "Credit Union/ Cooperative ")), family = binomial("probit"))

stargazer(logit_pooled_no_coop, probit_pooled_no_coop, title = "Models Excluding Cooperatives (Standard Errors in Brackets)", font.size = "footnotesize", header = FALSE, omit = "^factor.", dep.var.labels = "Dummy: Current Legal Status", add.lines = list(c("Year Effects", "Yes", "Yes"),                      
c("Deviance", "664***", "657***"), c("df", "29", "29"), c("Data", "No Credit Unions", "No Credit Unions")), notes.align = "l")
```

\newpage

### Appendix 2: Multinomial Logit Model- Full Dataset

```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
## Results 
stargazer(multinom_full, title = "Multinomial Logit Model- Full Data (Standard Errors in Brackets)", font.size = "footnotesize", dep.var.labels = "Dummy: Current Legal Status", header = FALSE, omit = "^factor.", add.lines = list(c("Year Effects", "Yes", "Yes", "Yes", "Yes", "Yes"), c("Data", "Full", "Full", "Full", "Full", "Full")), notes.align = "l")
```

\newpage

### Appendix 3: Multinomial Logit Model- Full Data Excluding Credit Unions/ Cooperatives
```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
## Results 
stargazer(multinom_no_coop, title = "Multinomial Logit Model- Full Data Without Cooperatives (Standard Errors in Brackets)", font.size = "footnotesize", header = FALSE, omit = "^factor.", dep.var.labels = "Dummy: Current Legal Status", add.lines = list(c("Year Effects", "Yes", "Yes", "Yes", "Yes", "Yes"), c("Data", "Full", "Full", "Full", "Full", "Full")), notes.align = "l")
```

\newpage

### Appendix 4: Multinomial Logit Model With Full Dataset But No Year Effects
```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
## Results 
stargazer(multinom_full_ny, title = "Multinomial Logit Model- Full Data Without Year Effects (Standard Errors in Brackets)", font.size = "footnotesize", header = FALSE, omit = "^factor.", dep.var.labels = "Dummy: Current Legal Status", add.lines = list(c("Year Effects", "Yes", "No", "No", "No", "No"), c("Data", "No Coop", "No Coop", "No Coop", "No Coop", "No Coop")), notes.align = "l")
```

\newpage

### Appendix 5: Multinomial Logit Model- Full Data Excluding Credit Unions/ Cooperatives and Year Effects
```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
## Results 
stargazer(multinom_full_no_coop_ny, title = "Multinomial Logit Model- Full Data Excluding Cooperatives and Year Effects (Standard Errors in Brackets)", dep.var.labels = "Dummy: Current Legal Status", font.size = "footnotesize", header = FALSE, omit = "^factor.", add.lines = list(c("Year Effects", "No", "No", "No", "No", "No"), c("Data", "Full", "Full", "Full", "Full", "Full")), notes.align = "l")
```

\newpage

### Appendix 6: Legal Traditions in Africa

```{r, echo = FALSE, message = FALSE, warning = FALSE}

knitr::kable(list(
##############################################################################
legal %>% 
  
  filter(trad == "common") %>% 
  
  select(country) %>% 
  
  rename(Common_Law = country) %>% 
  
  tibble(),

##############################################################################
legal %>% 
  
  filter(trad == "civil") %>% 
  
  select(country) %>% 
  
  rename(Civil_Law = country) %>% 
  
  tibble(),

#############################################################################
legal %>% 
  
  filter(trad == "others") %>% 
  
  select(country) %>% 
  
  rename(Other_Law = country) %>% 
  
  tibble()
), caption = "Legal Traditions in Africa", 

format = "latex", booktabs = TRUE, position = "h!")
##############################################################################
```






<!--chapter:end:03-rmd-basics-cites-and-refs.Rmd-->

---
output:
  #bookdown::html_document2: default
  #bookdown::word_document2: default
  bookdown::pdf_document2:
    template: templates/brief_template.tex
    citation_package: biblatex
bib-humanities: true
documentclass: book
bibliography: references.bib
always_allow_html: true
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
- \usepackage[default]{sourcesanspro}
- \usepackage[T1]{fontenc}
- \usepackage{amsmath}
- \usepackage{dcolumn}
- \usepackage{url}
---

```{block type='savequote', quote_author='(ref:world-bank-quote)', include=knitr::is_latex_output()}
“No end to poverty without financial inclusion."
```
(ref:world-bank-quote) --- The World Bank.


# Transformation of Microfinance Institutions and its Effects on Financial Inclusion in Africa 
\chaptermark{MFI Transformation and Financial Inclusion}
\minitoc <!-- this will include a mini table of contents-->

\newpage

\begin{center}

\textbf{ABSTRACT}

\end{center}

> The shift away from the not-for-profit, non-governmental organisations microfinance institutions (NGO-MFIs) model has seen the rise of commercial MFIs in forms such as commercial banks, credit unions, and rural banks. The shift arose partly due to neo-liberalism and the need for MFIs to reach the financially excluded more sustainably than had hitherto been the case. Therefore, this article examines how the shift has affected financial inclusion in Africa, utilising data from the Microfinance Information Exchange (MIX). Our results show that the transformation from the NGO model to the commercial models could negatively affect the depth of financial outreach, especially given that NGOs characteristically have better outreach to women and advance smaller denomination loans on average. We also find that NGOs have higher median gross loans than other legal forms of MFIs except cooperatives, although commercial banks have the highest average gross loans. These results remain robust upon removing outliers and controlling for factors that affect the ability of MFIs to offer financial services to the poor.

\vspace{10mm}

**Key Words**: Microfinance, Transformation, Financial Inclusion, Africa

\vspace{5mm}
**JEL Classification**: G210, G230

\newpage


```{r, echo = FALSE, message = FALSE, warning = FALSE}

library("pacman")
library("bookdown") 
library("broom") 
library("car") 
library("caret") 
library("corrplot") 
library("dtplyr")
library("excelR") 
library("GGally") 
library("ggalt") 
library("ggeasy") 
library("gghalves") 
library("ggrepel")  
library("ggthemes") 
library("gmnl") 
library("gmodels") 
library("gplots") 
library("gridExtra") 
library("gtable")
library("here") 
library("janitor") 
library("kableExtra") 
library("knitr") 
library("lme4") 
library("lmtest")
library("magrittr") 
library("margins") 
library("mice") 
library("nnet") 
library("pacman") 
library("patchwork") 
library("pcse")
library("pglm") 
library("plm") 
library("prettydoc") 
library("pROC") 
library("psych") 
library("Rchoice") 
library("rDEA")
library("readxl")
library("rmarkdown") 
library("skimr") 
library("stargazer") 
library("tidymodels") 
library("tidyverse")
library("treemapify") 
library("viridis") 
library("wesanderson") 
library("zoo")

#########################################
options(digits = 3)
options(scipen=999)
options(knitr.kable.NA = "-")
theme_set(ggthemes::theme_clean())
#########################################
```


\newpage

## Background

In 1992, PRODEM, a micro-finance institution (MFI) in Bolivia, converted from a non-governmental organisation (NGO) to a commercial bank, BANCOSOL. In fact, in the immediate past three decades, numerous NGO MFIs across the globe have adopted the commercial forms of microfinance (Table 3.1). In this article, we examine how the conversion of MFIs to the commercial model affects financial inclusion in terms of the depth and breadth of outreach to the financially excluded. Depth refers to the extent of the traditional financially excluded clients reached by MFIs. If an MFI serves more financially excluded people like women and the poor, it has deeper outreach ^[The quotation at the start of the chapter is available at @financialtimesinclusion.

On the other hand, breadth refers to the sheer number of clients reached regardless of their level of financial exclusion. Thus, an MFI that offers more loans to many people has more breadth of outreach. In other words, we explore how the transformation of MFIs typically drives their average loan balance per borrower, the proportion of women borrowers and gross loans. The former two metrics capture depth while the latter proxies breadth.

The study focuses on Africa, a continent that is the epicentre of financial exclusion despite remarkable economic progress of the last three decades [@beck2014sme; @allen2011african]. Evaluating the effects of transformation by using global metrics is likely to mask regional heterogeneity, given that these effects could manifest differently in varying settings [@d2017ngos; @d2013unsubsidized] [^1].

[^1]: We use the terms financial sustainability/ efficiency/ profitability on the one hand and social performance/ outreach on the other interchangeably. By Financial sustainability, we refer to the capability of a firm to turn a profit, which allows it to meet its obligations without relying on donations and subsidies. Social performance/ outreach is the firm's ability to reach out and avail financial services to the financially excluded members of society, including the poor, women, and rural dwellers- referring to both breadth and depth.

Most pioneer microfinance institutions adopted a not-for-profit model [@dichter1996questioning], operating mainly as non-governmental organisations (NGOs). However, the dominance of neo-liberalism in organising production has seen many donors scale back and push MFIs to strive for financial sustainability [@bateman2010doesn]. The arguments for the commercial approach to running microfinance activities revolve around sustainability. The financial sustainability school posits that MFIs can best serve the financially excluded when they have a degree of financial self-sufficiency [@kodongo2013individual]. For instance, profit-oriented MFIs could offer financial services to the relatively well-off at market rates and use the proceeds (profits) to subsidise services to the poor more than relying on donations and subsidies alone. Hence, MFIs pursuing the for-profit model may experience mission expansion [@mersland2010microfinance; @louis2013financial]. Also, donor funds are volatile and subject to political and economic conditions [@garmaise2013cheap; @d2017aid]. In this respect, a substantial body of research finds that the transformation of microfinance institutions enhances outreach to the financially excluded [@frank2008stemming; @gutierrez2009social; @mersland2010microfinance; @quayes2012depth; @mia2017mission; @d2013unsubsidized].

The proponents of MFI transformation point to the concerning possibility of mission drift. Mission drift happens when MFIs focus less on providing financial services to the financially excluded in favour of making profits. Some researchers have found this to be the case [@louis2013financial; @bos2015practice; @d2013unsubsidized; @hartarska2012governance]. Two theories can be said to underpin the MFI transformation phenomenon. The first is the agency theory on the conflicts between providers of capital and managers. In a quest to minimise agency conflicts, managers may consciously or sub-consciously place less emphasis on the social mission of MFIs, reaching out to the financially excluded. Instead, managers may more overtly focus on pursuing financial returns for shareholders and debt-holders, thus causing mission drift. The theory presumes that the motivation for all fund providers is financial returns, which is not always the case.

The second one, the institutional theory, examines the rise, persistence and decline of institutional structures over time. The central question here is; What drives the adoption and fall of certain institutional norms [@powell2012new]? In this respect, some institutionalists claim that prevailing institutional culture is more potent than market forces in driving the adoption or rejection of emergent institutional structures. Institutionalists posit that one of the drivers is coercion. In the case of MFIs, some donors have put implicit or explicit pressure on financial sustainability.

Additionally, the adoption of institutional norms in most cases arises out of the need to fit into the institutional environment. The desire to be compliant may explain the prevalence of NGOs not-for-profit type MFIs in the early years of the microfinance paradigm and the trend towards the transformation of MFIs to commercial entities that is now ongoing. Notably, institutional theory sheds light on the dilemmas managers face when institutional norms change [@thornton2015institutional]. For instance, how can managers of MFIs reconcile financial sustainability with the original priority of outreach to the financially excluded?

```{r, echo = FALSE, message = FALSE, warning = FALSE}
library(tibble)

tribble(~ Institution, ~ Country, ~ Year, ~ Converted_to,
        "Finansol", "Colombia", "1993", "Commercial Finance Company",
        "OIBM", "Malawi", "2002", "NBFI",
        "PRIDE", "Tanzania", "2009", "NBFI",
        "Kenya Women Finance Trust", "Kenya", "2010", "NBFI",
        "Faulu", "Kenya", "2010", "NBFI",
        "OI-SASL", "Ghana", "2013", "NBFI") %>%
  
  kbl(., caption = "Sample of Transformed MFIs", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = FALSE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from the literature",
           
           general_title = "",
           
           number = c("This is a snapshot of the many MFIs that have converted over the years accross the globe"),
           number_title = "Note: ")
```


As noted earlier, research outcomes on the effects of the transformation of microfinance institutions are mixed. @morduch2019challenges argue that if commercial MFIs could sustainably achieve financial sustainability while also reaching the poor, NGOs would not exist. In that context, therefore, the most critical question relates to how the transformation of MFIs would affect their core mission of providing financial services to the financially excluded. The issue is vital due to the legitimacy that MFIs derive from serving the financially excluded. Besides, financial inclusion is central to alleviating poverty and achieving inclusive growth, an essential dimension of financial development. In this article, we use data from the Microfinance Information Exchange (MIX) to evaluate the ways that the transformation of MFIs affects financial inclusion in Africa.

We capture the extent of financial inclusion in Africa by using three metrics:

- The percentage of female borrowers.
- Average loan balance per borrower.
- The ratio of the gross loan portfolio to total assets of each MFI [@d2017ngos].

The first two metrics proxy the depth of outreach, with more significant outreach to women indicating deeper outreach, given that women form a substantial proportion of the financially excluded population in Africa [@ayyagari2013financing]. A higher average loan balance per borrower, on the other hand, corresponds to a lower depth of outreach to any group of the financially excluded. The presumption is that financially excluded people usually borrow in smaller denominations that have drawn reservations from some researchers who argue poor people could progressively demand bigger loans as they get better off. Also, MFIs regularly use progressive lending where people who successfully pay off loans qualify for larger loan amounts. Finally, gross loans to assets capture the breadth of outreach, with higher ratios indicating more breadth.

We have organised the rest of the article as follows. Section 1.1 highlights the results of the study. In section 2, we review the background literature on MFI transformation. In section 3, we describe the methodology and, in section 4, we present and discuss the results and close with concluding remarks in section 5. 

### Summary of Results

Overall, we find that the conversion away from the NGO, not-for-profit model in Africa is harmful to financial inclusion's depth and breadth. NGO-type MFIs consistently outperform the commercial-oriented MFIs regarding the outreach to women borrowers. Additionally, NGO-type MFIs have the lowest average loan balance per borrower, indicating that they reach out to the poorest and, presumably, more financially excluded people. Turning to the ratio of gross loans to assets, NGO-type MFIs come second to credit unions/ cooperatives, thus indicating that breadth and depth of outreach are not necessarily mutually exclusive. Further examination of the trend suggests that profit-oriented MFIs reflect a measure of mission drift.

On the one hand, serving poor, financially excluded people is costly, which hurts the profitability of MFIs. On the other hand, profit orientation implies commercial capital, interest expense on debt capital and dividends on equity capital. If it is hard to reconcile these two objectives, we are inclined to back the literature that opposes the commercialisation of MFIs. As we shall see later, it seems odd that NGO-type MFIs lend more gross loans (breadth) than most commercial-oriented MFIs, though it turns out that both cooperatives and NGO-type MFIs hold the lowest volume of assets relative to other legal types. Furthermore, the other important drivers of financial inclusion are the age of MFI, operating expense to assets ratio, donations to assets ratio, capital to assets ratio, asset structure, size, education and profit margin. In the next section, we highlight the methodology and then go to the details of the results.

## Theory and Empirical Literature

The extent to which the transformation of MFIs affects financial inclusion has been the subject of substantial research. However, there is a lack of consensus on the outcomes about its effects. Theories underlying aspects of the transformation of MFIs are the agency theory [@jensen1976theory] and institutional theory [@powell2012new]. Agency theory, in this case, implies that injection of commercial capital, a consequence of transformation, is likely to motivate managers to target financial return at the expense of social return to satisfy shareholders and debt-holders, the conventional providers of commercial capital. From this perspective, transformation implies that mission drift is inevitable. Indeed, @morduch2019challenges argue that if mission drift is not an issue in microfinance, then the NGOs MFI model would not exist, meaning that NGOs (not-for-profit) MFIs exist to fill a gap left by commercial MFIs.

The institutionalists weigh how specific organisational structures dominate and ultimately decline and get discarded [@powell2012new]. Institutionalists note that in certain situations, people adopt given structures without critical scrutiny to fit into the prevailing institutional environment merely. This argument could partly explain the prevalence of NGO MFI models at the early stages of microfinance evolution and the current rise of MFI commercialisation. However, the pressure to change takes several forms, with the most notable one being coercive pressure, where stakeholders put forth overt or covert pressure for MFIs to convert. In the case of MFIs, the pressure to adopt a commercial model came with the rise of neo-liberal thought around production and its funding [@bateman2010doesn], with major donors like USAID signalling their expectation that MFIs should become more financially sustainable going forward [@d2013unsubsidized]. The problem for MFIs that transform is how best to balance between social goals of reaching the poor and the commercial goals that come with commercial capital and the attendant decline of donor funding.

@thornton2002rise and @thornton2015institutional note that "the meaning and legitimacy of various sources of organisational identity, strategy and structure are shaped by a prevailing institutional logic". The management of transformed MFIs can identify with microfinance as a social pursuit by emphasising social goals over profits. Alternatively, they may view microfinance as a financial venture by placing profits over social outreach. The former corresponds to the welfare model of microfinance, which posits that the social mission of microfinance is incompatible with the profit motive. The latter is the financial sustainability model, which views financial returns as a precondition for the sustainable pursuit of financial services goals of reaching the financially excluded. A third model, the win-win approach, attempts to reconcile the welfare and sustainability approach by proposing that financial and social performance are not always substituting but complementary. Different researchers have availed evidence in support of either school, as described next.

As noted, support for MFI transformation rests on two primary grounds. First, donations are subject to social, economic, and political conditions [@garmaise2013cheap; @armendariz2013subsidy; @d2017aid]. Consequently, some researchers argue that microfinance can only be sustainable if MFIs have a level of financial self-sufficiency. In this regard, these scholars note that MFIs could advance financial services to the financially well-off and use the proceeds (profits) to reach more financially excluded people at subsidised rates, which would then lead to "mission expansion" as opposed to "mission drift". @frank2008stemming provides empirical support for these arguments noting that transformed MFIs score higher in terms of client outreach and the number of female clients reached, although the proportion of female clients reached declines. They also find that transformed MFIs record higher growth in gross loan portfolio with better product diversification.

Similarly, @d2017ngos finds that transformed MFIs charge a lower interest rate to micro-borrowers. @louis2013financial, using self-organising maps and k-means clustering, find a positive relationship between financial sustainability and social performance to imply that steps to enhance financial sustainability are good. Other researchers that have found a positive link between financial and social efficiency include @gutierrez2009social, @mersland2010microfinance, and @quayes2012depth.

In contrast to the above findings, several researchers have found transformation to be harmful in terms of outreach to the financially excluded. For instance, @d2017ngos find that although transformed MFIs charge lower interest and experience a drop in operating expenses, their average loan sizes increase, indicative of mission drift. @mia2017mission also find a trade-off between depth of outreach and the profit motive of MFIs in Bangladesh using both static and dynamic panel data methods. @d2013unsubsidized notes that MFIs with little or no subsidies exhibit more significant mission drift. In our case, NGOs have the highest donations, implying that they may show greater social inclination. For instance, firms in Africa and Asia compensate for low subsidies by charging higher interest rates, while Latin America serves fewer women. In Europe and Central Asia, the tendency is to serve fewer indigent clients. @bos2015practice also notes that MFIs that stay close to their original mission are the most socially efficient, while those that attempt to pursue a double bottom line are relatively inefficient. Further, they note that not all MFIs suffer mission drift the same way, arguing that MFIs with high input-output efficiency may not experience mission drift at all.

Besides, @campion1999institutional argue that the presence or absence of mission drift in a transformed MFI is a corporate governance issue and an outcome of the challenges of the scaling up of MF services. They argue that good corporate governance allows the management to balance between financial performance and outreach. It means that MFIs could address mission drift problems through proper corporate governance regardless of whether an MFI is an NGO or commercial-type entity. Moreover, @marti2016financial argue that different social groups such as employees, management, and MFI clients are likely to have different views, including varying definitions of social welfare. Thus, the presence or absence of mission drift may not arise from deliberate management decisions but instead from conflicting viewpoints on the meaning of social welfare between stakeholders. Given the conflicting evidence and varying views regarding mission drift in MFIs, the arguments by @morduch1999microfinance and @morduch2000microfinance that the microfinance industry should accommodate different legal forms of MFIs to serve different clients' needs appear to be valid.

## Method

We run fixed and random effects models based on the results of the Hausmann Tests (see Appendix 1). The design of fixed effects models allows for the study of the causes of changes within an entity. It accomplishes this by controlling for all time-invariant differences between the individuals, so the estimated coefficients of the fixed-effects models cannot be biased because of omitted time-invariant characteristics, such as culture [@torres2007panel]. On the other hand, Random effect models assist in controlling for unobserved heterogeneity when the heterogeneity is constant over time and uncorrelated with the explanatory variables. Following @roberts2013endogeneity, we fit the following model.

\begin{equation}
y_{it} = \hat{a} + \hat{b}x_{it} + \mu_{it}
\end{equation}

In this case, $y_{it}$ is the independent variable; interchangeably represented by per cent of female borrowers, average loan balance per borrower, and gross loan portfolio to total assets. The first two metrics capture financial depth, while gross loans capture the breadth of outreach.

Also, $x_{it}$ is a matrix of independent variables. The variable of interest in our case is the current legal form of the MFI, which enters the model as a dummy representing NGOs, NBFIs, commercial banks, rural banks and credit unions/ cooperatives [@ayyagari2013financing]. The other control variables include age dummy, a dummy for region, operating expenses to assets ratio, donations to assets ratio, equity capital to assets ratio, asset structure, size (logarithm of total assets), education, and profit margin all of which are derived from the literature [@ayyagari2013financing; @d2017ngos; @d2013unsubsidized]. 

Finally, $\mu_{it}$ is the error term that we assume has zero mean conditional on $x_{it}$.

Further,


\begin{equation}
\mu_{it} = c_{i} + \varepsilon_{it}
\end{equation}


In the equation, $c_{i}$ captures the aggregate effects of the unobserved, time-invariant explanatory variables for $y_{it}$. 

In the case where $c_{i}$ and $x_{it}$ are correlated, then $c_{i}$ is a fixed effect, otherwise, it is a random effect. Note that the existence of fixed effects implies the presence of endogeneity. For random effects, on the other hand, endogeneity is not a concern. However, the random-effects model affects the computation of standard errors [@roberts2013endogeneity]. To eliminate the fixed effect prone to endogeneity, we run the within estimator model [@clark2015should]. We present the results from the estimation of the empirical model in the next section.

## Results

In this section, we begin by visualizing the study variables followed by summary statistics of the variables. We then run and discuss the results of the regression model.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## legal traditions 
### Common law countries in Africa
common <- tibble(country = c("Botswana", "Gambia, The", "Ghana", "Kenya", "Lesotho", "Liberia", "Malawi", "Namibia", "Nigeria", "Sierra Leone", "South Africa", "South Sudan", "Sudan", "Eswatini", "Tanzania", "Uganda", "Zambia", "Zimbabwe"), trad = c(rep("common", 18)))

### Civil law countries in Africa
civil <- tibble(country = c("Algeria", "Benin", "Burkina Faso", "Cameroon", "Central African Republic", "Chad", "Comoros", "Congo, Rep.", "Cote d'Ivoire", "Gabon", "Guinea", "Madagascar", "Mali", "Mauritania", "Morocco", "Niger", "Senegal", "Togo", "Tunisia"), trad = c(rep("civil", 19)))

### Other legal traditions in Africa
others <- tibble(country = c("Equatorial Guinea", "Angola", "Burundi", "Cape Verde", "Congo, Dem. Rep.", "Egypt, Arab Republic of", "Ethiopia", "Eritrea", "Guinea-Bissau", "Mozambique", "Rwanda"), trad = c(rep("others", 11)))

###Putting them all together
legal <- rbind(common, civil, others)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Bond market data - private and public bond market capitalization to GDP
bonds <- read_excel("bonds_oluoch.xlsx") %>% 
  
  janitor::clean_names()

```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Add the financial development index to the dataset
## Countries not part of Africa
mideast <- c("Bahrain", "Iran, Islamic Rep.", "Iraq", "Israel", "Jordan", "Kuwait", "Lebanon", "Malta", "Oman", "Qatar", "Saudi Arabia", "Syrian Arab Republic", "United Arab Emirates", "West Bank and Gaza", "Yemen, Rep.")

## Load the financial structure data
finstr <- read_excel("FinancialStructureDatabase20191018.xlsx", sheet = 4) %>% 
  
  ## Select desired variables
  select(country, region, year, pcrdbgdp, stmktcap, stvaltraded, stturnover, listco_pc) %>% 
  
  ### Filter out regions not in Africa or middle east
  filter(region == "Sub-Saharan Africa" | region == "Middle East & North Africa") %>% 
  ### Filter out countries in middle east and select year 1999 onwards
  filter(!country %in% mideast, year >= 1999) %>% 
  
## Replace NAs
          group_by(country) %>% 
  
          mutate(pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
                 
                 pcrdbgdp = replace_na(pcrdbgdp, 0),
                 
                 stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE)),
                 
                 stmktcap = replace_na(stmktcap, 0)) %>% ungroup() %>% 
  
## Join with the bonds data
  left_join(bonds, by = c("country", "year")) %>% 
  
## rename bonds columns 
  rename(prbonds = outstanding_t_bonds_percent_gdp, 
         
         pubonds = outstanding_c_bonds_percent_gdp) %>% 
  
  ## Replace NAs in public bond and private bond markets 
  mutate(pubonds = replace_na(pubonds, 0), 
         
         prbonds = replace_na(prbonds, 0)) %>% 
  
         ## Rename Ivory Coast
         mutate(country = if_else(country == "Côte d'Ivoire", "Cote d'Ivoire", 
                                  
                                  country))

## View missing data points
#mice::md.pattern(finstr)

#finstr %>% select(pcrdbgdp, stmktcap) %>% cor(.) %>% 
  
  #corrplot(method = "number", type = "lower")
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Read in the dataset 
my_data <- read_csv("amelia.csv") %>% 

## Region
mutate(region = if_else(region == "Middle East and North Africa", 
                        
                        "North_Africa", region)) %>% 

# Clean the names 
janitor::clean_names() %>% 
  
# Set up factor variables 
## legal status 
mutate(currentlegalstatus = factor(currentlegalstatus, 
                           levels = c("NGO", "Bank", "NBFI", 
                            "Credit Union/ Cooperative", 
                            "Rural Bank")), 
      ## Age
      age = factor(age, levels = c("New", "Young", "Mature")),
       
      ## Region 
      region = factor(region, levels = c("North_Africa", "Africa"))) %>% 
  
      ## Add the financial structure data     
      left_join(finstr, by = c("country", "year")) %>% 
  
      ## Add a binary variable for the legal dummy- NGO vs Others
      mutate(currentlegaldummy = case_when(currentlegalstatus == "NGO" ~ "NGO",
                                           
                                           TRUE ~ "others"),
      
        currentlegaldummy = factor(currentlegaldummy, levels = c("NGO", "others")),
        
        legal_tradition = factor(legal_tradition, 
                                 
                                 levels = c("Common", "Civil", "Other"))
        
        ) %>% 
  ## Select required variables 
  select(mfiid, mfiname, year, country, currentlegaldummy, currentlegalstatus, 
         
         percent_of_female_borrowers, operational_self_sufficiency,
         
         age, legal_tradition, region.x, asset_structure, 
         
         assets, kkm, education, pcrdbgdp, stmktcap, prbonds, 
         
         gdp_growth_annual, donations, donations_assets_ratio, 
         
         profit_margin, capital_asset_ratio,
         
         debt_to_equity_ratio, operating_expense_assets, 
         
         average_loan_balance_per_borrower, gross_loan_portfolio_to_total_assets, 
         
         deposits_to_total_assets) %>% 
  
          ## Rename region
         rename(region = region.x) %>% 
  
  group_by(country) %>% 
  
  mutate(kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         education = replace_na(education, median(education, na.rm = TRUE)),
         prbonds = replace_na(prbonds, median(prbonds, na.rm = TRUE)),
         pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
         stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(mfiid) %>% 
  
  mutate(asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)), 
         
         percent_of_female_borrowers = replace_na(percent_of_female_borrowers, 
                                                  
                                                  median(percent_of_female_borrowers, na.rm = TRUE)),
         
         operational_self_sufficiency = replace_na(operational_self_sufficiency, 
                                                   
                                                   median(operational_self_sufficiency, na.rm = TRUE)),
         
         assets = replace_na(assets, median(assets, na.rm = TRUE)),
         
         donations = replace_na(donations, median(donations, na.rm = TRUE)),
         
         donations_assets_ratio = replace_na(donations_assets_ratio, 
                                             
                                  median(donations_assets_ratio, na.rm = TRUE)), 
         
         profit_margin = replace_na(profit_margin, median(profit_margin, na.rm = TRUE)),
         
         capital_asset_ratio = replace_na(capital_asset_ratio, median(capital_asset_ratio, na.rm = TRUE)),
         
         debt_to_equity_ratio = replace_na(debt_to_equity_ratio, median(debt_to_equity_ratio, na.rm = TRUE)),
         
         operating_expense_assets = replace_na(operating_expense_assets, median(operating_expense_assets, na.rm = TRUE)),
         
         deposits_to_total_assets = replace_na(deposits_to_total_assets, median(deposits_to_total_assets, na.rm = TRUE))
         
         
         ) %>% 
  
  ungroup() %>% 
  
  group_by(region) %>% 
  
  mutate(education = replace_na(education, median(education, na.rm = TRUE)),
         
         kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         
         gdp_growth_annual = replace_na(gdp_growth_annual, 
                                        
         median(gdp_growth_annual, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(currentlegalstatus) %>% 
  
  mutate(assets = replace_na(assets, median(assets, na.rm = TRUE)), 
         
         percent_of_female_borrowers = replace_na(percent_of_female_borrowers, 
                                                  
                        median(percent_of_female_borrowers, na.rm = TRUE)),
         
         operational_self_sufficiency = replace_na(operational_self_sufficiency, 
                                                   
                        median(operational_self_sufficiency, na.rm = TRUE)),
         
         donations = replace_na(donations, median(donations, na.rm = TRUE)),
         
         donations_assets_ratio = replace_na(donations_assets_ratio, 
                                             
                                  median(donations_assets_ratio, na.rm = TRUE)),
         
         profit_margin = replace_na(profit_margin, median(profit_margin, na.rm = TRUE)),
         
         capital_asset_ratio = replace_na(capital_asset_ratio, median(capital_asset_ratio, na.rm = TRUE)),
         
         asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)),
         
         debt_to_equity_ratio = replace_na(debt_to_equity_ratio, median(debt_to_equity_ratio, na.rm = TRUE)),
         
         operating_expense_assets = replace_na(operating_expense_assets, median(operating_expense_assets, na.rm = TRUE)),
         
         deposits_to_total_assets = replace_na(deposits_to_total_assets, median(deposits_to_total_assets, na.rm = TRUE))
         
         ) %>% 
  
  ungroup() %>% 
  
  mutate(dummy = if_else(currentlegaldummy == "NGO", 0, 1)) %>% 
  
  mutate(assets = log(assets + 1),
         
         pcrdbgdp = log(pcrdbgdp + 1),
         
         stmktcap = log(stmktcap + 1),
         
         prbonds = log(prbonds + 1)) %>% 
  
  add_count(mfiid, name = "count") %>% 
  
  mutate(currentlegalstatus = fct_recode(currentlegalstatus, Coop = "Credit Union/ Cooperative")) %>% 
  
  mutate(finsoc = case_when(operational_self_sufficiency >= 1 & percent_of_female_borrowers > 0.5 ~ "SS",
                            
                            operational_self_sufficiency > 1 & percent_of_female_borrowers < 0.5 ~ "SF", 
                            
                            operational_self_sufficiency < 1 & percent_of_female_borrowers >= 0.5 ~ "FS",
                            
                            TRUE ~ "FF")) %>% 
  
mutate(finsoc = factor(finsoc, levels = c("FF", "SF", "FS", "SS"))) %>% 
  
## replace negative donations with zero
mutate(donations = case_when(donations <= 0 ~ 1,
                             TRUE ~ donations))
## Write a csv for the data
my_data %>% write.csv(., "data.csv")

## Visualize missing data
#md.pattern(data)
## Amelia::missmap(data)

## MFIs with three (3) or more years of data
data3 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 3)
  
data3 %>% write.csv(., "data3.csv")

## MFIs with three (3) or more years of data
data5 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 5)  
  
data5 %>% write.csv(., "data5.csv")
```


######################################################################### 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
### Important functions ----
## Regression function - fixed, random and pooling
modelling <- function(data, depvar,
                      effect = c("individual", "twoways", "time", "nested"),
                      model = c("within", "random", "ht", "between", "pooling", "fd"),
                      inst.method = c("bvk", "baltagi", "am", "bms"),
                      random.method = c("swar", "amemiya", "walhus", "nerlove"),
                      digits = 4, index = c("mfiid", "year")){
  
## Load libraries
  library(plm)
  library(broom)
  library(pcse)
  library(car)
  library(zoo)
  library(lmtest)
  library(broom)
  library(stargazer)
  
  ## match arguments
  effect <- match.arg(effect)
  model <- match.arg(model)
  inst.method <- match.arg(inst.method)
  random.method <- match.arg(random.method)
  
  ## Run the Model
  unadjusted <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
          data = data, effect = effect,
          model = model, 
          inst.method = inst.method, index = index, 
          digits = digits)

unadjusted
}
```

########################################################################## 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Hausmann Test function
hausmann_test <- function(data, depvar){
  
  library(plm)
  library(broom)
  library(pcse)
  library(car)
  library(zoo)
  library(lmtest)
  library(broom)
  
  fixed <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin, 
               data = data, effect = "individual", model = "within", 
      index = c("mfiid", "year")) 
  
  random <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin, 
          data = data, effect = "individual", model = "random", 
      index = c("mfiid", "year"))
 
  broom::tidy(phtest(fixed, random))
}

```

############################################ 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Median function
median_n <- function(x){median(x, na.rm = TRUE)}
```

############################################ 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
theme_niwot <- function(){
  theme_bw() +
    theme(axis.text = element_text(size = 7), 
          axis.title.x = element_blank(),
          axis.title.y = element_text(size = 8),
          axis.line.x = element_line(color="black"), 
          axis.line.y = element_line(color="black"),
          panel.border = element_blank(),
          panel.grid.major.x = element_blank(),                                          
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          panel.grid.major.y = element_blank(),  
          plot.margin = unit(c(1, 1, 1, 1), units = , "cm"),
          plot.title = element_text(size = 10, vjust = 1, hjust = 0),
          legend.text = element_text(size = 8),          
          legend.title = element_blank(),                              
          legend.position = c(0.95, 0.15), 
          legend.key = element_blank(),
          legend.background = element_rect(color = "black", 
                                           fill = "transparent", 
                                           size = 2, linetype = "blank"))
}
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
###########################################
#' ggplot Flat Violin
#' @export
#' @details Copy-pasted from https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R
#' somewhat hackish solution to:
#' https://twitter.com/EamonCaddigan/status/646759751242620928
#' based mostly on copy/pasting from ggplot2 geom_violin source:
#' https://github.com/hadley/ggplot2/blob/master/R/geom-violin.r
#' @examples:
#' ggplot(diamonds, aes(cut, carat)) +
#'   geom_flat_violin() +
#'   coord_flip()
#' @import ggplot2
geom_flat_violin <- function(mapping = NULL, data = NULL, stat = "ydensity",
                             position = "dodge", trim = TRUE, scale = "area",
                             show.legend = NA, inherit.aes = TRUE, ...) {
  layer(
    data = data,
    mapping = mapping,
    stat = stat,
    geom = GeomFlatViolin,
    position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = list(
      trim = trim,
      scale = scale,
      ...
    )
  )
}

#' @rdname ggplot2-ggproto
#' @format NULL
#' @usage NULL
#' @export
GeomFlatViolin <-
  ggproto("GeomFlatViolin", Geom,
          setup_data = function(data, params) {
            data$width <- data$width %||%
              params$width %||% (resolution(data$x, FALSE) * 0.9)

            # ymin, ymax, xmin, and xmax define the bounding rectangle for each group
            data %>%
              group_by(group) %>%
              mutate(ymin = min(y),
                     ymax = max(y),
                     xmin = x,
                     xmax = x + width / 2)

          },

          draw_group = function(data, panel_scales, coord) {
            # Find the points for the line to go all the way around
            data <- transform(data, xminv = x,
                              xmaxv = x + violinwidth * (xmax - x))

            # Make sure it's sorted properly to draw the outline
            newdata <- rbind(plyr::arrange(transform(data, x = xminv), y),
                             plyr::arrange(transform(data, x = xmaxv), -y))

            # Close the polygon: set first and last point the same
            # Needed for coord_polar and such
            newdata <- rbind(newdata, newdata[1,])

            ggplot2:::ggname("geom_flat_violin", GeomPolygon$draw_panel(newdata, panel_scales, coord))
          },

          draw_key = draw_key_polygon,

          default_aes = aes(weight = 1, colour = "grey20", fill = "white", size = 0.5,
                            alpha = NA, linetype = "solid"),

          required_aes = c("x", "y")
  )


"%||%" <- function(a, b) {
  if (!is.null(a)) a else b
}
###########################################################
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# plotting function
plotter <- function(data, x , y, z, xlabel, ylabel, title){
  
  library(tidyverse)
  library(ggthemes)
  library(gghalves)
  library(ggalt)  
  library(ggrepel)  # for annotations
  library(viridis)  # for nice colors
  library(broom)  # for cleaning up models
  library(treemapify)  # for making area graphs
  library(wesanderson)  # for nice colors
  
  ggplot(data = data, mapping = aes(x = reorder({{x}}, {{y}}, median_n), 
  y = {{y}}, fill = {{z}})) + 
  geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8, aes(fill = {{z}})) +
  geom_half_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) + 
    geom_point(position = position_jitter(width = 0.15), size = 1, alpha = 0.1) + 
    scale_y_log10() + labs(y = ylabel, x = xlabel, 
  title = title) + 
  theme_niwot() + 
  theme(legend.position = "none") + 
  stat_summary(fun = mean, geom = "point", 
                size = 1, color = "red")}

##################################################
second_plotter <- function(data, x , y, z, xlabel, ylabel, title){

library(ggalt)  
library(ggrepel)  # for annotations
library(viridis)  # for nice colours
library(broom)  # for cleaning up models
# devtools::install_github("wilkox/treemapify")
library(treemapify)  # for making area graphs
library(wesanderson)  # for nice colours

  ggplot(data = data, 
           mapping = aes(x = reorder({{x}}, {{y}}, median_n), y = {{y}}, fill = {{z}})) +
    
    # The half violins
    geom_flat_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) +
    
    # The points
    geom_point(aes(y = {{y}}, color = {{x}}), 
    
    position = position_jitter(width = 0.15), size = 1, alpha = 0.1) +
    
    # The boxplots
    geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8) +
    
    # \n adds a new line which creates some space between the axis and axis title
    labs(x = xlabel, y = ylabel, title = title) +
    
    # Removing legends
    guides(fill = FALSE, color = FALSE) +
    
    # Setting the limits of the y axis
    #scale_y_continuous(limits = c(0, 1.2)) +
    
    # Picking nicer colours
    scale_fill_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    scale_colour_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    theme_niwot() + scale_y_log10()
}

##################################################
# plotting scatter diagrams 
plotter_scatter <- function(data, x, y, z, 
                            xlab, ylab, title) {
  
  # Load libraries
  library(tidyverse)
  library(gghalves)
  library(ggeasy)
  library(ggthemes)
  
  # write the function
  data %>% ggplot(aes(x = {{x}}, y = {{y}}, col = {{z}})) + 
    
    geom_point(shape = 1, size = 2) + 
    
    labs(x = xlab, y = ylab, title = title)
}
```

### Exploratory Data Analysis

In this section, we explore the data by visualizing the pertinent variables and computing their summary statistics. 

#### Data Visualization

Figure 3.1 shows the correlation matrix and a graphical view of the relationships between the numeric variables. The highest level of correlation is between operating expense to assets ratio and donations to assets ratio, meaning that MFIs that receive more donations spend relatively more, which is suitable for financial inclusion. On the other hand, the relatively low correlations between the variables suggest that multicollinearity is not likely to be a significant concern for the regression analysis that we embark on later in the article. The main diagonal shows the distribution of the individual variables. In this case, there is high skewness exhibited by the donations to assets ratio, average loan balance per borrower and gross loans to assets ratio. It means that relatively few firms account for a considerable chunk of the donations received, in this case among NGOs, cooperatives and NBFIs. The highest correlation exists between the operating expenses to assets ratio and donations to assets ratio, meaning that donor-funded MFIs have more operating costs probably because they are less constrained by profit/ interest seeking shareholders and debt holders. This observation may imply that if it is expensive to administer and monitor small loans, then the profit-oriented model is not suitable for financial inclusion as it constrains spending. The summary statistics in Tables 3.2, 3.3, and 3.4 that follow highlight the discussed issues but offer a more comprehensive array of statistical measures, including the mean, standard deviation and quantiles.


\newpage
\blandscape

```{r plots2, fig.cap = "Correlation Matrix for Independent Variables", echo = FALSE, message = FALSE, warning = FALSE, fig.width=9, fig.height=6}
my_data %>% select(operating_expense_assets, 
          donations_assets_ratio, 
          capital_asset_ratio,
          asset_structure, assets, 
          education, profit_margin) %>% 
  
  ggpairs(columnLabels = c("OperatingExpense/Assets",
                          "Donations/Assets", "Capital/Assets", 
                          "Asset Structure", "Size- Lassets", "Education", 
                          "Profit Margin")) + 
  
  theme_bw() + labs(title = "Correlation Matrix: Dependent Variables")
```

\elandscape


Next, we visualise each of the numeric variables against the current legal forms (status) of MFIs. We use the median of the variables to stand for the variables. Figure 3.2 (Panel A) shows that mature MFIs form the bulk of MFIs in the sample. Among mature MFIs, NGOs and cooperatives are the majority, indicating their relatively longer operational cycle than NBFIs, banks, and rural banks. As expected, NGOs receive the highest share of donations, followed by credit unions and NBFIs, while commercial banks receive the least donations (Figure 3.2- Panel B). The result relating to NGOs is not surprising given they are rooted in the welfare model of microfinance. Most donors are likely to channel their funds to MFIs that place social performance over profits. When commercial capital almost entirely replaces donations, outreach to the poor may likely be affected [@roberts2013profit], given that managers may emphasise impressing shareholders and debt-holders in line with the agency theory. As noted by @d2013unsubsidized, MFIs with little or no subsidies exhibit more significant mission drift. Hence, outreach to the poor would suffer even more where the capital providers do not have a sense of the hybrid nature of microfinance. Therefore, the rise of blended finance where commercial capital funds social causes may partly mitigate this scenario [@attridge2019blended].

Donations do not prevent NGOs and NBFIs from raising capital as they have the highest capital to assets ratio- which primarily reflects equity injections (Figure 3.2: Panel C). Commercial banks, credit unions and rural banks follow in that order. The observation is surprising given that NGOs and NBFIs still exhibit a high level of social performance even with a relatively high capital to assets feature. Therefore, it could imply that the profit vs social orientation of an MFI could be driven not just by the needs of the providers of funds but also by the internal governance, mission, and strategic direction of an MFI [@campion1999institutional]. In this respect, an MFI's social mission could outweigh the needs of capital providers. Also, the equity capital NGOs may attract may be preferential in terms of expected returns, as with blended finance [@rode2019blended]. In this case, donors could provide dedicated capital that does not pressure management to make high interest or dividends payments, allowing MFIs to remain predominantly on the social mission path [@lopatta2016microfinance]. ^[Apart from credit unions/cooperatives and rural banks, we use acronyms for other legal forms of MFIs. NGO stands for non-governmental organisations, while NBFI connotes non-bank financial institutions. The term bank represents microfinance-oriented commercial banks.]

Appendix 10 and 11 show the visualisation for the debt to equity ratio and deposits to assets ratio. While NGOs attract more equity capital, rural banks, commercial banks, and credit unions rely more on debt, especially deposits form of debt, to finance their operations. The analysis shows that while all MFIs are raising capital, the sources are different for commercial MFIs vis-a-vis NGOs. While NGOs are inclined to using more equity, commercial MFIs appear to rely more on debt. Debt capital gives rise to fixed obligations that may exacerbate mission drift, and hence the conversion of NGOs to commercial entities could be harmful to social outreach. However, the relative inability to garner deposits maybe detrimental to NGOs' ability to access cheap, less restrictive capital.

Lastly, for asset structure (tangibility), the ratio of non-current assets to total assets, credit unions lead followed by commercial banks, NGOs, NBFIs, and rural banks. Asset structure captures the extent to which MFIs invest in physical infrastructure relative to the total asset base. Credit unions tend to serve a narrow geographic region and traditionally put up brick and mortar branches to serve their customers [@mckillop2011credit]. Like credit unions, commercial banks tended to have more branches, having taken root before the advent of fintech, reducing the need for physical branches. NGOs, NBFIs, and rural banks have the lowest rates of asset tangibility, especially those of more recent origins, and using rural agents to meet customers rather than set up an expansive network of branches [@kent2013bankers].

Figure 3.3 (Panel A) shows that NGOs exhibit the highest median operating expense to assets ratio followed by NBFIs while credit unions trail. As we see later in the analysis, operating expenses positively relate to the depth of outreach- per cent of female borrowers and breadth of outreach in terms of gross loans to assets. Therefore, NGOs will do better in social outreach as they incur more costs to reach out to the financially excluded. Indeed, literature shows that outreach to the poor is expensive partly due to the dis-economies of scale in serving the poor, financially excluded clients [@mia2017mission]. One of the efficiency enhancement opportunities from the transformation of MFIs to the for-profit approach to microfinance services delivery is that managers could trim operating expenses to increase profits hurting financial inclusion.

Turning to profitability in Figure 3.3 (Panel B), we find that rural and commercial banks post the highest median profits, while NBFIs and NGOs trail (Figure 3.3- Panel B). This result probably partially illustrates the emphasis on social performance over financial performance by the management. NGOs and NBFIs are more likely to favour the social goal. When we take this result together with the observation that NGOs tend to have more operating expenses, we conclude that the desire by managers of commercial banks and other for-profit MFIs to mitigate agency conflicts leads to less operating expenses, more profitability and, hence, lower outreach to the financially excluded [@jensen1976theory].

Overall, the pattern indicates that while NGOs spend the most in operating expenses to reach the financially excluded, these efforts come at the cost of profitability. In contrast, profit-oriented MFIs are keen to manage expenses that improve profitability, presumably at the expense of outreach to the financially excluded. It is worth noting that NGOs have a relatively low asset base and hold relatively fewer non-current assets to total assets. The observation could mean that NGOs do not invest heavily in brick and mortar branches or serve a relatively limited geographic range. Finally, NGOs have the highest capital (equity) to asset ratio despite the push towards commercial capital. Much could be from investors, who put forth dedicated equity capital because they are keen on social performance and not profits [@mia2017mission].

We now turn to Figure 3.4. The first graph (Figure 3.4- Panel A) shows that commercial banks have the most prominent asset size (total assets), while NGOs and cooperatives have the smallest in that order. Banks tend to have a much broader geographic presence and hence attract more clients, which means more assets accumulation. Again, capital adequacy requirements by central banks have implications on the assets that banks hold. Furthermore, commercial banks are generally dominant in many developing countries meaning that they have a long operating history which implies a bigger size [@levine2002bank]. Figure 3.4 panel B shows that NGOs and NBFIs serve proportionately more women borrowers, indicating their outreach depth. Given that much of the donor funds accrues to NGOs, the conversion to the for-profit model would be detrimental to financial inclusion if coupled with a reduction in donor funding. 

Commercial banks and credit unions have the highest average loan balance per borrower (depth of outreach), while NBFIs and NGOs come last in that order (Figure 3.4- Panel C). As an indicator of outreach to the poor, the average loan balance per borrower is better when lower, indicating that more impoverished people get access to financial services. Again, it appears that profit-orientation by commercial banks may cause MFIs to reach less financially excluded people in favour of making profits. For credit unions, the observation could arise due to the limited geographic range of operations where they serve people with a common interest like the type of occupation, meaning that their members may not be suffering from financial exclusion in the first place [@armendariz2013subsidy].

NGOs have the highest median gross loans to total assets ratio, surprising given their relatively smaller size. On the other hand, banks and rural banks, respectively, have the lowest gross loans to assets, meaning they are less efficient in converting their assets into credit (Figure 3.4- Panel D). Again, it shows, at least in the case of Africa, that the breadth and depth of financial outreach are not always mutually exclusive. In this case, NGOs can reach the most impoverished borrowers, going by the per cent of female borrowers and average loan balance per borrower, while at the same time seemingly reaching a broad customer base as indicated by the gross loans to assets. So far, the bulk of MFIs population leans towards the welfare orientation where profitability overtly seems incompatible with outreach to the financially excluded [@lopatta2016microfinance].


\newpage
\blandscape


```{r, fig.cap = "Operating Expense, Donations, Capital and Asset Structure of MFIs by Legal Status", echo = FALSE, message = FALSE, warning = FALSE, fig.width=9, fig.height=6}
box1 <- my_data %>% ggplot(aes(x = age, fill = currentlegalstatus)) + 
  
  geom_bar() + labs(x = "Age", y = "Count") + 
  
  theme(legend.position = "bottom", legend.title = element_blank())


box2 <- second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = donations_assets_ratio, 
        xlabel = "Current Legal Status", 
        ylabel = "Donations/Assets Ratio (log Scale)", 
        title = "Panel B: Donations to Assets Ratio by MFIs Legal Status")

box3 <- second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = capital_asset_ratio, 
        xlabel = "Current Legal Status", 
        ylabel = "Capital/Assets Ratio (log Scale)", 
        title = "Panel C: Capital to Assets Ratio by MFIs Legal Status")

box4 <- second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = asset_structure, 
        xlabel = "Current Legal Status", 
        ylabel = "Asset Structure (log Scale)", 
        title = "Panel D: Asset Structure of MFIs by MFI Legal Status")

library(patchwork)
(box1 + box2) / (box3 + box4) + plot_annotation(title = "", caption = "Source: Authors' construction from MIX Data. \n NB: The y-Axis is in log scale")
```

\newpage

```{r, fig.cap = "Asset Structure, Profit Margin, Donations, Capital to Assets Ratio by Current Legal Status", echo = FALSE, message = FALSE, warning = FALSE, fig.width=9, fig.height=6}
box9 <- second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = my_data$operating_expense_assets, 
        xlabel = "Current Legal Status", 
        ylabel = "Opareting Expense to Assets (log Scale)", 
        title = "Panel A: Operating Expense to Assets Ratio of MFIs by MFI Legal Status")

box10 <- second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = profit_margin, 
        xlabel = "Current Legal Status", 
        ylabel = "Profit Margin (log Scale)", 
        title = "Panel B: Profit Margin by MFIs Legal Status")


library(patchwork)

(box9 + box10) + plot_annotation(title = "", caption = "Source: Authors' construction from MIX Data \n
                                                The y-Axis is in log scale")


```

\elandscape

\newpage
\blandscape

```{r, fig.cap = "Size, Profit Margin, Average Loan Balance per Borrower and Gross of MFIs by Legal Status", echo = FALSE, message = FALSE, warning = FALSE, fig.width=9, fig.height=6}
box5 <- second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = assets, 
        xlabel = "Current Legal Status", 
        ylabel = "Size - Log of Total Assets (log Scale)", 
        title = "Panel A: Relative Size of MFIs by MFI Legal Status")

box6 <- second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = percent_of_female_borrowers, 
        xlabel = "Current Legal Status", 
        ylabel = "Percent of Female Borrowers (log Scale)", 
        title = "Panel B: Percent of Female Borrowers by MFIs Legal Status")

box7 <- second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = average_loan_balance_per_borrower, 
        xlabel = "Current Legal Status", 
        ylabel = "Loan Balance per Borrower (log Scale)", 
        title = "Panel C: Loan Balance per Borrower by MFIs Legal Status")

box8 <- second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = gross_loan_portfolio_to_total_assets, 
        xlabel = "Current Legal Status", 
        ylabel = "Gross Loans/ Assets (log Scale)", 
        title = "Panel D: Gross Loans to Assets by MFIs Legal Status")

library(patchwork)

(box5 + box6)/ (box7 + box8) + plot_annotation(title = "", caption = "Source: Authors' construction from MIX Data \n
                                                The y-Axis is in log scale")
```

\elandscape
\newpage


#### Trends in Dependent and Independent Variables

Figure 3.4 below maps the trends, over time, for donations, capital, profits and operating expense to assets ratio, respectively. Figure 3.5 (*Panel A*) shows that the median donations to assets ratio have been downward for 1999-2019. The observation confirms the neo-liberal shift in the MFI paradigm where donors expect MFIs to be more financially self-sustainable. The trend is expected in light of the abundance of literature on the conversion of MFIs from NGOs and subsequent drop in donor funding [@d2017ngos]. As donations dry up, we expect the debt and equity capital components to fill the void.

Surprisingly, the capital to assets ratio, which captures the extent of the equity capital injection, is also on a downward trend despite the drive towards the commercialization of MFIs (*Figure 3.5, Panel B*). The observation could be due to a rise in the total asset base of MFIs, as they scale up, with equity capital being a relatively smaller external capital component than debt. *Appendix 8* shows a steady increase in the debt/equity ratio, which means that most MFIs, like commercial banks, use debt (including deposits) to finance their operations. In this respect, debt gives rise to fixed obligations which could hurt profitability during economic downturns.

MFI profitability in Figure 3.5 (*Panel C*) shows that the median profitability for MFIs is meager and almost invariant over time, except \*for a significant dip in mean profitability around 2008-2009 during the global financial crisis period. The result is consistent with the empirical regularity that shows microfinance as a low margin business, largely reflecting the primacy of social mission in microfinance [@hartarska2012governance]. An important observation is that there are no distinctive profitability changes even as more MFIs adopt the commercial model. This observation means that either the commercialization was not very successful in generating profits or that the extent to which MFIs were able to make profits post-transformation is particularly peculiar to each MFI or to each of the legal forms of MFIs.

Lastly, for Figure 3.5 (*Panel D*), the operating expenses to assets ratio remains approximately constant except for a dip in the 1999-2001 period. As the regressions show in a later section, the operating expense to assets ratio relates positively to outreach depth and breadth. In this case, the drop in the ratio between 1999 and 2001 could have worsened financial inclusion outcomes. However, the operating expenses to assets ratio have levelled off; thus, it could be indicating a sustained commitment to outreach even in the face of the desire to make profits.

Next, we turn to Figure 3.6, which shows a rise in MFI size, average loan balance per borrower, and gross loans to total assets, while the per cent of female borrowers is on a downward trend. The rise in the average loan's balance per borrower and the accompanying drop in the proportion of female borrowers indicates a consistent decline in the outreach of MFIs to the financially excluded, as MFIs rely less on donations and more on commercial capital. It further shows the effects of the neo-liberal, for-profit paradigm, which may be hurting the social performance of MFIs, precisely the depth of outreach. However, it appears the breadth of outreach is getting better with time as MFIs give more loans. Taken together, it implies that MFIs provide larger loans to less financially excluded people in a bid to make ample financial return to allow for financial sustainability and payment of dividends and interest to investors.

Appendices 12-14 show the breakdown, by legal forms of MFIs, of the trends for per cent of female borrowers, average loan balance per borrower and gross loans to assets. The movement is generally downwards for women borrowers except under the commercial banking legal forms, which have low outreach to women, but that is relatively constant after the initial spike in the early 2000s. The trends indicate a weakening depth of outreach. For average loan balance per borrower, NGOs and rural banks remain relatively constant. At the same time, other legal forms have rising average loan size trends, which indicates worsening outreach by banks, credit unions, and NBFIs. Lastly, gross loans are rising except for rural banks, showing a better breadth of outreach over time.

```{r, fig.cap = "Trends in MFI Donations, Capital, Profitability, and Operating Expenses", echo = FALSE, message = FALSE, warning = FALSE}
## Percent of female borrowers - trends over time
female <- my_data %>% 
  
  group_by(year) %>% 
  
  summarize(mean_female = mean(percent_of_female_borrowers, na.rm = TRUE), 
                               
  median_female = median(percent_of_female_borrowers, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_female), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_female), linetype = "dashed", color = "red") +
  
  geom_text(x = 2018, y = 0.55, label = "Median") + 
  
  geom_text(x = 2018, y = 0.57, label = "Mean")+
  
  labs(x = "Year", y = "Mean/Median Percent of Female Borrowers", title = "Panel B: Trends in the Percent of Female Borrowers") + 
  
  ggthemes::theme_clean()

## Average loan Balance per borrower
avloan <- my_data %>% 
  
  group_by(year) %>% 
  
  summarize(mean_average_loan = mean(average_loan_balance_per_borrower, na.rm = TRUE), 
                               
  median_average_loan = median(average_loan_balance_per_borrower, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_average_loan), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_average_loan), linetype = "dashed", color = "red") +
  
  geom_text(x = 2018, y = 500, label = "Median") + 
  
  geom_text(x = 2016, y = 1200, label = "Mean")+
  
  labs(x = "Year", y = "Mean/Median Average Loan Balance per Borrower", title = "Panel C: Trends in Average Loan Balance per Borrower") + 
  
  ggthemes::theme_clean()


## Gross loan portfolio to assets 
grossloan <- my_data %>% 
  
  group_by(year) %>% 
  
  summarize(mean_gross_loans = mean(gross_loan_portfolio_to_total_assets, na.rm = TRUE), 
                               
  median_gross_loans = median(gross_loan_portfolio_to_total_assets, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_gross_loans), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_gross_loans), linetype = "dashed", color = "red") +
  
  geom_text(x = 2012, y = 0.64, label = "Median") + 
  
  geom_text(x = 2013, y = 0.7, label = "Mean")+
  
  labs(x = "Year", y = "Mean/Median Gross Loans to Assets", title = "Panel D: Trends in Gross Loans to Assets Ratio") + 
  
  ggthemes::theme_clean()

## Capital assets ratio
capital <- my_data %>% 
  
  group_by(year) %>% 
  
  summarize(mean_capital = mean(capital_asset_ratio, na.rm = TRUE), 
                               
  median_capital = median(capital_asset_ratio, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_capital), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_capital), linetype = "dashed", color = "red") +
  
  geom_text(x = 2017, y = 0.22, label = "Median") + 
  
  geom_text(x = 2017, y = 0.27, label = "Mean")+
  
  labs(x = "Year", y = "Mean/Median Capital/Assets Ratio", title = "Panel B: Trends in Capital to Assets Ratio") + 
  
  ggthemes::theme_clean()

## Operating expense to assets ratio
expense <- my_data %>% 
  
  group_by(year) %>% 
  
  summarize(mean_op = mean(operating_expense_assets, na.rm = TRUE), 
                               
  median_op = median(operating_expense_assets, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_op), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_op), linetype = "dashed", color = "red") +
  
  geom_text(x = 2010, y = 0.18, label = "Median") + 
  
  geom_text(x = 2015, y = 0.22, label = "Mean") +
  
  labs(x = "Year", y = "Mean/Median Operating Expense to Assets", title = "Panel D: Trends in Operating Expense to Assets Ratio") + 
  
  ggthemes::theme_clean()

## Donations to assets ratio
donations <- my_data %>% 
  
  group_by(year) %>% 
  
  summarize(mean_don = mean(donations_assets_ratio, na.rm = TRUE), 
                               
  median_don = median(donations_assets_ratio, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_don), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_don), linetype = "dashed", color = "red") +
  
  geom_text(x = 2010, y = 0.01, label = "Median") + 
  
  geom_text(x = 2010, y = 0.04, label = "Mean")+
  
  labs(x = "Year", y = "Mean/Median Donations/Assets Ratio", title = "Panel A: Trends in Donations to Assets Ratio") + 
  
  ggthemes::theme_clean()

## Profit Margin
profit <- my_data %>% 
  
  group_by(year) %>% 
  
  summarize(mean_profit = mean(profit_margin, na.rm = TRUE), 
                               
  median_profit = median(profit_margin, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_profit), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_profit), linetype = "dashed", color = "red") +
  
  geom_text(x = 2009, y = 0.01, label = "Median") + 
  
  geom_text(x = 2010, y = -5, label = "Mean")+
  
  labs(x = "Year", y = "Mean/Median Profit Margin", title = "panel C: Trends in Profitability") + 
  
  ggthemes::theme_clean()

## Size - Log of assets
size <- my_data %>% 
  
  group_by(year) %>% 
  
  summarize(mean_size = mean(assets, na.rm = TRUE), 
                               
  median_size = median(assets, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_size), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_size), linetype = "dashed", color = "red") +
  
  geom_text(x = 2000, y = 6.05, label = "Median") + 
  
  geom_text(x = 2000, y = 5.99, label = "Mean")+
  
  labs(x = "Year", y = "Mean/Median Size (Log of Assets)", title = "Panel A: Trends in MFI Size") + 
  
  ggthemes::theme_clean()
```


\blandscape
\newpage

### Descriptive Statistics: Trends Over 2000-2020

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width=8, fig.height=4.5}
(donations + capital) /(profit + expense) + plot_annotation(title = "", caption = "Source: Authors' construction from MIX data")
```

\newpage
```{r, fig.cap = "Trends in MFI Size, Female Borrowers, Average Loan Balances, and Gross Loans", echo = FALSE, message = FALSE, warning = FALSE, fig.width=9, fig.height=6}
(size + female) / (avloan + grossloan) + plot_annotation(title = "", caption = "Source: Authors' construction from MIX data")
```

\elandscape

### Summary Statistics

Tables 3.2 and 3.3 show the summary statistics of the variables applied in the regression analysis later on. The summary indicates that there is not a wide variation in the composition of the legal forms of MFIs, with banks (619) and rural banks (138) having the least number of entities in the sample dataset. Turning to age, mature MFIs dominate in the sample dataset, followed by new MFIs (0-4 years) and young MFIs (4-8 years). Table 3.3 shows a summary of the three dependent variables. We have visualized and discussed the breakdown of these variables by MFI legal status in Figure 3.4. 


```{r, echo = FALSE, message = FALSE, warning = FALSE}
tribble(~ Variable, ~ Counts,
          "Current Legal Status", "Credit Unions: 1427, NBFI: 1315, NGO: 1250, Bank: 619",
          "Age", "Mature: 2558, New: 1200, Young: 1024") %>% 
  
  kbl(., caption = "Summary Statistics for Categrical Independent Variables", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from the MIX data",
           
           general_title = "",
           
           number = c("Legal status include NGO, Non-Bank Financial Institutions (NBFIs), Credit Unions, and Banks", "Age has mature MFIs older than 8 years, young ones (4 - 8 years), and new ones that are 4 years or less"),
           number_title = "Note: ")
  

###############################################
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  select(percent_of_female_borrowers,
                                                 
  average_loan_balance_per_borrower, gross_loan_portfolio_to_total_assets) %>% 
  
  skimr::skim() %>% 
  
  select(-n_missing, -numeric.hist, -skim_type) %>% 
  
  rename(Variable = skim_variable, Completeness = complete_rate, Mean = numeric.mean, 
         
         SD = numeric.sd, Min = numeric.p0, Q1 = numeric.p25, Median = numeric.p50, 
         
         Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  select(-Completeness, -Min, -Max) %>% 
  
  kbl(., caption = "Summary Statistics for Numeric Dependent Variables", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = FALSE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from the MIX data",
           
           general_title = "",
           
           number = c("The summary statistics are disaggregated by MFI legal status"),
           number_title = "Note: ")
################################################################
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>%
  
  select(operating_expense_assets, 
          donations_assets_ratio, 
          capital_asset_ratio,
          asset_structure, assets, 
          education, profit_margin) %>% 
  
  skim() %>% 
  
  select(-n_missing, -numeric.hist, -skim_type) %>% 
  
  rename(Variable = skim_variable, Completeness = complete_rate, Mean = numeric.mean, 
         
         SD = numeric.sd, Min = numeric.p0, Q1 = numeric.p25, Median = numeric.p50, 
         
         Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  select(-Completeness) %>% 
  
  kbl(., caption = "Summary Statistics for Continous Independent Variables", 
      
      booktabs = TRUE) %>% 
  
  kable_paper(full_width = FALSE, font_size = 10) %>% 
  
  footnote(general = "Source: Authors' construction from the MIX data",
           
           general_title = "",
           
           number = c("The summary statistics are disaggregated by MFI legal status"),
           number_title = "Note: ")
#########################################################################
```

\newpage

### Regression Analysis

This section describes the results of the deeper data analysis, that is, regression models in Table 3.5 and 3.6, and Appendix 1 taken alongside the results of the exploratory data analysis. Table 3.5 shows the output for the fixed effects model (see results of the Hausmann test in Appendix 2) [^2]. Table 3.6 presents the results of the random effects and the pooled OLS models. We describe the impact of transformation on each dependent variable: the MFI outreach proxies of per cent of women borrowers, average loan balance per borrower, and gross loans to assets. We are working with an unbalanced panel dataset; we run three regressions for each outcome variable. First, we run the regression using the entire dataset, then rerun the regression using data for MFIs with at least three years (panels) of data. Lastly, we run another regression for MFIs with at least five years of data [^3]. Table 3.5 shows the results of the fixed-effects model, while Table 3.6 presents the random effects and pooled OLS models. The discussion that follows mainly draws from the fixed and random-effects models. 

[^2]: Further, Appendix 3 and 4 show significant fixed effects. Hence, in all models, we favour the fixed-effects model. Also, both the fixed and random-effects models take precedence over the pooled OLS. We run both the fixed and random effects model to interpret the results from the dummy variables that drop out in the fixed-effects model.

[^3]: The mean and median number of years (panels) per MFI in the dataset are three and five years.

#### Percent of Women Borrowers

The legal status of an MFI is a significant driver of outreach to women, with NGOs faring better (see Table 3.6). Note that NGOs are the base outcome in current legal status, while banks, NBFIs, cooperatives/credit unions, and rural banks are the alternative outcomes. The basis for picking NGOs as the base outcome stems from the trend of NGOs converting to the commercial model, the core of this article. Other positive outreach drivers include education, operating expenses to assets ratio, profit margin, and capital-to-assets ratio. North Africa fares worse in MFI outreach than Sub-Sahara Africa despite being represented entirely by NGOs in the sample, showing the importance of considering regional disparities. Table 3.6 of the random effects and pooled OLS model shows that NGOs outperform other legal forms of MFIs in reaching out to women. The result implies that the transformation of MFIs can negatively impact financial inclusion efforts as commercial MFIs are less keen to reach the financially excluded, which contradicts some previous research [@ledgerwood1998microfinance; @ledgerwood2006transforming; @hartarska2012governance; @bos2015practice]. Again, the results highlight the potential regional disparities even within Africa, which may question the inferences made using global datasets. 

The results gain more credence when examining the operating expenses to assets ratio (Table 3.5 and 6). There is a positive and significant relationship between operating expense to assets ratio on the one hand and per cent of women borrowers on the other. It means that an MFI has to spend more to reach financially excluded clients, which means lesser profits at a given level of revenue. As expected, the conversion of MFIs from NGOs to the commercial model could reduce operating expenses in the quest for profits in line with the profit incentive arising from the agency theory [@eisenhardt1989agency]. Hence, it arguably follows that pursuit of profit is bad for financial inclusion by causing mission drift in line with prior research [@wagenaar2012institutional; @roberts2013profit; @lopatta2016microfinance; @mia2017mission]. Except in the unlikely scenario where MFIs generate profits by raising revenue without lowering costs, Africa's MFIs and regulators should rethink the case for the transformation of MFIs into the commercial model [@sun2021globalization].

Indeed, profitability has a positive relationship, albeit insignificant on women borrowers' per cent (see Table 3.5 and 3.6). With this hindsight, it would appear like the viable explanation for the profitability-operating expense-financial inclusion issue is that for commercial MFIs, it is to reduce operating expenses in the short run if that translates into higher profits. Higher profitability allows the MFIs to reach more financially excluded clients while cross-subsidising them in the medium to long term. @d2017ngos note that for transformed MFIs, profits tend to drop in the short term but not necessarily in the long term. The drop in profitability is driven by transformed MFIs charging lower interest rates, a contentious issue in micro-finance. Therefore, it would be worth examining the dynamics between profitability, operating expense, and financial inclusion for MFIs over a more extended period.

The significant control variables are education (table 3.5 and 3.6) and region (table 3.6). Education varies positively with outreach to women, as does region. MFIs in Northern Africa have lower outreach to women than an otherwise similar MFI in Sub-Saharan Africa. These results could be due to religious beliefs or practices that discount financial inclusion outcomes for women or a conscious shift to the Islamic model against charging interest on capital [@hassan2018religious]. This observation is despite North Africa being represented only by NGOs in the sample. Our previous findings show that NGOs have higher outreach to women than other legal forms of MFIs. The implication is that cultural and religious inclinations play a more significant role in driving financial inclusion than the operating model of MFIs in North Africa. Education also appears to play a key role in financial inclusion by empowering women to join the formal labour market and equipping women with financial literacy that allows for better financial decision making [@zins2016determinants; @chikalipah2017determines].

These observed relationships hold even when we winsorise the data (see *Appendix 1*). The only exception is the capital to assets ratio and profit margin, which have a significant positive relationship with outreach to women. These results suggest that larger firms are more likely to experience mission drift after conversion. However, even after winsorising the data, NGOs still do better at financing women in line with research from the welfare approach to microfinance [@kodongo2013individual]. To sum this up, MFIs would best achieve the quest to improve outreach to women by targeting NGOs with capital funding, especially with the rise of blended finance, commercial capital for social projects, ceteris paribus. Some other variables in the model are not significant but are worth mentioning. For instance, older firms have lower levels of outreach to women, which could imply that firms lose focus on financial inclusion as they mature and get financially independent. Next, we examine the effects on another measure of the depth of outreach, the average loan balance per borrower.

#### Average Loan Balance per Borrower

Like the per cent of female borrowers, the average loan balance per borrower captures how deep an MFI goes to reach the financially excluded, who typically would demand smaller denominations of loans. Thus, the smaller the average loan balance, the deeper the outreach. The major criticism of the average loan balance per borrower as an indicator of financial inclusion is that a larger average loan balance could result from progressive lending or arise as clients become better off [@abeysekera2014sustainability]. Again, researchers could be wrongly proclaiming mission drift for MFIs operating in countries that have relatively fewer indigent clients [@armendariz2013subsidy]. Notably, the presence of a few vast loans granted to some clients could tilt the average loan balance upwards [@market2014global]. Despite these shortcomings, the metric of average loan size is helpful because it is easily quantifiable, and the relevant data inputs are readily available. [^3].

[^3]: when interpreting these results, note that a smaller average loan balance per borrower indicates a better depth of outreach. Therefore, variables that have a negative coefficient have a positive influence on the depth of outreach.

The key observation in the description of this result is that NGOs consistently offer smaller average loan sizes than other legal forms of MFIs. However, the effect is only significant for credit unions/ cooperatives. Consistent with the outreach to women, the observation would suggest that NGOs reach the financially excluded better than do commercial MFIs. It would then imply that the conversion of MFIs from NGOs to other legal forms is harmful to financial inclusion, as the welfare school argues. In fact, @d2017ngos and @mia2017mission, using a global dataset of MFIs, find that average loan balances go up after transformation, which is consistent with our finding. Accordingly, @peck2001commercialization argue that commercial logic has, over time, displaced the welfare approach in addressing financial exclusion.

Furthermore, older MFIs have a lower average loan balance per borrower relative to newer ones. The relationship could hold as older firms tend to reach out to more financially excluded clients given their stable financial base, operational experience, and linkage to donors who emphasise social performance [@bos2015practice]. However, the larger the MFI's asset base, the higher the average loan balance, meaning that it is older but relatively smaller firms that better focus on their mission. Overall, it would imply that the growth of an MFI's asset size comes at the expense of outreach to the financially excluded [@armendariz2013subsidy].

Moreover, the capital to asset ratio has a positive relationship with the average loan balance, while profit margin relates negatively with the average loan size. For capital, the observation would imply that entry of commercial capital negatively influences the extent of financial inclusion, given that poorer people tend to demand smaller loans [@mersland2010microfinance]. As noted, however, some forms of commercial (dedicated) capital could allow MFIs to reach more financially excluded customers. It appears that the nature of capital injection - pure commercial versus preferential commercial capital may have a bearing on the extent to which an MFI focuses on profit generation relative to social outreach [@d2013unsubsidized].

As noted in the case of female borrowers, profitability is good for financial inclusion. While short-run profitability may hurt financial inclusion, it appears profitability helps extend financial inclusion in the medium to long term [@louis2013financial; @quayes2012depth], which is in line with the win-win school of microfinance [@kodongo2013individual]. Hence, it would be helpful to examine the inter-temporal dynamics between capital and profitability and the breadth and depth of outreach of microfinance institutions in Africa.

The insignificant drivers of average loan balance per borrower include region, operating expense to assets ratio, donations to assets ratio, asset structure, and education. That said, the relationship between operating expense ratio, donations to assets ratio and average loan size is positive, pointing to a negative but insignificant effect of these factors on financial inclusion [@d2017ngos]. For education, the sign is negative, meaning that education has a positive but insignificant impact on financial inclusion, an observation consistent with education's impact on the per cent of female borrowers in section 4.4.1. Asset structure exhibits mixed results. These results here remain robust even after removing extreme values (see *Appendix 1*). The next section examines the breadth of outreach captured by using gross loans to assets ratio.


```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Filtering data for >= 3 years and >= 5 years
data3 <- my_data %>% group_by(mfiid) %>% filter(n() >= 3)

data5 <- my_data %>% group_by(mfiid) %>% filter(n() >= 5)
```

```{r, results = "asis", eval = TRUE, echo = FALSE, message = FALSE, warning = FALSE}
## Coefficients output for the fixed effects models at full, >= 3 years, and >= 5 years of data.

model1 <- modelling(data = my_data, depvar = my_data$percent_of_female_borrowers, model = "within")

model2 <- modelling(data = data3, depvar = data3$percent_of_female_borrowers, model = "within")

model3 <- modelling(data = data5, depvar = data5$percent_of_female_borrowers, model = "within")

model4 <- modelling(data = my_data, depvar = my_data$average_loan_balance_per_borrower, model = "within")

model5 <- modelling(data = data3, depvar = data3$average_loan_balance_per_borrower, model = "within")

model6 <- modelling(data = data5, depvar = data5$average_loan_balance_per_borrower, model = "within")

model7 <- modelling(data = my_data, depvar = my_data$gross_loan_portfolio_to_total_assets, model = "within")

model8 <- modelling(data = data3, depvar = data3$gross_loan_portfolio_to_total_assets, model = "within")

model9 <- modelling(data = data5, depvar = data5$gross_loan_portfolio_to_total_assets, model = "within")

########################################################################
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
inference_m1 <- coeftest(model1, vcov = vcovBK(model1, method = "arellano", type="HC1", cluster = "group"))

inference_m2 <- coeftest(model2, vcov = vcovBK(model2, method = "arellano", type="HC1", cluster = "group"))

inference_m3 <- coeftest(model3, vcov = vcovBK(model3, method = "arellano", type="HC1", cluster = "group"))

inference_m4 <- coeftest(model4, vcov = vcovBK(model4, method = "arellano", type="HC1", cluster = "group"))

inference_m5 <- coeftest(model5, vcov = vcovBK(model5, method = "arellano", type="HC1", cluster = "group"))

inference_m6 <- coeftest(model6, vcov = vcovBK(model6, method = "arellano", type="HC1", cluster = "group"))

inference_m7 <- coeftest(model7, vcov = vcovBK(model7, method = "arellano", type="HC1", cluster = "group"))

inference_m8 <- coeftest(model8, vcov = vcovBK(model8, method = "arellano", type="HC1", cluster = "group"))

inference_m9 <- coeftest(model9, vcov = vcovBK(model9, method = "arellano", type="HC1", cluster = "group"))
```

\blandscape
```{r, results = 'asis', echo = FALSE, message = FALSE, warning = FALSE}
stargazer(model1, model2, model3, model4, model5, 
          
          model6, model7, model8, model9, 
          
          header = FALSE, type = "latex",
          
          title = "Output of Fixed Effects Model of MFI Outreach", 
          
font.size = "tiny", omit = c("^year.", "^current."),

se = list(inference_m1[,2], inference_m2[,2], inference_m3[,2], 
          
          inference_m4[,2], inference_m5[,2], inference_m6[,2],
          
          inference_m7[,2], inference_m8[,2], inference_m9[,2]),

column.labels = c("FemaleClients", "FemaleClients", "FemaleClients", 
                  
                  "AverageLoan", "AverageLoan", "AverageLoan", 
                  
                  "GrossLoans", "GrossLoans", "GrossLoans"), 

keep.stat = c("n", "rsq", "adj.rsq"),


add.lines = list(c("F", "4.230***", "4.210***", "4.130***", "8.200***", 
                   
                   "7.980***", "7.840***", "108.395***", "106.966***", 
                   
                   "101.779***"), c("DF", "3240", "3210", "2950", "3380", "3340", 
                                    
                                    "3030", "3497", "3405", "3056"),
                 c("Data", "Full", ">=3 Years", ">=5 Years", 
                   
                   "Full", ">=3 Years", ">=5 Years", 
                   
                   "Full", ">=3 Years", ">=5 Years")),

covariate.labels = c("Age: Young", "Age: Mature", "Operating Expense", 
                     
                     "Donations/Assets", "Capital/Assets", "Asset Structure", 
                     
                     "Size(Lassets)", "Education", "Profit Margin"), 

dep.var.caption  = "Dependent Variables",

  dep.var.labels   = "Social Performance"
)

```

\elandscape


```{r, results = "asis", eval = TRUE, echo = FALSE, message = FALSE, warning = FALSE}
## Pooled OLS and random effects using full dataset
model10 <- modelling(data = my_data, depvar = my_data$percent_of_female_borrowers, model = "random")

model11 <- modelling(data = my_data, depvar = my_data$percent_of_female_borrowers, model = "pooling")

model12 <- modelling(data = my_data, depvar = my_data$average_loan_balance_per_borrower, model = "random")

model13 <- modelling(data = my_data, depvar = my_data$average_loan_balance_per_borrower, model = "pooling")

model14 <- modelling(data = my_data, depvar = my_data$gross_loan_portfolio_to_total_assets, model = "random")

model15 <- modelling(data = my_data, depvar = my_data$gross_loan_portfolio_to_total_assets, model = "pooling")
############################################################
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
inference_m10 <- coeftest(model10, vcov = vcovBK(model10, method = "arellano", type="HC1", cluster = "group"))

inference_m11 <- coeftest(model11, vcov = vcovBK(model11, method = "arellano", type="HC1", cluster = "group"))

inference_m12 <- coeftest(model12, vcov = vcovBK(model12, method = "arellano", type="HC1", cluster = "group"))

inference_m13 <- coeftest(model13, vcov = vcovBK(model13, method = "arellano", type="HC1", cluster = "group"))

inference_m14 <- coeftest(model14, vcov = vcovBK(model14, method = "arellano", type="HC1", cluster = "group"))

inference_m15 <- coeftest(model15, vcov = vcovBK(model15, method = "arellano", type="HC1", cluster = "group"))
```


\blandscape

```{r, results = 'asis', echo = FALSE, message = FALSE, warning = FALSE}
stargazer(model10, model11, model12, model13, model14, model15, 
          
          header = FALSE, type = "latex",
          
          title = "Output of Random Effects and Pooled OLS Models of MFI Outreach", 
          
font.size = "tiny", omit = c("^year.", "^Constant"),

se = list(inference_m10[,2], inference_m11[,2], inference_m12[,2], 
          
          inference_m13[,2], inference_m14[,2], inference_m15[,2]),

column.labels = c("FemaleClients-Random", "FemaleClients-Pooled", 
                  
                  "AverageLoan- Random", "AverageLoan- Pooled", 
                  
                  "GrossLoans- Random", "GrossLoans- Pooled"), 

keep.stat = c("n", "rsq", "adj.rsq"),


add.lines = list(c("F", "27.3***", "38.1***", "89.4***", "2.63***", 
                   
                   "3017***", "71.5***"), 
                 
                 c("Data", "Full", "Full", ">=3 Years", 
                   
                   ">=3 Years", ">=5 Years", ">=5 Years")),

covariate.labels = c("Legal: Bank", "Legal: NBFI", "Legal: Coop", 
                     
                     "Legal: Rural Bank", "Age: Young", "Age: Mature", 
                     
                     "Region: SSA", "Operating Expense", 
                     
                     "Donations/Assets", "Capital/Assets", "Asset Structure", 
                     
                     "Size(Lassets)", "Education", "Profit Margin"), 

dep.var.caption  = "Dependent Variables",

  dep.var.labels   = "Social Performance"
)

```

\elandscape


#### Gross Loans to Assets Ratio

Gross loans capture the breadth of outreach, the number of people reached and the volume of credit that an MFI disburses. While MFIs should enhance their depth of outreach by reaching female borrowers and micro-borrowers, the sheer scale of such lending also matters [@d2013unsubsidized]. In the best-case scenario, we should have an MFI that reaches the most financially excluded borrowers and offers a higher gross volume of loans, meaning that it reaches more of the financially excluded. The gross loans to assets ratio exhibit a stronger relationship with the independent variables, with a coefficient of determination (adjusted R-Squared) of 0.467. The significant variables are MFI legal form, age, operating expenses to assets, donations to assets, capital-asset ratio, asset structure, size, and profit margin.

Although the legal form of an MFI is marginally significant in driving gross loans, NGOs have the greatest gross loans portfolios than all other legal forms except credit unions/ cooperatives and NBFIs. Hence, although NGOs exhibit more depth, it is not at the expense of breadth. Cooperatives have the highest gross loans, which may reflect their closed nature of serving a limited geographic region or people with common interests who opt to pool savings for their use [@mckillop2011credit]. NBFIs, unlike NGOs, have the advantage of having access to commercial equity and other capital, which, as we see later, positively drives the breadth of outreach in terms of gross loans.

As expected, older firms have more gross loans to assets given their long presence in the market, implying a more significant market share. Size is weakly negatively related to gross loans. These results mean that larger firms have weaker intermediation. The operating expenses to assets ratio positively relate to gross loans. MFIs with a higher spending capacity give out more loans, probably due to their greater market share [@gutierrez2007microfinance]. Capital to assets ratio and profit margin also positively relate to gross loans. In this respect, it appears that MFIs would best achieve broader outreach through commercial organizations that aim to maximize profits. Also, to broaden outreach, equity capital plays a positive role, meaning that commercialization could aid the expansion of gross loans to support the win-win approach to microfinance [@kodongo2013individual].

On the other hand, there is an inverse relationship between donations and gross loans to assets. In this case, it appears that donors may not be keen on breadth but rather emphasize depth, which research shows is best done through not-for-profit MFIs like NGOs [@d2017ngos; @bos2015practice]. MFIs that are more dependent on donations are most likely to be small and young and, hence, the low gross loans to assets. Again, asset structure has a significant negative relationship with gross loans. In this case, MFIs that tie a lot of their resources in physical assets have less breadth of outreach, which is a case for the adoption of information technology in place of brick and mortar branches [@d2017aid]. 

A final important aspect of this section is how gross loans to assets relate to measures of depth of outreach. Appendix 6 captures the relationship. While gross loans correlate negatively but weakly with the average loan balance per borrower, there is a substantial positive correlation between gross loans and female borrowers. But examining the scatter plots shows that outliers drive the little correlation between these variables. The positive correlation between per cent of women borrowers and the average loan balance per borrower support the claim that smaller loans indicate deeper outreach [@ayyagari2013financing]. Hence MFIs can pursue both financial inclusion depth and breadth without trade-offs. However, it is not clear at what point the breadth of outreach may negatively affect the depth of outreach, especially in Africa.

```{r, eval = FALSE, echo = FALSE, message = FALSE, warning = FALSE}
#######################################################
diff <- my_data %>% select(mfiid, year, currentlegalstatus, 
                       age, region, 
                       gross_loan_portfolio_to_total_assets, 
                       percent_of_female_borrowers, 
                       average_loan_balance_per_borrower, 
                             operating_expense_assets, 
                             donations_assets_ratio, 
                             capital_asset_ratio, 
                             asset_structure, lassets, 
                             education, profit_margin) %>% 
  
  mutate(lag_gross_loans = gross_loan_portfolio_to_total_assets - 
           dplyr::lag(gross_loan_portfolio_to_total_assets), 
         lag_women = percent_of_female_borrowers - 
           dplyr::lag(percent_of_female_borrowers), 
         lag_average_loans = average_loan_balance_per_borrower - dplyr::lag(average_loan_balance_per_borrower), 
         lag_operating_exp = operating_expense_assets - 
           dplyr::lag(operating_expense_assets), 
         lag_donations = donations_assets_ratio - 
           dplyr::lag(donations_assets_ratio), 
         lag_capital_asset = capital_asset_ratio - 
           dplyr::lag(capital_asset_ratio), 
         lag_asset_str = asset_structure - 
           dplyr::lag(asset_structure), 
         lag_lassets = lassets - dplyr::lag(lassets), 
         lag_education = education - dplyr::lag(education), 
         lag_profit_margin = profit_margin - dplyr::lag(profit_margin))

############################################################
ols <- lm(lag_gross_loans ~ lag_operating_exp + 
            
            lag_donations + lag_capital_asset + 
            
            lag_asset_str + lag_lassets + 
            
            lag_education + lag_profit_margin, data = diff)

###########################################################
summary(ols)

###########################################################
ols1 <- lm(lag_women ~ lag_operating_exp + 
            
            lag_donations + lag_capital_asset + 
            
            lag_asset_str + lag_lassets + 
            
            lag_education + lag_profit_margin, data = diff)

###########################################################
summary(ols1)

###########################################################
ols2 <- lm(lag_average_loans ~ lag_operating_exp + 
            
            lag_donations + lag_capital_asset + 
            
            lag_asset_str + lag_lassets + 
            
            lag_education + lag_profit_margin + factor(year), data = diff)

############################################################
summary(ols2)

############################################################
stargazer(ols, ols1, ols2, 
          
          type = "html", out = "full_fd.html" , header = FALSE, title = "First Difference 
          
          Estimates")
############################################################
```

#### Robustness Checks

Our robustness checks encompass three matters. First, the study employs three financial metrics to capture financial inclusion - per cent of women borrowers, average loan balance per borrower, and gross loans to assets ratio. The use of multiple metrics allows for triangulation, given that measuring the extent of financial inclusion is contested with different scholars favouring different metrics. The second aspect relates to outliers which could affect the regression estimates. To control for outliers, we run regressions using winsorized data. Precisely, we remove the top 10% and the bottom 10% of the data and run the random effects, fixed effects and pooled OLS. Outliers can bias results when there are extremely large or small values of variables than the typical observation. Overall, the results remain robust to extreme values. Lastly, we correct the standard errors by presenting panel corrected standard errors (PCSE) to cater to serial correlation and cross-sectional dependence, which is a common issue in panel data (see Appendix 5). Under cross-sectional dependence and serial correlation, the observed standard errors are different from the actual standard errors, thereby overestimating or underestimating the model's precision [@pesaran2021general].  

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Winsorizing the data
## Winsorizing function
remove_outliers <- function(x, na.rm = TRUE, ...) {
  qnt <- quantile(x, probs=c(.10, .90), na.rm = na.rm, ...)
  H <- 1.5 * IQR(x, na.rm = na.rm)
  y <- x
  y[x < (qnt[1] - H)] <- NA
  y[x > (qnt[2] + H)] <- NA
  y
}

#####################################################
data_wins <- my_data %>% select(operating_expense_assets, 
                             donations_assets_ratio, 
                             capital_asset_ratio, 
                             asset_structure, assets, 
                             education, profit_margin,
                             percent_of_female_borrowers,
                             average_loan_balance_per_borrower,
                             gross_loan_portfolio_to_total_assets)

####################################################
data_wins <- sapply(data_wins, remove_outliers) %>% data.frame()

####################################################
data_wins <- my_data %>% 
  
  select(mfiid, year, currentlegalstatus, age, region) %>% 
  
  bind_cols(data_wins)

####################################################
```


```{r, eval = TRUE, echo = FALSE, message = FALSE, warning = FALSE}
## Run the winsorized regressions
## Model for coefficients
model16 <- modelling(data = data_wins, depvar = data_wins$percent_of_female_borrowers, model = "random")

model17 <- modelling(data = data_wins, depvar = data_wins$percent_of_female_borrowers, model = "within")

model18 <- modelling(data = data_wins, depvar = data_wins$percent_of_female_borrowers, model = "pooling")

model19 <- modelling(data = data_wins, depvar = data_wins$average_loan_balance_per_borrower, model = "random")

model20 <- modelling(data = data_wins, depvar = data_wins$average_loan_balance_per_borrower, model = "within")

model21 <- modelling(data = data_wins, depvar = data_wins$average_loan_balance_per_borrower, model = "pooling")

model22 <- modelling(data = data_wins, depvar = data_wins$gross_loan_portfolio_to_total_assets, model = "random")

model23 <- modelling(data = data_wins, depvar = data_wins$gross_loan_portfolio_to_total_assets, model = "within")

model24 <- modelling(data = data_wins, depvar = data_wins$gross_loan_portfolio_to_total_assets, model = "pooling")
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
inference_m16 <- coeftest(model16, vcov = vcovBK(model16, method = "arellano", type="HC1", cluster = "group"))

inference_m17 <- coeftest(model17, vcov = vcovBK(model17, method = "arellano", type="HC1", cluster = "group"))

inference_m18 <- coeftest(model18, vcov = vcovBK(model18, method = "arellano", type="HC1", cluster = "group"))

inference_m19 <- coeftest(model19, vcov = vcovBK(model19, method = "arellano", type="HC1", cluster = "group"))

inference_m20 <- coeftest(model20, vcov = vcovBK(model20, method = "arellano", type="HC1", cluster = "group"))

inference_m21 <- coeftest(model21, vcov = vcovBK(model21, method = "arellano", type="HC1", cluster = "group"))

inference_m22 <- coeftest(model22, vcov = vcovBK(model22, method = "arellano", type="HC1", cluster = "group"))

inference_m23 <- coeftest(model23, vcov = vcovBK(model23, method = "arellano", type="HC1", cluster = "group"))

inference_m24 <- coeftest(model24, vcov = vcovBK(model24, method = "arellano", type="HC1", cluster = "group"))
```


## Conclusion

MFI provides financial services to the financially excluded, including women, rural dwellers, people living in remote locations, and the poor. A paradigm shift from the NGO not-for-profit model of microfinance to the commercial, for-profit model stresses financial sustainability over and above outreach to the financially excluded. In this article, we have examined microfinance institutions' transformation in Africa and its potential effects on financial inclusion. We found that NGOs perform best in measures of financial depth, represented by the per cent of women borrowers and average loan balance per borrower. Surprisingly, NGOs do well in financial breadth, exhibiting higher median gross loans to assets ratio than other legal forms, including commercial banks. These results suggest that transformation could adversely affect financial inclusion in Africa if allowed to occur without appropriate guides and support.

Furthermore, the capital to assets ratio positively drives all aspects of financial inclusion but is only statistically significant for gross loans. Hence, microfinance institutions, including those not NGOs, could fare well in financial inclusion if affordable and dedicated external capital is available. Interestingly, profitability is positively related to gross loans, although MFI does not need to transform. Operating expenses also positively drive depth and breadth of outreach. Therefore, targeted tax breaks could, for instance, allow MFIs to incur costs of reaching the financially excluded clients without a severe dent in profitability. Donations negatively impact the breadth of outreach while education and regional location are only important in terms of depth, that is, the per cent of female borrowers. Asset structure, donations, and size of an MFI negatively relate to gross loans. Therefore, the transformation of MFIs in Africa needs an appropriate framework to mitigate possible mission drift.


## Appendices

### Appendix 1: Regression Analysis- Winsorized Data

\blandscape
\newpage



```{r, results = 'asis', echo = FALSE, message = FALSE, warning = FALSE}
stargazer(model16, model17, model18, model19, model20, 
          
          model21, model22, model23, model24, 
          
          header = FALSE, type = "latex",
          
          title = "Regression Analysis Using Winsorized Data", 
          
font.size = "tiny", omit = c("^year.", "^Constant"),

se = list(inference_m16[,2], inference_m17[,2], inference_m18[,2], 
          
          inference_m19[,2], inference_m20[,2], inference_m21[,2],
          
          inference_m22[,2], inference_m23[,2], inference_m24[,2]),

column.labels = c("FemaleClients", "FemaleClients", "FemaleClients", 
                  
                  "AverageLoan", "AverageLoan", "AverageLoan", 
                  
                  "GrossLoans", "GrossLoans", "GrossLoans"), 

keep.stat = c("n", "rsq", "adj.rsq"),


add.lines = list(c("F", "4.230***", "4.210***", "4.130***", "8.200***", 
                   
                   "7.980***", "7.840***", "108.395***", "106.966***", 
                   
                   "101.779***"), c("Model", "Random", "Fixed", "Pooled", 
                   
                   "Random", "Fixed", "Pooled", 
                   
                   "Random", "Fixed", "Pooled")),

covariate.labels = c("Legal: Bank", "Legal: NBFI", "Legal: Coop", 
                     
                     "Legal: Rural Bank", "Age: Young", "Age: Mature", 
                     
                     "Region: SSA", "Operating Expense", 
                     
                     "Donations/Assets", "Capital/Assets", "Asset Structure", 
                     
                     "Size(Lassets)", "Education", "Profit Margin"), 

dep.var.caption  = "Dependent Variables",

  dep.var.labels   = "Social Performance"
)

```

\elandscape
\newpage


### Appendix 2: Hausmann Test; Fixed versus Random Effects

In this section, we run the Hausmann test to choose between fixed effects and the random-effects model. Also, we check for the choice between pooled OLS and random-effects models. Finally, we present the output from the regression analysis. Table 3.8 shows the results of the Hausmann test. The test favours the fixed effects model, given that the null hypothesis is the random effects.


```{r, echo = FALSE, message = FALSE, warning = FALSE}
## The Hausmann test
rbind(
hausmann_test(data = my_data, depvar = my_data$percent_of_female_borrowers),
hausmann_test(data = my_data, depvar = my_data$average_loan_balance_per_borrower),
hausmann_test(data = my_data, depvar = my_data$gross_loan_portfolio_to_total_assets)) %>% 
  
  mutate(Dependent_Variable = c("Percent of Female Borrowers", "Average Loan Balance per Borrower", 
                      
                      "Gross Loan Portfolio to Total Assets")) %>% 
  
  relocate(Dependent_Variable, .before = statistic) %>%  select(-method) %>% 
  
  set_names(names(.) %>% str_to_sentence()) %>% 
  
  kableExtra::kbl(., caption = "Results of the Hausmann Test for Fixed versus Random Effects", 
      
  booktabs = TRUE) %>% 
  
  kable_classic(full_width = FALSE, latex_options = "hold_position", 
                
                font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction",
           
  general_title = "",
  
  number = "The test favours the fixed effects model",
  
  number_title = "Notes: ")
##########################################################################
```


### Appendix 3: F-Test; Fixed Effects vs Pooled OLS

Table 3.9 below shows significant effects, and the test favours the fixed-effects model over the pooled OLS.


```{r, echo = FALSE, message = FALSE, warning = FALSE}
fixed_ols <- function(depvar){
fixed <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = my_data, effect = "individual", model = "within", 
      index = c("mfiid", "year")) 
  
pooling <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
          data = my_data, effect = "individual", model = "pooling", 
      index = c("mfiid", "year"))

pFtest(fixed, pooling)
}

women <- fixed_ols(my_data$percent_of_female_borrowers)
average_loan <- fixed_ols(my_data$average_loan_balance_per_borrower)
gross_loans <- fixed_ols(my_data$gross_loan_portfolio_to_total_assets)

library(tibble)
tribble(~ Dependent_variable, ~ statistic, ~ Method, ~ Alternative,
        "Percent of women borrowers", "23.0000***", "F test for individual effects", "Significant effects","Average Loan Balance per Borrower", "1.0000***", "F test for individual effects", "Significant effects", "Gross Loans to Total Assets", "5.0000***", "F test for individual effects", "Significant effects") %>% 
  
kableExtra::kbl(., caption = "Results of the F test for individual effects for Fixed Effects versus Pooled OLS", 
      
  booktabs = TRUE) %>% 
  
  kable_classic(full_width = FALSE, latex_options = "hold_position", 
                
                font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction",
           
  general_title = "",
  
  number = "The test favours the fixed effects model over pooled OLS",
  
  number_title = "Notes: ") 
```


### Appendix 4: LM Test; Random Effects vs Pooled OLS

Again, Table 3.10 below shows the Langrage multiplier test results that favour the random effects model over the pooled OLS.


```{r, echo = FALSE, message = FALSE, warning = FALSE}
random_ols <- function(depvar){
random <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = my_data, effect = "individual", model = "random", 
      index = c("mfiid", "year")) 
  
pooling <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
          data = my_data, effect = "individual", model = "pooling", 
      index = c("mfiid", "year"))

plmtest(pooling)
}

women_random <- random_ols(my_data$percent_of_female_borrowers)
average_loan_random <- random_ols(my_data$average_loan_balance_per_borrower)
gross_loans_random <- random_ols(my_data$gross_loan_portfolio_to_total_assets)

tribble(~ Dependent_variable, ~ statistic, ~ Alternative,
        "Percent of Women Borrowers", "85.5000***", "Significant effects","Average Loan Balance per Borrower", "2.2400***", "Significant effects", "Gross Loans to Total Assets", "22.3000***", "Significant effects") %>% 

kableExtra::kbl(., caption = "Results of the Langrage Multiplier Test for Random Effects versus Pooled OLS", 
      
  booktabs = TRUE) %>% 
  
  kable_classic(full_width = FALSE, latex_options = "hold_position", 
                
                font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction",
           
  general_title = "",
  
  number = c("The test favours the fixed effects model over pooled OLS", "Lagrange Multiplier Test - (Honda) for unbalanced panels"),
  
  number_title = "Notes: ") 

```


### Appendix 5: Cross-Sectional Dependence

Table 3.11 below shows that there is high cross-sectional dependence in the dataset. For this reason, we run and present the panel corrected standard errors.


```{r, echo = FALSE, message = FALSE, warning = FALSE}
fixed <- function(depvar) {
  
  reg <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = my_data, effect = "individual", model = "within", 
      index = c("mfiid", "year"))
  
  pcdtest(reg, test = "lm")
  } 

random <- function(depvar){
  
  reg <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = my_data, effect = "individual", model = "random", 
      index = c("mfiid", "year"))
  
  pcdtest(reg, test = "lm")
  }

#########################################
women_fixed_pcd <- fixed(my_data$percent_of_female_borrowers)
average_loan_fixed_pcd <- fixed(my_data$average_loan_balance_per_borrower)
gross_loan_fixed_pcd <- fixed(my_data$gross_loan_portfolio_to_total_assets)
################################################
women_random_pcd <- random(my_data$percent_of_female_borrowers)
average_loan_random_pcd <- random(my_data$average_loan_balance_per_borrower)
gross_loan_random_pcd <- random(my_data$gross_loan_portfolio_to_total_assets)

############################################################
## Cross sectional dependence under fixed effects model
tribble(~ Dependent_variable, ~ Model, ~ Chisq, ~ df,
        "Percent of women borrowers", "Fixed Effects", "99564***", "53076",
        "Average loan balance per borrower", "Fixed Effects", "0.0000***", "59759",
        "Gross loans to total assets", "Fixed Effects", "0.0000***", "68598",
        "Percent of women borrowers", "Random effects", "99764***", "53076",
        "Average loan balance per borrower", "Random Effects", "0.0000***", "59759",
        "Gross loans to total assets", "Random effects", "0.0000***", "68598") %>% 

kableExtra::kbl(., caption = "Results of the PCD Test for Cross-Sectional Dependence", 
      
  booktabs = TRUE) %>% 
  
  kable_classic(full_width = FALSE, latex_options = "hold_position", 
                
                font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction",
           
  general_title = "",
  
  number = "The test shows the existence of cross-sectional dependence",
  
  number_title = "Notes: ") 

```



\newpage

\blandscape

### Appendix 6: Correlation Matrix for Dependent Variables

```{r, fig.cap = "Correlation Between Gross Loans to Assets, Average Loan Balance per Borrower, and Percent of Female Borrowers", fig.width=8, fig.height=5, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% select(gross_loan_portfolio_to_total_assets, 
                
                average_loan_balance_per_borrower, percent_of_female_borrowers) %>% 
  
                na.omit() %>% data.frame() %>% 
  
GGally::ggpairs(columnLabels = c("Gross Loans to Assets", "Average Loan Balance per Borrower", "Percent of Female Borrowers")) + labs(title = "") + theme_bw()

  
  #corrplot(method = "number", type = "lower", sig.level = 0.05, title = "Correlation Coefficients for Dependent Variables", tl.pos = "ln")
```

\elandscape

\blandscape

\newpage

### Appendix 7: Residuals Diagnostics- Full Data

```{r, fig.cap = "Normal QQ Plots for the Fixed and Radom Effects Regression Models", fig.width=8, fig.height=4.5, echo = FALSE, message = FALSE, warning = FALSE}
plm_women_fixed <- plm(percent_of_female_borrowers ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = my_data, effect = "individual", model = "within", 
      index = c("mfiid", "year"))

plm_women_random <- plm(percent_of_female_borrowers ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = my_data, effect = "individual", model = "random", 
      index = c("mfiid", "year"))

plm_avloan_fixed <- plm(average_loan_balance_per_borrower ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = my_data, effect = "individual", model = "within", 
      index = c("mfiid", "year"))

plm_avloan_random <- plm(average_loan_balance_per_borrower ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = my_data, effect = "individual", model = "random", 
      index = c("mfiid", "year"))

plm_gross_fixed <- plm(gross_loan_portfolio_to_total_assets ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = my_data, effect = "individual", model = "within", 
      index = c("mfiid", "year"))

plm_gross_random <- plm(gross_loan_portfolio_to_total_assets ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = my_data, effect = "individual", model = "random", 
      index = c("mfiid", "year"))


par(mfrow = c(2,3), title = "QQplots for Fixed Effects Regression Models")

##########################################
qqnorm(residuals(plm_women_fixed), ylab = 'Residuals', col = "red", 
       main = "Percent of Women Borrowers - Fixed")

qqline(residuals(plm_women_fixed))
#########################################
qqnorm(residuals(plm_avloan_fixed), ylab = 'Residuals', col = "red", 
       main = "Average Loan balance - Fixed")

qqline(residuals(plm_avloan_fixed))
#########################################
qqnorm(residuals(plm_gross_fixed), ylab = 'Residuals', col = "red", 
       main = "Gross Loans - Fixed")

qqline(residuals(plm_gross_fixed))
###########################################
##########################################
qqnorm(residuals(plm_women_random), ylab = 'Residuals', col = "red", 
       main = "Percent of Women Borrowers- Random")

qqline(residuals(plm_women_random))
#########################################
qqnorm(residuals(plm_avloan_random), ylab = 'Residuals', col = "red", 
       main = "Average Loan balance- Random")

qqline(residuals(plm_avloan_random))
#########################################
qqnorm(residuals(plm_gross_random), ylab = 'Residuals', col = "red", 
       main = "Gross Loans- Random")

qqline(residuals(plm_gross_fixed))
```

\elandscape

\blandscape

\newpage

### Appendix 8: Residuals Diagnostics- Winsorised Data

```{r, fig.cap = "Normal QQ Plots for Regressions Using Winsorized Data", fig.width=8, fig.height=4.5, echo = FALSE, message = FALSE, warning = FALSE}
plm_women_fixed_wins <- plm(percent_of_female_borrowers ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = data_wins, effect = "individual", model = "within", 
      index = c("mfiid", "year"))

plm_women_random_wins <- plm(percent_of_female_borrowers ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = data_wins, effect = "individual", model = "random", 
      index = c("mfiid", "year"))

plm_avloan_fixed_wins <- plm(average_loan_balance_per_borrower ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = data_wins, effect = "individual", model = "within", 
      index = c("mfiid", "year"))

plm_avloan_random_wins <- plm(average_loan_balance_per_borrower ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = data_wins, effect = "individual", model = "random", 
      index = c("mfiid", "year"))

plm_gross_fixed_wins <- plm(gross_loan_portfolio_to_total_assets ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = data_wins, effect = "individual", model = "within", 
      index = c("mfiid", "year"))

plm_gross_random_wins <- plm(gross_loan_portfolio_to_total_assets ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin + year, 
               data = data_wins, effect = "individual", model = "random", 
      index = c("mfiid", "year"))


par(mfrow = c(2,3), title = "QQplots for Fixed Effects Regression Models for Winsorised Data")

##########################################
qqnorm(residuals(plm_women_fixed_wins), ylab = 'Residuals', col = "red", 
       main = "% Women Borrowers QQ-Plot- Fixed")

qqline(residuals(plm_women_fixed_wins))
#########################################
qqnorm(residuals(plm_avloan_fixed_wins), ylab = 'Residuals', col = "red", 
       main = "Average Loan balance QQ-Plot- Fixed")

qqline(residuals(plm_avloan_fixed_wins))
#########################################
qqnorm(residuals(plm_gross_fixed_wins), ylab = 'Residuals', col = "red", 
       main = "Gross Loans QQ-Plot- Fixed")

qqline(residuals(plm_gross_fixed_wins))
###########################################
##########################################
qqnorm(residuals(plm_women_random_wins), ylab = 'Residuals', col = "red", 
       main = "% Women Borrowers QQ-Plot- Random")

qqline(residuals(plm_women_random_wins))
#########################################
qqnorm(residuals(plm_avloan_random_wins), ylab = 'Residuals', col = "red", 
       main = "Average Loan balance QQ-Plot- Random")

qqline(residuals(plm_avloan_random_wins))
#########################################
qqnorm(residuals(plm_gross_random_wins), ylab = 'Residuals', col = "red", 
       main = "Gross Loans QQ-Plot- Random")

qqline(residuals(plm_gross_fixed_wins))
```

\elandscape

\blandscape

\newpage

### Appendix 9: Debt to Equity Ratio by MFI Legal Status

```{r, fig.cap = "Debt to Equity Ratio by MFI Legal Status", fig.width=8, fig.height=4.5, echo = FALSE, message = FALSE, warning = FALSE}
second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = debt_to_equity_ratio, 
        xlabel = "Current Legal Status", 
        ylabel = "Debt to Equity Ratio (Log Scale)", 
        title = "") +
  
second_plotter(data = my_data, x = currentlegalstatus, 
        z = currentlegalstatus,
        y = deposits_to_total_assets, 
        xlabel = "Current Legal Status", 
        ylabel = "Donations to Assets Ratio (Log Scale)", 
        title = "")
```

\elandscape

\blandscape

\newpage

### Appendix 10: Trends in the Percent of Female Borrowers

```{r, fig.cap = "Trends in the Percent of Female Borrowers", fig.width=8, fig.height=4.5, echo = FALSE, message = FALSE, warning = FALSE}


(my_data %>% 
  
  group_by(year) %>% 
  
  summarize(mean_de = mean(debt_to_equity_ratio, na.rm = TRUE), 
                               
  median_de = median(debt_to_equity_ratio, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_de), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_de), linetype = "dashed", color = "red") +
  
  labs(x = "Year", y = "Debt/Equity Ratio", title = "", 
       caption = "Authors, computation from MIX data") + 
  
  ggthemes::theme_clean() +




## Percent of female borrowers - trends over time
my_data %>% 
  
  group_by(year, currentlegalstatus) %>% 
  
  summarize(mean_female = mean(percent_of_female_borrowers, na.rm = TRUE), 
                               
  median_female = median(percent_of_female_borrowers, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_female), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_female), linetype = "dashed", color = "red") +
  
  labs(x = "Year", y = "Percent of Female Borrowers", title = "") + 
  
  ggthemes::theme_clean() + facet_wrap(~currentlegalstatus)) /



## Average loan Balance per borrower
(my_data %>% 
  
  group_by(year, currentlegalstatus) %>% 
  
  summarize(mean_average_loan = mean(average_loan_balance_per_borrower, na.rm = TRUE), 
                               
  median_average_loan = median(average_loan_balance_per_borrower, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_average_loan), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_average_loan), linetype = "dashed", color = "red") +
  
  labs(x = "Year", y = "Average Loan Balance", title = "T") + 
  
  ggthemes::theme_clean() + facet_wrap(~currentlegalstatus) +


## Gross loan portfolio to assets 
my_data %>% 
  
  group_by(year, currentlegalstatus) %>% 
  
  summarize(mean_gross_loans = mean(gross_loan_portfolio_to_total_assets, na.rm = TRUE), 
                               
  median_gross_loans = median(gross_loan_portfolio_to_total_assets, na.rm = TRUE)) %>% 
  
  ggplot(mapping = aes(x = year, y = mean_gross_loans), color = "skyblue") + geom_line() +
  
  geom_line(mapping = aes(x = year, y = median_gross_loans), linetype = "dashed", color = "red") +
  
  labs(x = "Year", y = "Gross Loans to Assets", title = "") + 
  
  ggthemes::theme_clean() + facet_wrap(~currentlegalstatus))

```

\elandscape


<!--chapter:end:04-tables.Rmd-->

---
#########################################
# options for knitting a single chapter #
#########################################
output:
  bookdown::pdf_document2:
    template: templates/brief_template.tex
    citation_package: biblatex
  bookdown::html_document2: default
  bookdown::word_document2: default
documentclass: book
bibliography: references.bib
always_allow_html: true
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
- \usepackage[default]{sourcesanspro}
- \usepackage[T1]{fontenc}
- \usepackage{amsmath}
- \usepackage{dcolumn}
- \usepackage{url}
---

# Efficiency of Microfinance Institutions in Africa {#Introduction}
\minitoc <!-- this will include a mini Table 4.of contents-->
\chaptermark{Efficiency of MFIs in Africa}

<!-- LaTeX normally does not indent the first line after a heading - however, it does so after the mini Table 4.of contents. You can manually tell it not to with \noindent -->


```{r, echo = FALSE, message = FALSE, warning = FALSE}

library("pacman")
library("bookdown") 
library("broom") 
library("car") 
library("caret") 
library("corrplot") 
library("dtplyr")
library("excelR") 
library("GGally") 
library("ggalt") 
library("ggeasy") 
library("gghalves") 
library("ggrepel")  
library("ggthemes") 
library("gmnl") 
library("gmodels") 
library("gplots") 
library("gridExtra") 
library("gtable")
library("here") 
library("janitor") 
library("kableExtra") 
library("knitr") 
library("lme4") 
library("lmtest")
library("magrittr") 
library("margins") 
library("mice") 
library("nnet") 
library("pacman") 
library("patchwork") 
library("pcse")
library("pglm") 
library("plm") 
library("prettydoc") 
library("pROC") 
library("psych") 
library("Rchoice") 
library("rDEA")
library("readxl")
library("rmarkdown") 
library("skimr") 
library("stargazer") 
library("tidymodels") 
library("tidyverse")
library("treemapify") 
library("viridis") 
library("wesanderson") 
library("zoo")

#########################################
options(digits = 3)
options(scipen=999)
options(knitr.kable.NA = "-")
theme_set(ggthemes::theme_clean())
#########################################
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
## legal traditions 
### Common law countries in Africa
common <- tibble(country = c("Botswana", "Gambia, The", "Ghana", "Kenya", "Lesotho", "Liberia", "Malawi", "Namibia", "Nigeria", "Sierra Leone", "South Africa", "South Sudan", "Sudan", "Eswatini", "Tanzania", "Uganda", "Zambia", "Zimbabwe"), trad = c(rep("common", 18)))

### Civil law countries in Africa
civil <- tibble(country = c("Algeria", "Benin", "Burkina Faso", "Cameroon", "Central African Republic", "Chad", "Comoros", "Congo, Rep.", "Cote d'Ivoire", "Gabon", "Guinea", "Madagascar", "Mali", "Mauritania", "Morocco", "Niger", "Senegal", "Togo", "Tunisia"), trad = c(rep("civil", 19)))

### Other legal traditions in Africa
others <- tibble(country = c("Equatorial Guinea", "Angola", "Burundi", "Cape Verde", "Congo, Dem. Rep.", "Egypt, Arab Republic of", "Ethiopia", "Eritrea", "Guinea-Bissau", "Mozambique", "Rwanda"), trad = c(rep("others", 11)))

###Putting them all together
legal <- rbind(common, civil, others)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Bond market data - private and public bond market capitalization to GDP
bonds <- read_excel("bonds_oluoch.xlsx") %>% 
  
  janitor::clean_names()

```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Add the financial development index to the dataset
## Countries not part of Africa
mideast <- c("Bahrain", "Iran, Islamic Rep.", "Iraq", "Israel", "Jordan", "Kuwait", "Lebanon", "Malta", "Oman", "Qatar", "Saudi Arabia", "Syrian Arab Republic", "United Arab Emirates", "West Bank and Gaza", "Yemen, Rep.")

## Load the financial structure data
finstr <- read_excel("FinancialStructureDatabase20191018.xlsx", sheet = 4) %>% 
  
  ## Select desired variables
  select(country, region, year, pcrdbgdp, stmktcap, stvaltraded, stturnover, listco_pc) %>% 
  
  ### Filter out regions not in Africa or middle east
  filter(region == "Sub-Saharan Africa" | region == "Middle East & North Africa") %>% 
  ### Filter out countries in middle east and select year 1999 onwards
  filter(!country %in% mideast, year >= 1999) %>% 
  
## Replace NAs
          group_by(country) %>% 
  
          mutate(pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
                 
                 pcrdbgdp = replace_na(pcrdbgdp, 0),
                 
                 stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE)),
                 
                 stmktcap = replace_na(stmktcap, 0)) %>% ungroup() %>% 
  
## Join with the bonds data
  left_join(bonds, by = c("country", "year")) %>% 
  
## rename bonds columns 
  rename(prbonds = outstanding_t_bonds_percent_gdp, 
         
         pubonds = outstanding_c_bonds_percent_gdp) %>% 
  
  ## Replace NAs in public bond and private bond markets 
  mutate(pubonds = replace_na(pubonds, 0), 
         
         prbonds = replace_na(prbonds, 0)) %>% 
  
         ## Rename Ivory Coast
         mutate(country = if_else(country == "Côte d'Ivoire", "Cote d'Ivoire", 
                                  
                                  country))

## View missing data points
#mice::md.pattern(finstr)

#finstr %>% select(pcrdbgdp, stmktcap) %>% cor(.) %>% 
  
  #corrplot(method = "number", type = "lower")
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Efficiency indicators 
## Financial efficiency
fineff <- read_csv("my_dea.csv") %>% 
  
  select(-starts_with(c("..", "soc_eff", "finsoc")))

## Social efficiency
soceff <- read.csv("soc_eff.csv") %>% 
  
  select(-X) %>% 
  
  set_names(c("soceff.theta_hat", "soceff.theta_ci_low", "soceff.theta_ci_high"))

## Financial and social efficiency indicators 

finsoc_eff <- read.csv("finsoc_eff.csv") %>% 
  
  select(-X) %>% 
  
  set_names(c("finsoceff.theta_hat", "finsoceff.theta_ci_low", "finsoceff.theta_ci_high"))
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Read in the dataset 
my_data <- read_csv("amelia.csv") %>% 

## Region
mutate(region = if_else(region == "Middle East and North Africa", 
                        
                        "North_Africa", region)) %>% 

# Clean the names 
janitor::clean_names() %>% 
  
# Set up factor variables 
## legal status 
mutate(currentlegalstatus = factor(currentlegalstatus, 
                           levels = c("NGO", "Bank", "NBFI", 
                            "Credit Union/ Cooperative", 
                            "Rural Bank")), 
      ## Age
      age = factor(age, levels = c("New", "Young", "Mature")),
       
      ## Region 
      region = factor(region, levels = c("North_Africa", "Africa"))) %>% 
  
      ## Add the financial structure data     
      left_join(finstr, by = c("country", "year")) %>% 
  
      ## Add a binary variable for the legal dummy- NGO vs Others
      mutate(currentlegaldummy = case_when(currentlegalstatus == "NGO" ~ "NGO",
                                           
                                           TRUE ~ "others"),
      
        currentlegaldummy = factor(currentlegaldummy, levels = c("NGO", "others")),
        
        legal_tradition = factor(legal_tradition, 
                                 
                                 levels = c("Common", "Civil", "Other"))
        
        ) %>% 
  ## Select required variables 
  select(mfiid, mfiname, year, country, currentlegaldummy, currentlegalstatus, 
         
         percent_of_female_borrowers, operational_self_sufficiency,
         
         age, legal_tradition, region.x, asset_structure, 
         
         assets, kkm, education, pcrdbgdp, stmktcap, prbonds, 
         
         gdp_growth_annual, donations, donations_assets_ratio, 
         
         profit_margin, capital_asset_ratio,
         
         debt_to_equity_ratio, operating_expense_assets, 
         
         average_loan_balance_per_borrower, gross_loan_portfolio_to_total_assets, 
         
         deposits_to_total_assets, liabilities_and_equity) %>% 
  
          ## Rename region
         rename(region = region.x) %>% 
  
  group_by(country) %>% 
  
  mutate(kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         education = replace_na(education, median(education, na.rm = TRUE)),
         prbonds = replace_na(prbonds, median(prbonds, na.rm = TRUE)),
         pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
         stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(mfiid) %>% 
  
  mutate(asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)), 
         
         percent_of_female_borrowers = replace_na(percent_of_female_borrowers, 
                                                  
                                                  median(percent_of_female_borrowers, na.rm = TRUE)),
         
         operational_self_sufficiency = replace_na(operational_self_sufficiency, 
                                                   
                                                   median(operational_self_sufficiency, na.rm = TRUE)),
         
         assets = replace_na(assets, median(assets, na.rm = TRUE)),
         
         donations = replace_na(donations, median(donations, na.rm = TRUE)),
         
         donations_assets_ratio = replace_na(donations_assets_ratio, 
                                             
                                  median(donations_assets_ratio, na.rm = TRUE)), 
         
         profit_margin = replace_na(profit_margin, median(profit_margin, na.rm = TRUE)),
         
         capital_asset_ratio = replace_na(capital_asset_ratio, median(capital_asset_ratio, na.rm = TRUE)),
         
         debt_to_equity_ratio = replace_na(debt_to_equity_ratio, median(debt_to_equity_ratio, na.rm = TRUE)),
         
         operating_expense_assets = replace_na(operating_expense_assets, median(operating_expense_assets, na.rm = TRUE)),
         
         deposits_to_total_assets = replace_na(deposits_to_total_assets, median(deposits_to_total_assets, na.rm = TRUE)), 
         
average_loan_balance_per_borrower = replace_na(average_loan_balance_per_borrower, median(average_loan_balance_per_borrower, na.rm = TRUE)),
    
liabilities_and_equity = replace_na(liabilities_and_equity, median(liabilities_and_equity, na.rm = TRUE)), 
                                    
gross_loan_portfolio_to_total_assets = replace_na(gross_loan_portfolio_to_total_assets, median(gross_loan_portfolio_to_total_assets, na.rm = TRUE)
         
         )) %>% 
  
  ungroup() %>% 
  
  group_by(region) %>% 
  
  mutate(education = replace_na(education, median(education, na.rm = TRUE)),
         
         kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         
         gdp_growth_annual = replace_na(gdp_growth_annual, 
                                        
         median(gdp_growth_annual, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(currentlegalstatus) %>% 
  
  mutate(assets = replace_na(assets, median(assets, na.rm = TRUE)), 
         
         percent_of_female_borrowers = replace_na(percent_of_female_borrowers, 
                                                  
                        median(percent_of_female_borrowers, na.rm = TRUE)),
         
         operational_self_sufficiency = replace_na(operational_self_sufficiency, 
                                                   
                        median(operational_self_sufficiency, na.rm = TRUE)),
         
         donations = replace_na(donations, median(donations, na.rm = TRUE)),
         
         donations_assets_ratio = replace_na(donations_assets_ratio, 
                                             
                                  median(donations_assets_ratio, na.rm = TRUE)),
         
         profit_margin = replace_na(profit_margin, median(profit_margin, na.rm = TRUE)),
         
         capital_asset_ratio = replace_na(capital_asset_ratio, median(capital_asset_ratio, na.rm = TRUE)),
         
         asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)),
         
         debt_to_equity_ratio = replace_na(debt_to_equity_ratio, median(debt_to_equity_ratio, na.rm = TRUE)),
         
         operating_expense_assets = replace_na(operating_expense_assets, median(operating_expense_assets, na.rm = TRUE)),
         
average_loan_balance_per_borrower = replace_na(average_loan_balance_per_borrower, median(average_loan_balance_per_borrower, na.rm = TRUE)),
         
         deposits_to_total_assets = replace_na(deposits_to_total_assets, median(deposits_to_total_assets, na.rm = TRUE)), 
         
liabilities_and_equity = replace_na(liabilities_and_equity, median(deposits_to_total_assets, na.rm = TRUE)), 

gross_loan_portfolio_to_total_assets = replace_na(gross_loan_portfolio_to_total_assets, median(gross_loan_portfolio_to_total_assets, na.rm = TRUE))
         
         ) %>% 
  
  ungroup() %>% 
  
  mutate(dummy = if_else(currentlegaldummy == "NGO", 0, 1)) %>% 
  
  mutate(assets = log(assets + 1),
         
         pcrdbgdp = log(pcrdbgdp + 1),
         
         stmktcap = log(stmktcap + 1),
         
         prbonds = log(prbonds + 1)) %>% 
  
  add_count(mfiid, name = "count") %>% 
  
  mutate(currentlegalstatus = fct_recode(currentlegalstatus, Coop = "Credit Union/ Cooperative")) %>% 
  
  mutate(finsoc = case_when(operational_self_sufficiency >= 1 & percent_of_female_borrowers > 0.5 ~ "SS",
                            
                            operational_self_sufficiency > 1 & percent_of_female_borrowers < 0.5 ~ "SF", 
                            
                            operational_self_sufficiency < 1 & percent_of_female_borrowers >= 0.5 ~ "FS",
                            
                            TRUE ~ "FF")) %>% 
  
mutate(finsoc = factor(finsoc, levels = c("FF", "SF", "FS", "SS"))) %>% 
  
## replace negative donations with zero
mutate(donations = case_when(donations <= 0 ~ 1,
                             TRUE ~ donations)) %>% 
  
## Create the DEA variables by removing zeros 

mutate(
dea_liab_equity = liabilities_and_equity + 1,

dea_operating_exp = operating_expense_assets + 1,

dea_percent_women = percent_of_female_borrowers + 1,

dea_average_loan = (1 / (average_loan_balance_per_borrower + 1)),

dea_oss = operational_self_sufficiency + 2) %>% 
  
## Normalize the data for DEA analysis 
mutate(
  
dea_liab_equity = dea_liab_equity / mean(dea_liab_equity),

dea_operating_exp = dea_operating_exp / mean(dea_operating_exp),

dea_percent_women = dea_percent_women / mean(dea_percent_women),

dea_average_loan = dea_average_loan / mean(dea_average_loan),

dea_oss = dea_oss / mean(dea_oss)) %>% 
  
## Bind the financial efficiency scores 
bind_cols(fineff) %>% 

## Bind the financial efficiency scores   
bind_cols(soceff) %>% 

## Bind the financial and social efficiency scores   
bind_cols(finsoc_eff) 
  
## Transform both financial and social efficiency for reressions
#mutate(fineff = log(fineff/(1-fineff))) %>% 
  
#mutate(soceff = log(soceff/(1-soceff)))

####################################################################
## Write a csv for the data
write.csv(my_data, "data.csv")

## Visualize missing data
#md.pattern(data)
## Amelia::missmap(data)

## MFIs with three (3) or more years of data
data3 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 3)
  
data3 %>% write.csv(., "data3.csv")

## MFIs with three (3) or more years of data
data5 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 5)  
  
data5 %>% write.csv(., "data5.csv")

```


######################################################################### 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
### Important functions ----
## Regression function - fixed, random and pooling
modelling2 <- function(data, depvar,
                      effect = c("individual", "twoways", "time", "nested"),
                      model = c("within", "random", "ht", "between", "pooling", "fd"),
                      inst.method = c("bvk", "baltagi", "am", "bms"),
                      random.method = c("swar", "amemiya", "walhus", "nerlove"),
                      digits = 4, index = c("mfiid", "year")){
  
## Load libraries
  library(plm)
  library(broom)
  library(pcse)
  library(car)
  library(zoo)
  library(lmtest)
  library(broom)
  library(stargazer)
  
  ## match arguments
  effect <- match.arg(effect)
  model <- match.arg(model)
  inst.method <- match.arg(inst.method)
  random.method <- match.arg(random.method)
  
  ## Run the Model
  unadjusted <- plm(depvar ~ currentlegalstatus + 
            age + kkm + asset_structure + 
            pcrdbgdp + stmktcap +
            log(assets) + factor(year), 
          data = data, effect = effect,
          model = model,inst.method = inst.method, 
          index = index, 
          digits = digits)

unadjusted
}
```

########################################################################## 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Hausmann Test function
hausmann_test2 <- function(data, depvar){
  
  library(plm)
  library(broom)
  library(pcse)
  library(car)
  library(zoo)
  library(lmtest)
  library(broom)
  
  fixed <- plm(depvar ~ currentlegalstatus + 
            age + kkm + asset_structure + 
            pcrdbgdp + stmktcap +
            log(assets), 
               data = data, effect = "individual", model = "within", 
      index = c("mfiid", "year")) 
  
  random <- plm(depvar ~ currentlegalstatus + 
            age + kkm + asset_structure + 
            pcrdbgdp + stmktcap +
            log(assets), 
          data = data, effect = "individual", model = "random", 
      index = c("mfiid", "year"))
 
  broom::tidy(phtest(fixed, random))
}

```

############################################ 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Median function
median_n <- function(x){median(x, na.rm = TRUE)}
```

############################################ 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
theme_niwot <- function(){
  theme_bw() +
    theme(axis.text = element_text(size = 7), 
          axis.title.x = element_blank(),
          axis.title.y = element_text(size = 8),
          axis.line.x = element_line(color="black"), 
          axis.line.y = element_line(color="black"),
          panel.border = element_blank(),
          panel.grid.major.x = element_blank(),                                          
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          panel.grid.major.y = element_blank(),  
          plot.margin = unit(c(1, 1, 1, 1), units = , "cm"),
          plot.title = element_text(size = 10, vjust = 1, hjust = 0),
          legend.text = element_text(size = 8),          
          legend.title = element_blank(),                              
          legend.position = c(0.95, 0.15), 
          legend.key = element_blank(),
          legend.background = element_rect(color = "black", 
                                           fill = "transparent", 
                                           size = 2, linetype = "blank"))
}
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
###########################################
#' ggplot Flat Violin
#' @export
#' @details Copy-pasted from https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R
#' somewhat hackish solution to:
#' https://twitter.com/EamonCaddigan/status/646759751242620928
#' based mostly on copy/pasting from ggplot2 geom_violin source:
#' https://github.com/hadley/ggplot2/blob/master/R/geom-violin.r
#' @examples:
#' ggplot(diamonds, aes(cut, carat)) +
#'   geom_flat_violin() +
#'   coord_flip()
#' @import ggplot2
geom_flat_violin <- function(mapping = NULL, data = NULL, stat = "ydensity",
                             position = "dodge", trim = TRUE, scale = "area",
                             show.legend = NA, inherit.aes = TRUE, ...) {
  layer(
    data = data,
    mapping = mapping,
    stat = stat,
    geom = GeomFlatViolin,
    position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = list(
      trim = trim,
      scale = scale,
      ...
    )
  )
}

#' @rdname ggplot2-ggproto
#' @format NULL
#' @usage NULL
#' @export
GeomFlatViolin <-
  ggproto("GeomFlatViolin", Geom,
          setup_data = function(data, params) {
            data$width <- data$width %||%
              params$width %||% (resolution(data$x, FALSE) * 0.9)

            # ymin, ymax, xmin, and xmax define the bounding rectangle for each group
            data %>%
              group_by(group) %>%
              mutate(ymin = min(y),
                     ymax = max(y),
                     xmin = x,
                     xmax = x + width / 2)

          },

          draw_group = function(data, panel_scales, coord) {
            # Find the points for the line to go all the way around
            data <- transform(data, xminv = x,
                              xmaxv = x + violinwidth * (xmax - x))

            # Make sure it's sorted properly to draw the outline
            newdata <- rbind(plyr::arrange(transform(data, x = xminv), y),
                             plyr::arrange(transform(data, x = xmaxv), -y))

            # Close the polygon: set first and last point the same
            # Needed for coord_polar and such
            newdata <- rbind(newdata, newdata[1,])

            ggplot2:::ggname("geom_flat_violin", GeomPolygon$draw_panel(newdata, panel_scales, coord))
          },

          draw_key = draw_key_polygon,

          default_aes = aes(weight = 1, colour = "grey20", fill = "white", size = 0.5,
                            alpha = NA, linetype = "solid"),

          required_aes = c("x", "y")
  )


"%||%" <- function(a, b) {
  if (!is.null(a)) a else b
}
###########################################################
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# plotting function
plotter <- function(data, x , y, z, xlabel, ylabel, title){
  
  library(tidyverse)
  library(ggthemes)
  library(gghalves)
  library(ggalt)  
  library(ggrepel)  # for annotations
  library(viridis)  # for nice colors
  library(broom)  # for cleaning up models
  library(treemapify)  # for making area graphs
  library(wesanderson)  # for nice colors
  
  ggplot(data = data, mapping = aes(x = reorder({{x}}, {{y}}, median_n), 
  y = {{y}}, fill = {{z}})) + 
  geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8, aes(fill = {{z}})) +
  geom_half_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) + 
    geom_point(position = position_jitter(width = 0.15), size = 1, alpha = 0.1) + 
    scale_y_log10() + labs(y = ylabel, x = xlabel, 
  title = title) + 
  theme_niwot() + 
  theme(legend.position = "none") + 
  stat_summary(fun = mean, geom = "point", 
                size = 1, color = "red")}

##################################################
second_plotter <- function(data, x , y, z, xlabel, ylabel, title){

library(ggalt)  
library(ggrepel)  # for annotations
library(viridis)  # for nice colours
library(broom)  # for cleaning up models
# devtools::install_github("wilkox/treemapify")
library(treemapify)  # for making area graphs
library(wesanderson)  # for nice colours

  ggplot(data = data, 
           mapping = aes(x = reorder({{x}}, {{y}}, median_n), y = {{y}}, fill = {{z}})) +
    
    # The half violins
    geom_flat_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) +
    
    # The points
    geom_point(aes(y = {{y}}, color = {{x}}), 
    
    position = position_jitter(width = 0.15), size = 1, alpha = 0.1) +
    
    # The boxplots
    geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8) +
    
    # \n adds a new line which creates some space between the axis and axis title
    labs(x = xlabel, y = ylabel, title = title) +
    
    # Removing legends
    guides(fill = FALSE, color = FALSE) +
    
    # Setting the limits of the y axis
    #scale_y_continuous(limits = c(0, 1.2)) +
    
    # Picking nicer colours
    scale_fill_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    scale_colour_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    theme_niwot() + scale_y_log10()
}

##################################################
# plotting scatter diagrams 
plotter_scatter <- function(data, x, y, z, 
                            xlab, ylab, title) {
  
  # Load libraries
  library(tidyverse)
  library(gghalves)
  library(ggeasy)
  library(ggthemes)
  
  # write the function
  data %>% ggplot(aes(x = {{x}}, y = {{y}}, col = {{z}})) + 
    
    geom_point(shape = 1, size = 2) + 
    
    labs(x = xlab, y = ylab, title = title)
}
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
remove_outliers <- function(x, na.rm = TRUE, ...) {
  qnt <- quantile(x, probs=c(.10, .90), na.rm = na.rm, ...)
  H <- 1.5 * IQR(x, na.rm = na.rm)
  y <- x
  y[x < (qnt[1] - H)] <- NA
  y[x > (qnt[2] + H)] <- NA
  y
}


data_wins_capital_structures <- my_data %>% 
  
  select(where(is.numeric), -mfiid, -year)


data_wins <- sapply(data_wins_capital_structures, remove_outliers) %>% 
  
  cbind(my_data[,c("mfiid", "mfiname", "region", "year", "age", 
                   
                   "currentlegalstatus", "legal_tradition")]) %>% 
  
na.omit() %>% 
  
  relocate(mfiid:legal_tradition)
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
envelope <- function(input, output){
                      library(rDEA)
                      dea.robust (input, 
                      output, W = NULL, model = "output", 
                      RTS = "variable", B = 500, 
                      alpha = 0.05, bw = "bw.ucv", 
                      bw_mult = 1)}
```


\newpage

\begin{center}

\textbf{ABSTRACT}

\end{center}

>We use Data Envelopment Analysis (DEA) to examine the drivers, as well as levels, of financial efficiency, social efficiency, and socio-financial efficiency of microfinance institutions (MFIs) in Africa, for the period 2000-2019. Broadly, our results show a trend of declining financial efficiency but no discernible trend in both social and socio-financial efficiencies. NGO-type MFIs have markedly better social efficiency and socio-financial efficiency scores than other legal forms of MFIs. Only cooperatives and rural banks consistently outperform NGOs financially. Stock market capitalization to GDP and private credit to GDP, proxies for financial sector development, have a negative relationship with social and socio-financial efficiency and financial efficiency has an inverse relationship with both size and asset structure of MFIs. These results suggest that commercialization of MFIs does not neccesarily improve their financial sustainability. Overall, our results remain robust after excluding outliers and other checks. 

\vspace{10mm}

**Key Words**: Microfinance, Efficiency, Social, Financial, Performance, Africa.

\vspace{5mm}
**JEL Classification**: G210, G230

\newpage

## Introduction

This work examines the drivers and levels of microfinance institutions (MFIs) financial and social efficiencies in Africa, considering the transformation of MFIs from not-for-profit ventures to commercial entities. Specifically, the research examines the levels and drivers of financial and social efficiencies in MFIs on the one hand. And, on the other hand, it examines the levels and drivers of the joint financial and social efficiency (socio-financial efficiency) of MFIs in Africa. MFIs have a dual mission. First, they derive legitimacy by availing financial services to the poor and other often financially excluded members of society [@marconatto2016going]. To achieve this social goal, MFIs have primarily relied on private donations and government subsidies [@d2017ngos]. However, with the rise of neo-liberalism [@bateman2010doesn], donors and stakeholders increasingly presume that MFIs should be financially self-sufficient, which is the second goal of MFIs [@beisland2019commercialization]. Political and economic uncertainties surrounding donations and subsidies reinforce the need for MFIs to be financially independent [@armendariz2011mission; @garmaise2013cheap].

If MFIs are to be financially sustainable, they should not do so by neglecting their social mission. The social mission of MFIs centres around providing appropriate and affordable financial services to the financially excluded. In Africa, the financially excluded comprises mainly women, youth and rural dwellers. When MFIs convert to the commercial model, they have to attain the financial objective of making profits and achieving financial sustainability over and above the social mission. The pursuit of financial and social goals makes MFIs hybrid organisations. It is notable, though, that purely commercial firms are also under increasing pressure to maximise social welfare primarily through corporate social responsibility (CSR) interventions and the rise of the Environmental, Social and Governance (ESG) accounting [@van2016esg], and impact investing [@barber2021impact]. However, the expectation for business firms to exclusively meet social goals may not be as elevated as the expectations for social and hybrid enterprises, like MFIs. Their mission achievement is essentially predicated on fulfilling their social mandate.

In this study, we utilise Data Envelopment Analysis (DEA) to generate indices of efficiency scores for financial performance, social performance, and the joint socio-financial performance of MFIs in Africa. In examining efficiency, we focus on the extent to which MFIs optimise their output for a given level of inputs, using the output-oriented DEA approach. The alternative input-oriented approach deals with the ability of MFIs to minimise inputs for a given level of output. The choice of the output-oriented method derives from the functions of MFIs, that is, reaching out to the financially excluded sustainably. Although the optimisation of inputs is also desirable, the outputs are more relevant in this study. The DEA inputs are liabilities and equity and operating expense to assets ratio. The output metric for the financial outcome is operational self-sufficiency (OSS). Simultaneously, the average loan balance per borrower, and per cent of women borrowers, are the social performance output indicators.

This research extends existing related knowledge in three primary ways. First, the work sheds light on the determinants of the simultaneous drivers of the financial and social efficiencies of MFIs, especially in Africa, where data challenges had hitherto hindered relevant research. Secondly, as noted earlier, the paradigm shift towards the commercial approach means that MFIs should meet both financial and social objectives [@d2017ngos; @chahine2010social]. However, extant research on the drivers of financial and social efficiencies tends to examine each goal separately instead of viewing them as two sides of the same coin [@efendic2017social; @gutierrez2009social]. 

What is more noteworthy is that research on the social and financial efficiency of MFIs is principally in the context of the transformation from NGOs to commercial firms and the post-conversion presence or absence of mission drift [@wassie2019performance; @d2017ngos; @mersland2009performance; @mia2017mission; @ramus2017]. While some researchers find that better financial performance harms social outreach [@tina2002institutional; @kent2013bankers], others find the opposite [@kar2018changes; @abeysekera2014sustainability]. Researchers such as @leite2019profit find mixed outcomes, with better financial performance harming depth of outreach while improving the breadth of outreach. Therefore, by simultaneously examining both the financial and social efficiencies of MFIs, this study presents novel insights that extend the abundant literature on the financial and social performance of MFIs.

The final contribution of our work is in respect of the drivers of the social efficiency of MFIs. This contribution is paramount because it particularly informs decision making that would enhance outreach to the teeming population of the financially excluded. Researchers can, to an extent, infer the determinants of the financial performance of MFIs from insights of the numerous extant research in corporate finance. That is not the case for the social performance of MFIs and other financial institutions, for that matter. @nason2018behavioral note that, unlike financial performance, which has specific reference points, the criterion for evaluating social performance is ambiguous. Firms must then negotiate with stakeholders on what are suitable standards for assessing social performance.

For this reason, some researchers gauge social performance by using the percentage of female borrowers, the proportion of rural borrowers, and the average loan size, all of which have their shortcomings. Much of the research in this domain dwells on the extent and causes of social failure, based on individual MFI social performance metrics without explicitly quantifying total social efficiency [@lebovics2016financial; @louis2013profit; @louis2013financial] with the noted exception of @gutierrez2009social. The subsequent research output based on different metrics for capturing social performance is difficult to compare.

Overall, little research investigates the socio-economic factors that enable or hinder the achievement of the dual objectives of MFIs. This absence of pertinent research is especially glaring in Africa, the continent with the lowest financial inclusion rates. For the stakeholders of MFIs, this could be a significant oversight. Therefore, the management of MFIs may not know the optimal strategies to adapt to fulfil the twin missions. The donors and venture capitalists may mistime their exit, whilst regulators could set policies that hinder rather than enhance the efficacy of MFIs in fulfilling their dual mandate. Accordingly, this research will enlighten the management of MFIs, policymakers, donors, and stakeholders on interventions necessary to enable MFIs to reach the financially excluded sustainably.

We take all formal MFIs in Africa as the population, with the sampling frame being the MFIs that submit their data to the Microfinance Information Exchange (MIX) pooled database. MIX pools data from over 2000 MFIs across the globe, representing 20% of all formal MFIs globally, which in their assessment provide 80% of the microcredit and incidental financial services [@market2017global]. A significant issue is that a substantial number of financially excluded people often rely on informal financial services, ranging from family and friends to neighbourhood kiosks and shylocks. There is also a rise of fintech firms that use mobile phones and the internet to offer inclusive financial services. However, the data for these equally essential portions of MFIs activities is hard to capture at scale. Hence, in this study, we will rely exclusively on the MFIs listed on the MIX database.

The remainder of the research report proceeds as follows. In section 2, we review the empirical literature and describe the theoretical basis for the financial and social efficiency of MFIs. The following section provides a summary of the results of the study. Part 4 states the hypothesis and describes the empirical methods deployed in the research. Part 5 focuses on the data used in computing the efficiency scores that serve as variables in the regression. Next, Section 6 details the results and the associated robustness checks, and Section 7 concludes.

## Theory and Empirical Literature

In *Microfinance Schism*, @morduch2000microfinance urges caution about the win-win view of microfinance. The win-win hypothesis posits that MFIs can simultaneously pursue and achieve financial sustainability and social goals without trade-offs. This perspective seeks to reconcile the welfare school of thought that views financial sustainability and social performance as incompatible and the financial sustainability perspective, which, while recognising the need for meeting social goals, emphasises financial sustainability. Morduch calls for the accommodation of multiple, hybrid MFI models on the continuum that includes those seeking profits while serving the poor and those that strictly focus on social goals like NGOs that rely on donations and subsidies. The broad array of microfinance programs, @morduch2000microfinance argued, would then serve diverse populations and contexts instead of prioritising or rating some MF models over others [@marconatto2016going].

Nonetheless, much of the ensuing research has compared the financial sustainability model with the welfare model, with empirical support on either side [@kodongo2013individual]. For instance, some research examines the extent to which different models of MFIs fare both financially and socially [@abeysekera2014sustainability; @bedecarrats2012combining]. Socially, ample research finds that NGO-oriented MFIs better at reaching out to the financially excluded than commercial based MFI models, that is, they are more socially efficient. However, other researchers counter that commercial oriented MFIs are better at outreach to the poor without much reliance on donations and subsidies [@abeysekera2014sustainability; @kar2013mission; @roberts2013profit]. For instance, @dorfleitner2017microfinance, @dorfleitner2017access, and @bos2015practice find that MFIs with better assets portfolio quality have a greater depth of outreach. This finding again highlights the variety of metrics used to gauge the financial and social performance of MFIs.

However, as @morduch2000microfinance further points out, MFI social performance could depend on the segments of the population served and regional and country-level contexts. Consequently, by extension, poor and social performance definitions must expand to the different profiles and economic activities of poor people as MFIs may not effectively reach out to the "core" indigent. Also, the differing views on the levels of social performance could result from the diverse meanings that different stakeholders, that is, employees, managers, MFI clients, and donors, attach to the term social performance [@marti2016financial]. As the metrics for social performance are ambiguous [@nason2018behavioral], it is hard to reconcile the different views of the extent to which MFIs achieve their social objectives relative to financial goals.

As a case in point, @beisland2020measuring examine the determinants of social performance using data from social rating agencies. The researchers conclude that different rating agencies place different weights on social indicators. Nevertheless, they find financial performance, rural outreach, service quality and customer service critical determinants of MFI social performance. A related study by @hermes2018determinants identify firm-specific and economic factors that drive the social efficiency of MFIs by conducting a meta-analysis of published papers. Key among the factors identified are age, size, institutional type, and the funding sources of an MFI, thus corroborating earlier findings by @gutierrez2009social. However, social ratings as a measure of social performance may not be feasible in the African context, where data is challenging. Again, the importance of each indicator could vary by context. The variance motivates the need for context-specific research.

Much of the research addresses both financial performance and social performance as stand-alone without addressing the conditions under which it is possible to achieve or fail to achieve these two, respectively. @gutierrez2009social quantified financial and social performance using the DEA efficiency estimation technique. Nonetheless, their study does not ascertain the drivers of financial efficiency, social efficiency, and combined socio-financial efficiency, as is the case in this study. Instead, these researchers examine the relationships between social performance, on the one hand, and profitability, location, age, and legal type of MFI on the other hand. This study goes beyond @gutierrez2009social by examining the drivers of joint socio-financial efficiency and by focusing on Africa. Moreover, their data consisted of a narrower set of 89 MFIs and did not focus on a specific region for richer and potentially generalisable insights, as @d2017ngos propose. In addition to being dated, their study also uses a notably different set of inputs and outputs data for the DEA analysis.

Hitherto, the dominant debate has been on how commercial MFIs can balance financial sustainability and social performance objectives, which attempts to mitigate the mission drift. Some researchers argue that the pursuit of financial sustainability is incompatible with outreach to the poor [@cobb2016funding; @mia2017mission]. The argument draws from the agency theory and its inherent profit incentive. The objectives of equity and debt holders would conflict with the strategic and costly social goal of serving the poor. It is the agency theory that forms the bedrock of arguments from the welfare school in that MFIs cannot pursue financial sustainability while at the same time reaching out to the financially excluded. These views that MFIs are likely to shift their emphasis from outreach to the poor to generate returns for the investors due to pressure from equity holders and debt servicing requirements of creditors.

@mersland2019social also argue that restrictive covenants inherent in debt funding could push managers away from social targets to emphasise making financial returns. @armendariz2013subsidy attribute mission drift to the need for MFIs to build up precautionary fund reserves as a cushion against uncertainties in subsidies and donations. However, other researchers like @im2015profits, @lutzenkirchen2012microfinance, and @quayes2012depth argue that for transformed MFIs, mission drift cannot occur. However, @morduch2019challenges sensibly counter this point of view by arguing that NGO MFIs would be non-existent. It is notable that NGOs that rely on donations and subsidies still form a substantial number of MFIs [@armendariz2013subsidy] which to some extent validates the concern about mission drift even among funders. Despite these reservations, some works find that commercial MFIs can achieve both financial and social objectives [@kodongo2013individual]. Other researchers have found that the quest for financial sustainability lowers the chances of meeting social goals [@hishigsuren2006transformation].

Further, some scholars argue that mission drift is often confused with progressive lending and cross-subsidisation [@abeysekera2014sustainability]. Notable among these studies is the mission expansion thesis by @mersland2010microfinance, which claims that financially sustainable MFIs can achieve better outreach through cross-subsidisation, that is, lending at market rates to the relatively well-off and using the proceeds to subsidise interest payments for the poor. Interestingly, @campion1999institutional and @ramus2017 argue that mission expansion could occur not due to the commercialisation of MFIs but due to a failure of corporate governance. Hence, corporate governance could resolve mission drift without affecting the financial positioning or social orientation of an MFI.

Lastly, a closely related study by @lam2020reciprocity finds that MFIs exhibit no evidence of mission drift. Instead, they find that financial performance is positively associated with subsequent social performance in for-profit MFIs relative to not-for-profit MFIs. Moreover, in contrast, the social performance of not-for-profit MFIs varies positively with subsequent financial performance compared to for-profit MFIs. Therefore, these authors surmise that for-profit MFIs are more efficient at translating financial performance to social goals while nonprofits are better at translating social objectives to financial goals. For nonprofits, part of the reason could be the goodwill generated by meeting social goals, which leads to more support from donors, the state, and other stakeholders. MFIs that are profit-based, however, must first generate profit to enable them to address social goals.

## Hypotheses
While the highlighted studies examine efficiency aspects separately, this study goes further by looking into the collective social and socio-financial and performance. Hence, in addition to reviewing the drivers of financial and social efficiencies of MFIs, we hypothesise, in positive format, as follows.

- Hypothesis 1: MFIs that follow the commercial model exhibit better financial performance than MFIs that follow the NGO model.
- Hypothesis 2: The social performance of NGO based MFIs is better than that of commercial model based MFIs.
- Hypothesis 3: The joint socio-financial performance of NGO based MFIs is better than that of commercial model based MFIs.

In these hypotheses, we note that most NGOs are also shifting to the commercial model but continue to rely substantially on donor funds, government subsidies, and guarantees to access low-cost commercial funds [@d2013unsubsidized]. Further, the mission of NGO-type MFIs may defer markedly from that of commercial MFIs, meaning that even when pursuing profits, they are less likely to abandon the social goals [@louis2013profit; @@mersland2019social]. The section that follows summarises the results of this current study.

### Summary of Results

This section highlights the results of the data analysis on the levels and drivers of social efficiency, financial efficiency, and combined socio-financial efficiency of MFIs in Africa. The section also elucidates our hypothesised relations vis-a-vis MFI types. The inputs for the DEA analysis constitute measures for financial performance and social performance. We capture financial performance using operational self-sufficiency (OSS). For social performance, we use two metrics; the per cent of women borrowers and the average loan balance per borrower. These metrics capture the ability of MFIs to reach the most financially excluded people such as women, rural dwellers, and other people that require and would typically make do with small loans sizes. The discussion captures the individual inputs and overall DEA score that researchers have documented in the literature.

MFIs in Africa are barely financially sustainable, with marginal disparities between MFIs legal types. On a scale between zero and one, the mean and median financial efficiency scores are 0.1572 and 0.1079, respectively. The regression analysis shows that the asset structure and size of an MFI are the primary drivers of financial efficiency. Larger MFIs have lower financial efficiency scores, as do MFIs with a higher assets structure (this is the ratio of non-current assets to total assets). MFIs exhibit a high level of social efficiency, consistent with their mission of providing financial services to the financially excluded, mostly the poor. The mean and median social efficiency scores are 0.786 and 0.777, respectively. The socio-efficiency scores are equally high. NGOs have significantly higher social efficiency and socio-financial efficiency scores than other legal forms of MFIs. The key driver of social efficiency and socio-financial efficiency is the MFI legal status. Financial markets development, proxied by stock market capitalisation to GDP and private credit to GDP, relate negatively to social efficiency and socio-financial efficiency. The following section lays out the methodology. 

## Methodology and Data
The study adopts a quantitative approach with the empirical model specified next.

### The Empirical Model

We primarily use the fixed and random-effects models as per the result of the Hausman test (see Appendix 1). Specifically, we estimate the following model.

\begin{equation}
Y_{it} = \beta_{0} + \beta_{1}X_{it} + \mu_{it}
\end{equation}

Further, assume that,

\begin{equation}
\mu_{it} = C_{i} + \epsilon_{it}
\end{equation}

Where $Y_{it}$ represents the dependent variable, which takes efficiency scores derived from the data envelopment analysis (DEA) model. We compute three measures of efficiency that take turns as the dependent variables: social efficiency, financial efficiency, and socio-financial efficiency. Section 5.4.3 describes in detail the DEA model. 

$X_{it}$, on the other hand, represents the set of independent variables as described in Table 4.2 below. Further, $c_{i}$ captures the aggregate effects of the unobserved, time-invariant explanatory variables for $Y_{it}$ . Further, assume that $e_{it}$ has zero mean conditional on $X_{it}$. In the case where $C_{i}$ and $X_{it}$ are correlated, then $C_{t}$ is a fixed effect; otherwise, it is a random effect. Note that the existence of fixed effects implies the presence of endogeneity. For random effects, on the other hand, endogeneity is not a concern. However, the random-effects model affects the computation of standard errors [@roberts2013endogeneity].

### Data, Data Sources and Description of Variables. 

We source our data from the Microfinance Information Exchange (MIX) pooled database [^1], the World Development Indicators (WDI) [^2], the Global Financial Development Database (GFDD) [^3], and the Worldwide Governance Indicators (WGI) [^4]. The dataset used in this article consists of 705 MFIs across Africa. While the MIX data is not a comprehensive representation of the microfinance industry in Africa, it does provide general trends in the sector [@jarotschkin2013microfinance].

[^1]: The MIX Market database is available on this link <https://datacatalog.worldbank.org/dataset/mix-market>.
[^2]: The link to the WDI database is <https://databank.worldbank.org/source/world-development-indicators>.
[^3]: The link to the GFDD is <https://www.worldbank.org/en/publication/gfdr/data/global-financial-development-database>.
[^4]: Follow the link for more information about the WGI, <https://info.worldbank.org/governance/wgi/>.

### The DEA Model

As noted earlier, the study adopts the Data Envelopment Analysis (DEA) technique to estimate both the financial and social efficiency scores for a given MFI in each period. @charnes1978measuring and @charnes1981evaluating formulated the traditional data envelopment analysis (DEA) by following the ideas of @farrel1957measurement. Unlike the other measures of financial and social performance of MFIs, DEA quantifies the (inverse) agency costs without confounding factors unrelated to agency costs [@berger2006capital]. A significant advantage of DEA is that it is not prone to the standard econometric problems because it is a deterministic and non-parametric enveloping technique. For instance, in running the DEA model, the researcher does not have to specify a functional form, estimate parameters, or define an error term. Importantly, DEA makes no distinction between dependent and independent variables [@zhou2007non]. 

DEA requires the resolution of the following linear programming model.

\begin{equation}
\frac{\sum_{r=1}^{n} u_{r}v_{r}}{\sum_{i=1}^{m} v_{i}x_{i}} \leqslant 1
\end{equation}

\begin{equation}
for, u_{r}, v_{r} \geqslant 0
\end{equation}

In this case, $n$ is the output number while $m$ is the input number. Also, $u_{r}$ is the weight of n, and $v_{i}$ is the weight of m. Hence, $v_{i}$ and $x_{i}$ represent the weight of m and output of $m$, respectively. Similarly, $u_{r}$ and $v_{r}$ represent the weight and amount of input in that order. 

When researchers run DEA assuming constant returns to scale (CRS), the resulting output represents technical efficiency (TE). Technical efficiency stands for the efficiencies due to input-output configurations and the size of operations. Under variable returns to scale, the output is pure technical efficiency (PTE). PTE is the efficiency that arises from input-output configuration while ignoring the scale of operations [@staub2010evolution; @ulas2015performance]. Additionally, input-oriented DEA seeks to minimise inputs for a given level of output, while in the case of output-oriented DEA, the goal is to maximise outcomes for a given level of inputs, with the choice of the orientations based on the input or output variables that managers have the most control over [@huguenin2012data].

#### Inputs and Outputs for the DEA Model
In this section, we first describe the inputs and outputs for the DEA efficiency model. We derive the efficiency scores from the Data Envelopment Analysis (DEA) model, where each of the MFIs is a decision-making unit (DMU) that converts multiple inputs into outputs. The efficiency scores show the relative annual configuration of inputs and outputs per MFI in the sample, as listed below. The output from the DEA forms the dependent variables. After describing the inputs and outputs for the DEA model, we describe the independent variables for the regression analysis.

##### Inputs for the DEA efficiency scores: 
Following the intermediation approach, we use the following variables as inputs.

- Liabilities and equity to total assets ratio: Liabilities and equity, an equivalent of total assets, capture all the funding sources for the MFI, including debt, equity, deposits, donations, and subsidies at the end of the reporting period. Liabilities and equity is a prominent input for DEA analysis, for instance, in studies on efficiency summarised by @fethi2010assessing, @paradi2017data, and @fall2018dea.

- Operating expenses to total assets ratio: This ratio captures the portion of assets per annum used to fund the operations of the MFI that directly generates the financial and social outputs described next. Staff numbers are the primary input in several DEA models. In this study, we take operating costs by subsuming the number of staff into labour cost.


##### Outputs for the DEA efficiency scores:
We classify outputs in both financial and social terms. Social outputs proxy the extent to which MFIs avail financial services to the poor and the financially excluded. Other outputs measure financial sustainability by MFIs. Accordingly, outputs consist of the following variables;

*Social Performance outputs*:

- Depth Measures: Percent of female borrowers and average loan size per borrower: The percentage of women borrowers as a measure of social efficiency draws from the fact that women form the bulk of the impoverished population and are financially excluded. Researchers have used the average loan size to proxy social performance as poor people will often borrow small amounts regularly to run their businesses and settle bills. In this case, the lower the average loan balance per borrower, the deeper the outreach [@d2017ngos].

*Financial Performance outputs*: 

- Operational self-sufficiency (OSS): OSS 1 captures the extent to which an MFI meets its financial objectives by generating financial returns that can cover all the expenses. MIX defines the OSS as follows;

\begin{equation}
OSS1 = \frac{Operating Revenue}{Expenses on Funding, Loan Loss Provisions, and Operations}
\end{equation}

OSS 1 has an advantage over OSS 2, which only shows the extent to which an MFI can cover its operating costs. We utilise OSS 1 in the study. 

\begin{equation}
OSS2 = \frac{Operating Revenue}{Operating Expenses}
\end{equation}

Table 4.1 presents summary statistics for the DEA input and output variables. 

```{r, cache = TRUE, eval=FALSE, echo = FALSE, message = FALSE, warning = FALSE}
fineff <- envelope(my_data[, c("dea_liab_equity", "dea_operating_exp")], 
         
         my_data[, "dea_oss"])
```


```{r, cache = TRUE, eval=FALSE, echo = FALSE, message = FALSE, warning = FALSE}
soc_eff <- envelope(my_data[, c("dea_liab_equity", "dea_operating_exp")], 
         
         my_data[, c("dea_percent_women", "dea_average_loan")])
```


```{r, cache = TRUE, eval=FALSE, echo = FALSE, message = FALSE, warning = FALSE}
finsoc_eff <- envelope(my_data[, c("dea_liab_equity", "dea_operating_exp")], 
         
         my_data[,c("dea_percent_women", "dea_average_loan", "dea_oss")])
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  select(liabilities_and_equity, 
         
         operating_expense_assets, 
         
         percent_of_female_borrowers, 
         
         average_loan_balance_per_borrower,
         
         gross_loan_portfolio_to_total_assets) %>% 
  
  skimr::skim_without_charts() %>%
  
  select(-n_missing, -complete_rate, -skim_type) %>%
  
  rename(Variable = skim_variable, 
         
         Mean = numeric.mean, 
         
         SD = numeric.sd, Min = numeric.p0,
         
         Q1 = numeric.p25, Median = numeric.p50, 
         
         Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  mutate(Variable = c("Liabilities/Equity", "Operating Expense/Assets", 
                      
                      "Female borrowers (%)", "Average Loan", 
                      
                      "Gross Loans/Assets")) %>% 
  
  kableExtra::kbl(caption = "Summary Statistics: Inputs and Outputs for the DEA Model", 
             
             booktabs = TRUE) %>% 
  
  kable_classic(full_width = FALSE, font_size = 10) %>% 
  
  footnote(general = "Source: Authors construction from the data", general_title = "")
```

Before running the DEA analysis, we start by transforming the inputs and outputs. We add a significantly large number to eliminate zeros and negatives [@ataullah2006economic]. In line with @avkiran2006productivity, we also mean-normalize the data. Figure 5.1 shows that there is a very low correlation between the inputs and outputs. Hence, collinearity will not adversely affect the DEA scores. 


### Independent Variables
Table 4.2 presents a summary of the independent variables applied in the study ^[See @jensen1976theory, @titman1988determinants, @ledgerwood1998microfinance,  @kyereboah2007determinants, @kraay2010worldwide, @allen2014african, @kurshev2015firm, @bayai2016financing, @schnyder2018twenty, @kimmel2018financial, @ito2018quantity, @market2018global]. 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
tribble(~ Variable_Description, 

"1. Current Legal Status: The legal forms of registration of an MFI are as follows: Commercial Bank, Non-Bank Financial Institution (NBFI), Non-Governmental Organization (NGO), Credit Union/ Cooperative, or Rural Bank. The legal status may dictate the profit orientation and sources of capital for the MFIs. We hypothesize that NGOs have better social performance measures while commercial MFIs have better financial outcomes", "", 
        
"2.	Age: MIX classifies MFIs into three categories depending on the time that has elapsed since the MFI started operations - new (0-4 years), young (4-8 years) and mature (over eight years). The variable is hence a dummy. We hypothesise that older, and hence larger MFIs, are more likely to be more efficient given they can draw from economies of scale, hire better managers, and have a long experience in running microfinance programs.", "", 

"3. Size (Log of Total Assets): We proxy the size of MFI with the natural logarithm of total assets, again using MIX data. Assets are supported by the sum of capital and liabilities or, equivalently, the total value of resources owned or controlled by the MFI resulting from past and current activities and from which the MFI derives future benefits. We propose that larger firms should be more efficient due to economies of scale and scope.", "", 

"4. Governance/ Institutional Quality (KKM): We create the country level KKM index using the first principal component of the WGI available in the World Bank databases. The index captures the institutional quality via corruption control, government effectiveness, political stability, the rule of law, and voice and accountability (Kaufmann, Kraay, & Mastruzzi, 2011). The proposition is that MFIs located in countries with better governance are also likely to have better internal governance which translates to better financial and social performance. We use the terms institutional quality and governance interchangeably throughout the text.", "", 

"5. Private Credit to GDP: We capture the total amount of credit advanced to the private sector by financial intermediaries as a proxy for capital markets development concerning the banking sector following Ito and Kawai (2018). The data source is the Global Financial Development Database, GFDD, of the World Bank (See note 4). Private credit to GDP represents the financial resources provided to the private sector by domestic money banks as a share of GDP. Domestic money banks comprise commercial banks and other financial institutions that accept transferable deposits, such as demand deposits. The data is available in WDI. Financial sector development is central to the acquisition of both equity and debt financing. We hypothesise that a high private credit to GDP corresponds with lower financial and social outcomes for MFIs given the relatively low levels of financial exclusion in countries with well developed financial systems.", "", 

"6. Stock market capitalisation to GDP: We capture the extent of stock market development using the ratio of stock market capitalisation to GDP to proxy the ease by which firms can raise equity capital. Although Africa's equity markets are thin, some relatively large stock markets like South Africa, Egypt, Nigeria, Kenya, and Ghana exist. The data are from the GFDD. We hypothesize that MFIs located in countries with better stock markets development have lower financial and social performance given the low levels of financial exclusion. It means that MFIs have to compete with mainstream financial intermediaries.", "", 

"7. Asset Structure (Tangibility): Asset structure is measured as the ratio of non-current assets to total assets of an MFI (Microfinance Information Exchange (MIX), 2019). The percentage indicates the extent of investment in physical infrastructure, a significant issue in constraining banking for the poor due to the perceived lack of scale economies to warrant the erection, for instance, of brick and mortar branches (Ledgerwood, 1998). Firms with a lower ratio are likely to release more funds for lending and hence better social and financial performance. (Titman & Wessels, 1988; Kyereboah-Coleman, 2007a).", "") %>% 
  
  kbl(., caption = "Description of Independent Variables", booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(number = c("MIX Database on www.themix.org and https://datacatalog.worldbank.org/dataset/mix-market", "WDI on https://databank.worldbank.org/source/world-development-indicators.", "WGI/ KKM on https://databank.worldbank.org/source/worldwide-governance-indicators.", "GFDD on https://www.worldbank.org/en/publication/gfdr/data/global-financial-development-database"), 
           
           number_title = "Notes",
    
           general = "Authors' construction from the literature",
           
           general_title = "Source: ")
  
  #knitr::kable(caption = "Description of variables")
```



\blandscape

\newpage

```{r, fig.cap="Correlation Matrix for DEA Inputs and Outputs", fig.width = 9, fig.height = 6, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  GGally::ggpairs(columns = c("liabilities_and_equity", "operating_expense_assets", "percent_of_female_borrowers", "average_loan_balance_per_borrower",
         "gross_loan_portfolio_to_total_assets",
         "operational_self_sufficiency")) 
```


\elandscape

\newpage


## Results

Recall, we examine the indicators of financial and social performance by MFIs in Africa. Here, we focus on taking individual performance measures, the proportion of female borrowers, average loan balance per borrower, gross loans to assets, and operational self-sufficiency. While the examination of indicator variables does not explicitly measure efficiency (we do this in a later section using DEA), they illustrate the extent to which MFIs fare in their mission more broadly:

1. Table 4.3 presents the descriptive statistics for the DEA-based efficiency scores. We visualise the data and describe the scope of financial and social performance, followed by a discussion of the DEA efficiency scores.
2. We discuss the levels of efficiency by MFI types based on the DEA scores.
3. We summarise the independent variables employed in the subsequent regression models.
4. We layout and describe the results of the regression model.

#### DEA Efficiency Scores

Given that the model is output-oriented, the interpretation is as follows: given a set of inputs, to what extent are MFIs able to maximise output? Given that the study targets the degree of financial inclusion and financial sustainability of MFIs, the maximisation of outcomes is more relevant for this study. 

##### Financial Efficiency

The mean and median financial efficiency scores are 0.16 and 0.11, respectively ^[The DEA scores range between zero and one, with zero indicating the worst performance and one the best.]. Taken together with Figure 5.2, the results show that the financial efficiency scores skew heavily to the right. Critically, MFIs are hardly financially sustainable regardless of their legal form, despite the paradigm shift towards commercialization. This observation begs the following two questions: do commercially oriented legal forms of MFI perform better financially than NGO-type MFIs? Further, do newer MFIs that took root when donors emphasize the financial sustainability of MFIs do better financially than older MFIs? 

Figure 5.2, panel C shows that only cooperatives and rural banks have higher median financial efficiency scores than NGOs. These results do not support the supposition that commercialization raises financial sustainability, given that commercial banks and NBFIs fare worse financially. The poor financial performance by banks and NBFIs can only further worsen their outreach to the financially excluded. Besides, the poor financial performance is also contrary to the "mission expansion" hypothesis where commercial MFIs generate profits that they then use to reach more financially excluded clients. Furthermore, Figure 5.2, panel D shows that newer MFIs have higher financial sustainability scores relative to older MFIs. These results could mean that newer MFIs focus more on financial sustainability at the expense of social goals or are better at balancing financial sustainability with social goals. 

Figure 5.5, panel B shows the trends in median financial efficiency scores of MFIs for 1999-2020. Cooperatives consistently do better financially than other legal forms. Surprisingly, NGOs and rural banks follow, while NBFIs and commercial banks have the lowest median financial efficiency scores, with commercial banks showing wide variability. The results indicate that commercialization does not necessarily raise financial sustainability, especially in the absence of grants and state subsidies. What is concerning is the observation that financial efficiency is on a downward spiral, meaning that MFIs may not achieve the goal of financial sustainability of MFIs. The worsening trend in financial performance by MFIs may point to the harm that neo-liberalism, commercialization, or other unidentified macro-economic factors have on MFIs.


```{r, echo = FALSE, message = FALSE, warning = FALSE, echo = FALSE, message = FALSE, warning = FALSE}
## Summarise all efficiency scores here
my_data %>% 
  
  skim_without_charts(fineff.theta_hat, soceff.theta_hat, 
                      
                      finsoceff.theta_hat
                      
                      ) %>% 
  
  select(-skim_type, -n_missing, -complete_rate) %>% 
  
  mutate(skim_variable = case_when(
    
    skim_variable == "fineff.theta_hat" ~ "financial Efficiency",
    
    skim_variable == "soceff.theta_hat" ~ "Social Efficiency",
    
    skim_variable == "finsoceff.theta_hat" ~ "Social-Financial Efficiency",
    
    TRUE ~ skim_variable
    
  )) %>% 
  
  rename(Variable = skim_variable, Mean = numeric.mean, SD = numeric.sd,
         
         Min = numeric.p0, Q1 = numeric.p25, Median = numeric.p50,
         
         Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  kableExtra::kbl(booktabs = TRUE, 
                  
                  caption = "Summary Statistics for Efficiency Scores") %>% 
  
  kable_classic(full_width = FALSE, font_size = 9)
```


\blandscape

\newpage

```{r, fig.cap="Financial Efficiency Scores for MFIs in Africa", fig.width = 9, fig.height= 6, echo = FALSE, message = FALSE, warning = FALSE}
(
## Plot financial efficiency scores by legal status
my_data %>% 
  
  ggplot(mapping = aes(x = fineff.theta_hat, 
                       
        fill = currentlegalstatus, col = currentlegalstatus)) + 
  
  geom_density(alpha = 0.5) + theme(legend.position = "bottom", legend.title = element_blank()) +
  
  labs(x = "Financial Efficiency Scores", y = "Density", 
       
       title = "A: Financial Efficiency Scores by MFI legal status") + 
  
  theme(plot.title = element_text(size = 10, face = "plain"))

  +

## Plot financial efficiency scores by age 
my_data %>% 
  
  ggplot(mapping = aes(x = fineff.theta_hat, 
                       
        fill = age, col = age)) + 
  
  geom_density(alpha = 0.5) + theme(legend.position = "bottom", legend.title = element_blank()) +
  
  labs(x = "Financial Efficiency Scores", y = "Density", 
       
       title = "B: Financial Efficiency Scores by MFI Age") + 
  
  theme(plot.title = element_text(size = 10, face = "plain"))
) /

(## Plot median financial efficiency scores by MFI legal status
plotter(my_data, x = currentlegalstatus, y = fineff.theta_hat, z = currentlegalstatus, 
        
        xlabel = "Current Legal Status", ylabel = "DEA Financial Efficiency Scores", 
        
        title = "C: Median DEA Financial Efficiency Scores by MFI Legal Status") +

## Plot median financial efficiency scores by MFI age
plotter(my_data, x = age, y = fineff.theta_hat, z = age, 
        
        xlabel = "Age", ylabel = "DEA Financial Efficiency Scores", 
        
        title = "D: Median DEA Financial Efficiency Scores by MFI Age")
) +
  
  
  
  plot_annotation(title = "Financial Efficiency of MFIs in Africa", 
                
                theme = theme(plot.title = element_text(size = 12)))
```

\elandscape

\newpage


##### Social Efficiency

Overall, the social efficiency of MFIs in Africa is high, with a mean and median of 0.79 and 0.78, respectively. However, as Figures 5.3 and 5.5 show, NGOs have consistently the highest median levels of social efficiency, followed by NBFIs and other forms of MFIs. Rural banks and credit unions, respectively, are the least socially efficient. Considering the financial efficiency scores, it appears that commercialization causes mission drift. Also, both NGOs and NBFIs show a notable decline in social performance over time, which could also be an indictment of the shift towards financial sustainability [@d2017ngos]. 

An important observation is that younger MFIs have a higher level of social performance than mature MFIs. Earlier, we saw that younger MFIs also have better financial performance than older MFIs. The implication is that younger MFIs are better at balancing financial and social goals than mature MFIs. The explanation could be that younger MFIs have developed their business model in the face of declining donor support or the complete absence of donor funding and state subsidies. It appears that older MFIs required to shift from the donor and state subsidy reliant model to the commercial model do not perform well. Given that mature MFIs are larger and reach more financially excluded clients, the issue is, therefore, how to support mature MFIs to transition to the financial sustainability model without reducing their outreach. 

\blandscape

```{r, fig.cap="Social Efficiency Scores for MFIs in Africa", fig.width = 9, fig.height= 6, echo = FALSE, message = FALSE, warning = FALSE}
(
## Plot Social efficiency scores by legal status
my_data %>% 
  
  ggplot(mapping = aes(x = soceff.theta_hat, 
                       
        fill = currentlegalstatus, col = currentlegalstatus)) + 
  
  geom_density(alpha = 0.5) + theme(legend.position = "bottom", legend.title = element_blank()) +
  
  labs(x = "Social Efficiency Scores", y = "Density", 
       
       title = "A: Social Efficiency Scores by MFI legal status") + 
  
  theme(plot.title = element_text(size = 10, face = "plain"))

  +

## Plot financial efficiency scores by age 
my_data %>% 
  
  ggplot(mapping = aes(x = soceff.theta_hat, 
                       
        fill = age, col = age)) + 
  
  geom_density(alpha = 0.5) + theme(legend.position = "bottom", legend.title = element_blank()) +
  
  labs(x = "Social Efficiency Scores", y = "Density", 
       
       title = "B: Social Efficiency Scores by MFI Age") + 
  
  theme(plot.title = element_text(size = 10, face = "plain"))

) /

(## Plot median financial efficiency scores by MFI legal status
plotter(my_data, x = currentlegalstatus, y = soceff.theta_hat, z = currentlegalstatus, 
        
        xlabel = "Current Legal Status", ylabel = "DEA Social Efficiency Scores", 
        
        title = "C: Median DEA Social Efficiency Scores by MFI Legal Status") +

## Plot median financial efficiency scores by MFI age
plotter(my_data, x = age, y = soceff.theta_hat, z = age, 
        
        xlabel = "Age", ylabel = "DEA Social Efficiency Scores", 
        
        title = "D: Median DEA Social Efficiency Scores by MFI Age")
) + 
  
  plot_annotation(title = "Social Efficiency of MFIs in Africa", 
                
                theme = theme(plot.title = element_text(size = 12)))
```

\elandscape


##### Financial and Social (Socio-Financial) Efficiency Scores

In Figure 5.4, we combine the social and financial metrics. The DEA model now captures the efficiency with which MFIs in Africa convert the inputs (liabilities and equity) into outputs (average loan balance per borrower, percentage of women borrowers, and operational self-sufficiency, OSS). The socio-financial efficiency scores are high, with a median of 0.7947 and a mean of 0.7767. Again, the median socio-financial efficiency metric is highest for NGOs, which is an oddity for we expected commercial firms to dominate if commercialization implies mission expansion (see panels A and C). These results mean that NGOs are better at balancing microfinance's financial and social goals than commercial MFIs. NBFIs, commecial banks, rural banks, and cooperatives follow in that order. These results seem like an indictment of the conversion of MFIs to the commercial model.  

In Figure 5.4, panels B and D, we plot the median socio-financial efficiency of MFIs faceted by age. As in the social and financial efficiency analyses, younger MFIs fare better in socio-financial efficiency scores than do older MFIs. Again, these results imply that younger MFIs are better at balancing the social and financial goals of microfinance, as discussed before. Figure 5.4, panel D shows the trends in the socio-financial efficiency of MFIs. While the scores appear stable across time, NGOs score consistently higher. Overall, these results mean that embracing neo-liberalism may be harming social performance without helping improve financial performance.


\blandscape

\newpage

```{r, fig.cap="Financial and Social Efficiency Scores for MFIs in Africa", fig.width = 9, fig.height = 6, echo = FALSE, message = FALSE, warning = FALSE}
(
## Plot Social efficiency scores by legal status
my_data %>% 
  
  ggplot(mapping = aes(x = finsoceff.theta_hat, 
                       
        fill = currentlegalstatus, col = currentlegalstatus)) + 
  
  geom_density(alpha = 0.5) + theme(legend.position = "bottom", legend.title = element_blank()) +
  
  labs(x = "Financial and Social Efficiency Scores", y = "Density", 
       
       title = "A: Financial and Social Efficiency Scores by MFI legal status") + 
  
  theme(plot.title = element_text(size = 10, face = "plain"))

  +

## Plot financial efficiency scores by age 
my_data %>% 
  
  ggplot(mapping = aes(x = finsoceff.theta_hat, 
                       
        fill = age, col = age)) + 
  
  geom_density(alpha = 0.5) + theme(legend.position = "bottom", legend.title = element_blank()) +
  
  labs(x = "Financial and Social Efficiency Scores", y = "Density", 
       
       title = "B: Financial and Social Efficiency Scores by MFI Age") + 
  
  theme(plot.title = element_text(size = 10, face = "plain"))

) /

(## Plot median financial efficiency scores by MFI legal status
plotter(my_data, x = currentlegalstatus, y = finsoceff.theta_hat, z = currentlegalstatus, 
        
        xlabel = "Current Legal Status", ylabel = "DEA Financial and Social Efficiency Scores", 
        
        title = "C: Median DEA Financial and Social Efficiency Scores by MFI Legal Status") +

## Plot median financial efficiency scores by MFI age
plotter(my_data, x = age, y = finsoceff.theta_hat, z = age, 
        
        xlabel = "Age", ylabel = "DEA Financial and Social Efficiency Scores", 
        
        title = "D: Median DEA Financial and Social Efficiency Scores by MFI Age")
) + 
  
  plot_annotation(title = "Financial and Social Efficiency of MFIs in Africa", 
                
                theme = theme(plot.title = element_text(size = 12)))
```

\elandscape

\newpage

\blandscape

```{r, fig.height = 6, fig.width = 9, fig.cap = "Trends in Financial and Social Efficiency Scores", echo = FALSE, message = FALSE, warning = FALSE}
(my_data %>% 
  
  ggplot(aes(x = fineff.theta_hat, y = soceff.theta_hat, 
             
             col = currentlegalstatus, 
             
             fill = currentlegalstatus)) + 
  
  geom_hex() +
  
  labs(x = "Financial Efficiency", y = "Social Efficiency", 
       
       title = "Financial versus Social Efficiency of MFIs in Africa") + 
  
  theme(legend.position = "bottom", legend.title = element_blank()) +

#########################################################################
my_data %>% 
  
  group_by(year, currentlegalstatus) %>% 
  
  summarize(median_fineff = median(fineff.theta_hat),
            
            median_soceff = median(soceff.theta_hat),
            
            median_finsoceff = median(finsoceff.theta_hat)
            
            ) %>% 
  
  filter(median_fineff <= 0.5) %>% 
  
  ggplot(mapping = aes(x = year, y = median_fineff, 
                       
                       col = currentlegalstatus)) + 
  
  geom_line() +
  
  labs(x = "Year", y = "Financial Efficiency", 
                     
                     title = "Trends in MFI Financial Efficiency, 1999-2020") + 
  
  theme(legend.position = "bottom", legend.title = element_blank())

) /

#########################################################################
(my_data %>% 
  
  group_by(year, currentlegalstatus) %>% 
  
  summarize(median_fineff = median(fineff.theta_hat),
            
            median_soceff = median(soceff.theta_hat), 
            
            median_finsoceff = median(finsoceff.theta_hat)
            
            ) %>% 
  
  ggplot(mapping = aes(x = year, y = median_soceff, 
                       
                       col = currentlegalstatus)) + 
  
  geom_line() + labs(x = "Year", y = "Social Efficiency", 
                     
                     title = "Trends in MFI Social Efficiency, 1999-2020") + 
  
  theme(legend.position = "bottom", legend.title = element_blank()) + 
  
  annotate("text", x = 2019, y = 0.86, label = "NGOs") +

###########################################################################
my_data %>% 
  
  group_by(year, currentlegalstatus) %>% 
  
  summarize(median_fineff = median(fineff.theta_hat),
            
            median_soceff = median(soceff.theta_hat), 
            
            median_finsoceff = median(finsoceff.theta_hat)
            
            ) %>% 
  
  ggplot(mapping = aes(x = year, y = median_finsoceff, 
                       
                       col = currentlegalstatus)) + 
  
  geom_line() + 
  
  labs(x = "Year", y = "Financial and Social Efficiency", 
                     
            title = "Trends in MFI Financial and Social Efficiency, 1999-2020") + 
  
  theme(legend.position = "bottom", legend.title = element_blank()) + 
  
  annotate("text", x = 2019, y = 0.86, label = "NGOs")
)
```

\elandscape


### The Independent Variables

Table 4.4 shows summary statistics for the independent variables that we employ in the regression models. Profit margin has the highest variability due to a few extreme minimum observations. To proxy the size of an MFI, we take the logarithm of assets. We use all the other independent variables without transformation.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  select(asset_structure, kkm, pcrdbgdp, 
         
         stmktcap, profit_margin, assets) %>% 
  
  skimr::skim_without_charts() %>%
  
  select(-n_missing, -complete_rate, -skim_type) %>%
  
  rename(Variable = skim_variable, 
         
         Mean = numeric.mean, 
         
         SD = numeric.sd, Min = numeric.p0,
         
         Q1 = numeric.p25, Median = numeric.p50, 
         
         Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  mutate(Variable = c("Asset Structure", "KKM", 
                      
                      "Private Credit", "Stock Market", 
                      
                      "Profit Margin", "Assets")) %>% 
  
  kableExtra::kbl(caption = "Summary Statistics: Independent Variables for Regression Model", 
             
             booktabs = TRUE) %>% 
  
  kable_classic(full_width = FALSE, font_size = 9) %>% 
  
  footnote(number = c("Private credit refers to credit advanced by deposit taking banks as a percentage of GDP", "Stock market is the stock market capitalisation as a percentage of GDP"), number_title = "Note: ", general = "Source: Authors construction from the data", general_title = "")
```

In the next section, we detail the regression output from the drivers of the efficiency of MFIs in Africa.

## Regression Analysis

In this section, we regress each of the DEA efficiency scores against the independent variables. We bootstrap the DEA efficiency scores before applying them to the regression model [@simar2000general;@tziogkidis2012bootstrap;@fethi2010assessing]. Note that the Hausmann Test favours the random effects model (see Appendix 1). However, we also run the fixed effects model for robustness. The purpose of using the bootstrapping approach is two-fold: first, to obtain the bias-corrected estimates and the confidence intervals of DEA-efficiency scores and second, to overcome the correlation problem of DEA-efficiency scores and to provide consistent inferences in explaining the determinants of financial and social efficiency [@assaf2010improving]. The bootstrapped DEA scores serve as the dependent variables in the regression analysis. This section provides results from the regression models on the drivers of the socio-financial efficiency of MFIs in Africa.

### Financial Efficiency of MFIs

Table 4.5 shows the results of the regression analysis with financial efficiency as the dependent variable. The significant drivers of financial efficiency are asset structure, MFI size proxied by the logarithm of total assets, and stock market capitalisation to GDP. Current legal status has a weak relationship with financial efficiency. The regression analysis shows that commercial banks and rural banks have significantly better financial efficiency, which goes against the visualisation in Figure 5.2. The extreme values in the financial performance of banks and rural banks could explain this contradiction. Considering this, NGOs do better financially than all the legal forms of MFIs except cooperatives.

These results go against the stated objectives of MFI commercialisation. The commercial model of microfinance aims at increasing the financial sustainability of MFIs, which would allow for their sustainability without reliance on donations and subsidies [@d2017ngos]. Again, financial sustainability by MFIs would lead to mission expansion by using profits to reach the financially excluded. However, the data shows that this is not the case. Overall, the financial performance of MFIs is poor [@mersland2010microfinance]. Also, the commercial MFIs do not outperform NGOs in financial performance in the sample dataset. It then seems like commercialisation does not necessarily translate into financial sustainability. And given the relatively good financial performance by NGOs that do not explicitly prioritise profitability, it appears that the win-win school has the upper hand. MFIs can balance financial and social goals while retaining the NGO model that focuses on social goals. 

The asset structure of MFIs has an inverse relationship with financial efficiency. As noted earlier, asset structure or asset tangibility is the ratio of non-current assets to total assets of an MFI. The results then imply that investment in physical infrastructure harms financial sustainability [@iman2018mobile; @demirguc2018global]. The results are consistent with the empirical literature in microfinance because serving the financially excluded is expensive and may not yield economies of scale to offset the investment in physical infrastructure by MFIs [@quayes2019probability]. The advent of Fintech allows MFIs to reach out to the financially excluded without high expenditures in brick and mortar branches and other physical assets [@iman2018mobile]. However, given that most financially excluded people also suffer from financial illiteracy, MFIs still must deploy field workers or mobile banking units in targeted areas [@allen2014african]. Hence, there is an opportunity for research into how Fintech affects the investment in physical infrastructure, profitability and outreach of MFIs in Africa.

The size of an MFI is also negatively related to the financial efficiency of MFIs in Africa. Large, older MFIs have lower financial efficiency scores relative to smaller, younger ones, which could arise due to dis-economies of scale. Also, larger, older MFIs may not emphasise financial sustainability, given they receive relatively more donations. If donors emphasise outreach vis-a-vis financial sustainability, this could explain the lower levels of financial performance by older MFIs [@d2013unsubsidized]. The ratio of stock market capitalisation to GDP has a weak positive relationship with financial efficiency, implying that MFIs operating in countries with better functioning capital markets exhibit better financial performance. Lower incidence of financial exclusion in countries with well developed capital markets could explain the relationship [@allen2014african]. The ratio of private credit to GDP is insignificant. The remaining variables, age and institutional quality, have no significant relationship with financial efficiency. However, as we saw earlier in Table 4.2, younger MFIs have marginally higher financial performance, which is not important in the regression. 

\newpage

```{r, echo = FALSE, message = FALSE, warning = FALSE}
fineff_reg_fx <- modelling2(my_data, my_data$fineff.theta_hat)

fineff_reg_fx3 <- modelling2(data3, data3$fineff.theta_hat)

fineff_reg_fx5 <- modelling2(data5, data5$fineff.theta_hat)

fineff_reg_rn <- modelling2(my_data, my_data$fineff.theta_hat, model = "random")

fineff_reg_rn3 <- modelling2(data3, data3$fineff.theta_hat, model = "random")

fineff_reg_rn5 <- modelling2(data5, data5$fineff.theta_hat, model = "random")
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
inference_m3011 <- coeftest(fineff_reg_fx, vcov = vcovBK(fineff_reg_fx, method = "arellano", type="HC1", cluster = "group"))

inference_m3111 <- coeftest(fineff_reg_fx3, vcov = vcovBK(fineff_reg_fx3, method = "arellano", type="HC1", cluster = "group"))

inference_m3211 <- coeftest(fineff_reg_fx5 , vcov = vcovBK(fineff_reg_fx5, method = "arellano", type="HC1", cluster = "group"))

inference_m3311 <- coeftest(fineff_reg_rn, vcov = vcovBK(fineff_reg_rn, method = "arellano", type="HC1", cluster = "group"))

inference_m3411 <- coeftest(fineff_reg_rn3, vcov = vcovBK(fineff_reg_rn3, method = "arellano", type="HC1", cluster = "group"))

inference_m3511 <- coeftest(fineff_reg_rn5, vcov = vcovBK(fineff_reg_rn5, method = "arellano", type="HC1", cluster = "group"))
```

\blandscape

```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
stargazer(fineff_reg_fx, fineff_reg_fx3, 
          
         fineff_reg_fx5, fineff_reg_rn, 
         
         fineff_reg_rn3, fineff_reg_rn5,
         
         title = "Regression Output for Financial Efficiency (Standard Errors in Brackets)", 
          
          align = TRUE, font.size = "tiny", header = FALSE, 
         
         dep.var.labels = "DEA Efficiency Score",
         
         se = list(inference_m3011[,2], inference_m3111[,2], inference_m3211[,2], 
          
          inference_m3311[,2], inference_m3411[,2], inference_m3511[,2]),
         
          omit = c("year.", "Constant"),
          
          add.lines = list(c("Model", "Within", "Within", "Within", 
                        
            "Random", "Random", "Random"), 
            
            c("Data", "Full", "3 Years and over", "5 Years and over", 
                                             
            "Full", "3 Years and over", "5 Years and over")))
```

\elandscape


\newpage

### Drivers of Social Efficiency of MFIs

Unlike financial performance, the legal form of an MFI is the dominant driver of social performance (see Table 4.6). Consistent with Figure 5.3, NGOs have significantly higher social performance levels than all the other legal forms of MFI. The concern by the welfare school of microfinance is that the levels of outreach by NGOs to the financially excluded could be affected by focusing on financial sustainability. However, as the previous section shows, NGOs do not fare badly in financial efficiency than other legal forms of MFI. It means, therefore, that NGOs could aim at a degree of financial efficiency while still maintaining their social goals. As @mersland2019social note, the mission statements of MFIs have a significant relationship with the performance of these MFIs. Given that NGOs have the stated mission of reaching the unbanked, they are better positioned to achieve these social goals. If NGOs are to give financial goals as much weight as social goals, there is likely to be a trade-off, more so where fund providers put pressure on management to make financial returns. 

The results are consistent with the data visualisations. Credit unions have the objective of serving subscribed members within a designated geographic location or a common professional background. It is not their mission to explicitly target social performance [@mathuva2017achieving]. The contestation here is between NGOs and the other commercial entities, excluding credit unions. The results illustrate that MFIs that exclusively target social performance tend to achieve more socially. Hence the place of the social mission of an MFI is central to achieving social objectives, a view that is in line with findings by @berbegal2019impact.

Both stock markets capitalisation to GDP and private credit to GDP have a negative and significant relationship with social performance. These two metrics capture the levels of capital market development. People in countries with higher levels of financial development have lower incidences of financial exclusion, on average, relative to people in countries with lower levels of financial inclusion. This observation is despite the concurrence in the literature that the ability to access financial services does not necessarily translate into the usage of financial services. However, access to financial services is a necessary precondition for people to use financial services [@allen2013resolving; @jarotschkin2013microfinance]. Financial development means better financial infrastructure that allows people who could otherwise not use financial services because of lack of access to these services. 

Institutional quality (KKM) has a mixed but insignificant relationship with the social performance of MFIs. As expected, asset structure has a positive, albeit negligible connection with social performance, given that MFIs that have a more significant presence in financially under-served communities would tend to serve more financially excluded clients. Likewise, the size of an MFI shows a positive but insignificant relationship with social outreach. Again, consistent with the data visualisation, younger MFIs have better levels of social performance than older MFIs, although the coefficients are not significant in the regression. The result seems odd because younger MFIs started when the sustainability school was gaining ground, meaning low donations and subsidies [@d2013unsubsidized]. But given that younger MFIs are smaller, they may serve geographically limited areas to reach more financially excluded clients. The broader coverage by older MFIs makes it hard for them to focus on social goals, given the financial implications of sustaining their presence in these settings. 

### Socio-Financial Efficiency of MFIs

In this regression model, we examine joint social and financial efficiency (socio-financial efficiency) drivers. Specifically, we seek to uncover how well MFIs convert their inputs into financial (operational self-sufficiency) and social goals (percentage of female borrowers and average loan balance per borrower). The results in Table 4.7 show that, like social efficiency, the statistically significant drivers of socio-financial efficiency are legal status and the ratio of stock market capitalisation to GDP. Specifically, the regression analysis shows that NGOs have higher socio-financial efficiency scores than the other legal forms of MFIs, confirming the results of the exploratory data analysis. These results suggest that transformed MFIs do not achieve the attained benefits of commercialisation, that is, increased financial sustainability, which allows for greater outreach to the financially excluded (mission expansion) [@mersland2010microfinance]. Instead, it is NGOs that are capable of balancing financial and social goals. Like in social pursuits, socio-financial efficiency has a negative relationship with stock market capitalisation to GDP, highlighting the importance of financial sector development in enabling financial inclusion [@allen2013resolving]. 


\blandscape

\newpage

```{r, echo = FALSE, message = FALSE, warning = FALSE}
soceff_reg_fx <- modelling2(my_data, my_data$soceff.theta_hat)

soceff_reg_fx3 <- modelling2(data3, data3$soceff.theta_hat)

soceff_reg_fx5 <- modelling2(data5, data5$soceff.theta_hat)

soceff_reg_rn <- modelling2(my_data, my_data$soceff.theta_hat, model = "random")

soceff_reg_rn3 <- modelling2(data3, data3$soceff.theta_hat, model = "random")

soceff_reg_rn5 <- modelling2(data5, data5$soceff.theta_hat, model = "random")
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
inference_m4011 <- coeftest(soceff_reg_fx, vcov = vcovBK(soceff_reg_fx, method = "arellano", type="HC1", cluster = "group"))

inference_m4111 <- coeftest(soceff_reg_fx3, vcov = vcovBK(soceff_reg_fx3, method = "arellano", type="HC1", cluster = "group"))

inference_m4211 <- coeftest(soceff_reg_fx5 , vcov = vcovBK(soceff_reg_fx5, method = "arellano", type="HC1", cluster = "group"))

inference_m4311 <- coeftest(soceff_reg_rn, vcov = vcovBK(soceff_reg_rn, method = "arellano", type="HC1", cluster = "group"))

inference_m4411 <- coeftest(soceff_reg_rn3, vcov = vcovBK(soceff_reg_rn3, method = "arellano", type="HC1", cluster = "group"))

inference_m4511 <- coeftest(soceff_reg_rn5, vcov = vcovBK(soceff_reg_rn5, method = "arellano", type="HC1", cluster = "group"))
```



```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
stargazer(soceff_reg_fx, soceff_reg_fx3, 
          
         soceff_reg_fx5, soceff_reg_rn, 
         
         soceff_reg_rn3, soceff_reg_rn5,
         
         title = "Regression Output for Social Efficiency (Standard Errors in Brackets)", 
          
          align = TRUE, font.size = "tiny", header = FALSE, 
         
         dep.var.labels = "DEA Efficiency Scores",
         
         se = list(inference_m4011[,2], inference_m4111[,2], inference_m4211[,2], 
          
          inference_m4311[,2], inference_m4411[,2], inference_m4511[,2]),
         
          omit = c("year.", "Constant"),
          
          add.lines = list(c("Model", "Within", "Within", "Within", 
                        
            "Random", "Random", "Random"), 
            
            c("Data", "Full", "3 Years and over", "5 Years and over", 
                                             
            "Full", "3 Years and over", "5 Years and over")))
```

\elandscape



\blandscape

\newpage

```{r, echo = FALSE, message = FALSE, warning = FALSE}
finsoceff_reg_fx <- modelling2(my_data, my_data$finsoceff.theta_hat)

finsoceff_reg_fx3 <- modelling2(data3, data3$finsoceff.theta_hat)

finsoceff_reg_fx5 <- modelling2(data5, data5$finsoceff.theta_hat)

finsoceff_reg_rn <- modelling2(my_data, my_data$finsoceff.theta_hat, model = "random")

finsoceff_reg_rn3 <- modelling2(data3, data3$finsoceff.theta_hat, model = "random")

finsoceff_reg_rn5 <- modelling2(data5, data5$finsoceff.theta_hat, model = "random")
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
inference_m5011 <- coeftest(finsoceff_reg_fx, vcov = vcovBK(finsoceff_reg_fx, method = "arellano", type="HC1", cluster = "group"))

inference_m5111 <- coeftest(finsoceff_reg_fx3, vcov = vcovBK(finsoceff_reg_fx3, method = "arellano", type="HC1", cluster = "group"))

inference_m5211 <- coeftest(finsoceff_reg_fx5 , vcov = vcovBK(finsoceff_reg_fx5, method = "arellano", type="HC1", cluster = "group"))

inference_m5311 <- coeftest(finsoceff_reg_rn, vcov = vcovBK(finsoceff_reg_rn, method = "arellano", type="HC1", cluster = "group"))

inference_m5411 <- coeftest(finsoceff_reg_rn3, vcov = vcovBK(finsoceff_reg_rn3, method = "arellano", type="HC1", cluster = "group"))

inference_m5511 <- coeftest(finsoceff_reg_rn5, vcov = vcovBK(finsoceff_reg_rn5, method = "arellano", type="HC1", cluster = "group"))
```



```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
stargazer(soceff_reg_fx, soceff_reg_fx3, 
          
         soceff_reg_fx5, soceff_reg_rn, 
         
         soceff_reg_rn3, soceff_reg_rn5,
         
         title = "Regression Output for Joint Financial and Social Efficiency (Standard Errors in Brackets)", 
          
          align = TRUE, font.size = "tiny", header = FALSE, 
         
         se = list(inference_m5011[,2], inference_m5111[,2], inference_m5211[,2], 
          
          inference_m5311[,2], inference_m5411[,2], inference_m5511[,2]),
         
          omit = c("year.", "Constant"),
          
          add.lines = list(c("Model", "Within", "Within", "Within", 
                        
            "Random", "Random", "Random"), 
            
            c("Data", "Full", "3 Years and over", "5 Years and over", 
                                             
            "Full", "3 Years and over", "5 Years and over")))
```

\elandscape

\newpage


### Robustness Tests
We first run the fixed and random effects models for the entire dataset for robustness, with the results reported in tables 5.5, 5.6 and 5.7. Secondly, we check for outliers by winsorising the data. To do this, we drop the top 10% and bottom 10% observations of the independent variables and rerun the fixed and random effects regressions. The results are in Appendix 3 (Table 4.9). The results correspond to those in Tables 5.5 to 5.7 except for the magnitude of the regression coefficients. 

Given the panel structure of data, there is a possibility of cross-sectional dependence and serial correlation. We correct the standard errors – presenting the panel corrected standard errors to deal with these problems. Appendix 4-6 contain plots examining the normality of residuals for the regression outputs in Table 4.5. The results show slight deviations from normality, which may not be an issue given the large sample size.
            

```{r, echo = FALSE, message = FALSE, warning = FALSE}
remove_outliers <- function(x, na.rm = TRUE, ...) {
  qnt <- quantile(x, probs=c(.10, .90), na.rm = na.rm, ...)
  H <- 1.5 * IQR(x, na.rm = na.rm)
  y <- x
  y[x < (qnt[1] - H)] <- NA
  y[x > (qnt[2] + H)] <- NA
  y
}


data_wins <- sapply(my_data[,c("assets", "kkm", "pcrdbgdp", "stmktcap", 
                               
                               "gdp_growth_annual", "asset_structure")], remove_outliers) %>% 
  
  cbind(my_data[,c("mfiid", "mfiname", "year", "country", "currentlegaldummy", 
                   
"currentlegalstatus", "age", "legal_tradition", "fineff.theta_hat", 

"soceff.theta_hat", "finsoceff.theta_hat",

"region", "dummy", "count")]) %>% 
  
  na.omit() %>% 
  
  relocate(mfiid:count)
```

## Conclusion
This study examined the levels and drivers of financial efficiency, social efficiency, and socio-financial efficiency of MFIs in Africa, particularly along MFI legal status lines. NGOs have the highest levels of social efficiency and socio-financial efficiency, whereas cooperatives have the least. Cooperatives, rural banks, and NGOs, in that order, have the best financial performance scores, while NBFIs trail. MFI legal status and the level of capital markets development proxied by stock market capitalisation to GDP and private credit to GDP are the critical drivers of social efficiency and socio-financial efficiency. MFI legal status, asset structure, size, and the country-level financial development proxy of stock market capitalisation to GDP are the significant factors in the case of financial efficiency. These results suggest the possibility of mission drift where MFIs that focus primarily on making financial returns perform relatively poorly in outreach to the financially excluded. NGOs appear better at balancing financial returns and social goals, even when not mainly targeting profitability or financial sustainability. Given that the legitimacy of MFIs rests on how well they balance returns and social goals, it appears that commercialisation is not working well as the researchers subscribing to the financial sustainability view of microfinance have predicted.  


\newpage

## Appendices

### Appendix 1: Hausmann Test; Fixed vs Random effects

```{r, echo = FALSE, message = FALSE, warning = FALSE}
rbind(
hausmann_test2(my_data, my_data$fineff.theta_hat),

hausmann_test2(my_data, my_data$soceff.theta_hat), 

hausmann_test2(my_data, my_data$finsoceff.theta_hat)

) %>% 
  
  set_names(names(.) %>% str_to_sentence()) %>% 
  
  kableExtra::kbl(caption = "Results of the Hausmann Tests", 
                  
                  booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9, latex_options = "hold_position")
```

\blandscape

### Appendix 2: Visualization of DEA Inputs and Outputs


```{r, fig.cap="Financial Sustainability and Social Performance Metrics for MFIs in Africa", fig.height = 4.5, fig.width = 8, echo = FALSE, message = FALSE, warning = FALSE}
(plotter(my_data, x = currentlegalstatus, 
        
        y = operational_self_sufficiency, z = currentlegalstatus, 
        
        xlabel = "", ylabel = "OSS", 
        
        title = "") +


plotter(my_data, x = currentlegalstatus, 
        
        y = percent_of_female_borrowers, z = currentlegalstatus, 
        
        xlabel = "", ylabel = "% of Female Borrowers", 
        
        title = "")) /


(plotter(my_data, x = currentlegalstatus, 
        
        y = average_loan_balance_per_borrower, z = currentlegalstatus, 
        
        xlabel = "", ylabel = "Average Loan Balance", 
        
        title = "") +


plotter(my_data, x = currentlegalstatus, 
        
        y = gross_loan_portfolio_to_total_assets, z = currentlegalstatus, 
        
        xlabel = "", ylabel = "Gross Loans to Assets", 
        
        title = "")) +
  
plot_annotation(title = "OSS, Female Borrowers, Average Loans, and Gross Loans of MFIs in Africa", 
                
                theme = theme(plot.title = element_text(size = 12)))

```

\elandscape


\blandscape

```{r, echo = FALSE, message = FALSE, warning = FALSE}
fineff_reg_fx_wins <- modelling2(data_wins, data_wins$fineff.theta_hat)

soceff_reg_fx_wins <- modelling2(data_wins, data_wins$soceff.theta_hat)

finsoceff_reg_fx_wins <- modelling2(data_wins, data_wins$finsoceff.theta_hat)

fineff_reg_rn_wins <- modelling2(data_wins, data_wins$fineff.theta_hat, model = "random")

soceff_reg_rn_wins <- modelling2(data_wins, data_wins$soceff.theta_hat, model = "random")

finsoceff_reg_rn_wins <- modelling2(data_wins, data_wins$finsoceff.theta_hat, model = "random")
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
inference_m6011 <- coeftest(fineff_reg_fx_wins, vcov = vcovBK(fineff_reg_fx_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m6111 <- coeftest(soceff_reg_fx_wins, vcov = vcovBK(soceff_reg_fx_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m6211 <- coeftest(finsoceff_reg_fx_wins , vcov = vcovBK(finsoceff_reg_fx_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m6311 <- coeftest(fineff_reg_rn_wins, vcov = vcovBK(fineff_reg_rn_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m6411 <- coeftest(soceff_reg_rn_wins, vcov = vcovBK(soceff_reg_rn_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m6511 <- coeftest(finsoceff_reg_rn_wins, vcov = vcovBK(finsoceff_reg_rn_wins, method = "arellano", type="HC1", cluster = "group"))
```


```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
stargazer(fineff_reg_fx_wins, soceff_reg_fx_wins, 
          
         finsoceff_reg_fx_wins, fineff_reg_rn_wins, 
         
         soceff_reg_rn_wins, finsoceff_reg_rn_wins,
         
         title = "Regression Output for Efficiency for Winsorized Data (Standard Errors in Brackets)", 
         
          align = TRUE, font.size = "tiny", header = FALSE, 
         
         se = list(inference_m6011[,2], inference_m6111[,2], inference_m6211[,2], 
          
          inference_m6311[,2], inference_m6411[,2], inference_m6511[,2]),
         
          omit = c("year.", "Constant"),
          
          add.lines = list(c("Model", "Within", "Within", "Within", 
                        
            "Random", "Random", "Random"), 
            
            c("Depvar", "FinEff", "SocEff", "FinSocEff", "FinEff", 
              
              "SocEff", "FinSocEff"),
            
            c("Data", "Full", "3 Years and over", "5 Years and over", 
                                             
            "Full", "3 Years and over", "5 Years and over")))
```

\elandscape

\blandscape

\newpage

### QQ Plots for Financial and Social Efficiency

```{r, fig.height = 4.5, fig.width = 8, fig.align='center', fig.cap="residual QQ-plots for Fixed and Random Effects Regression Models", echo = FALSE, message = FALSE, warning = FALSE}
par(mfrow = c(2,2))
qqnorm(residuals(fineff_reg_fx), ylab = 'Residuals', 
       xlab = "",
       col = "red", 
       main = "Financial Efficiency: FE")
qqline(residuals(fineff_reg_fx))

qqnorm(residuals(fineff_reg_rn), ylab = 'Residuals', xlab = "", 
       col = "red", 
       main = "Financial Efficiency: RE")
qqline(residuals(fineff_reg_rn))

qqnorm(residuals(soceff_reg_fx), 
       ylab = 'Residuals', 
       xlab = "",
       col = "red", 
       main = "Social Efficiency: FE")
qqline(residuals(soceff_reg_fx))

qqnorm(residuals(soceff_reg_rn), ylab = 'Residuals', xlab = "", 
       col = "red", 
       main = "Social Efficiency: RE")
qqline(residuals(soceff_reg_rn))

```


\newpage

### QQ-Plots, Financial/Social Efficiency (Winsorised).

```{r, fig.height = 4.5, fig.width = 8, fig.align='center', fig.cap="residual QQ-plots for Fixed and Random Effects Regression Models", echo = FALSE, message = FALSE, warning = FALSE}
par(mfrow = c(2,2))
qqnorm(residuals(fineff_reg_fx_wins), ylab = 'Residuals', 
       xlab = "",
       col = "red", 
       main = "Financial Efficiency- Winsorized: FE")
qqline(residuals(fineff_reg_fx_wins))

qqnorm(residuals(fineff_reg_rn_wins), ylab = 'Residuals', xlab = "", 
       col = "red", 
       main = "Financial Efficiency-Winsorized: RE")
qqline(residuals(fineff_reg_rn))

qqnorm(residuals(soceff_reg_fx_wins), 
       ylab = 'Residuals', 
       xlab = "",
       col = "red", 
       main = "Social Efficiency- Winsorised: FE")
qqline(residuals(soceff_reg_fx_wins))

qqnorm(residuals(soceff_reg_rn_wins), ylab = 'Residuals', xlab = "", 
       col = "red", 
       main = "Social Efficiency-Winsorized: RE")
qqline(residuals(soceff_reg_rn_wins))

```

\newpage

### QQ-Plots for Socio-Financial Efficiency

```{r, fig.height = 4.5, fig.width = 8, fig.align='center', fig.cap="residual QQ-plots for Fixed and Random Effects Regression Models", echo = FALSE, message = FALSE, warning = FALSE}
par(mfrow = c(2,2))
qqnorm(residuals(finsoceff_reg_fx), ylab = 'Residuals', 
       xlab = "",
       col = "red", 
       main = "Socio-Financial Efficiency: FE")
qqline(residuals(finsoceff_reg_fx))

qqnorm(residuals(fineff_reg_rn_wins), ylab = 'Residuals', xlab = "", 
       col = "red", 
       main = "Socio-Financial Efficiency: RE")
qqline(residuals(fineff_reg_rn))

qqnorm(residuals(finsoceff_reg_fx_wins), 
       ylab = 'Residuals', 
       xlab = "",
       col = "red", 
       main = "Socio_Financial Efficiency- Winsorised: FE")
qqline(residuals(finsoceff_reg_fx_wins))

qqnorm(residuals(finsoceff_reg_rn_wins), ylab = 'Residuals', xlab = "", 
       col = "red", 
       main = "Socio_Financial Efficiency-Winsorized: RE")
qqline(residuals(finsoceff_reg_rn_wins))

```

\elandscape


<!--chapter:end:05-extensions.Rmd-->

---
output:
  #bookdown::html_document2: default
  #bookdown::word_document2: default
  bookdown::pdf_document2: 
    template: templates/brief_template.tex
    citation_package: biblatex
documentclass: book
bibliography: references.bib
always_allow_html: true
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
- \usepackage[default]{sourcesanspro}
- \usepackage[T1,T2A]{fontenc}
- \usepackage{amsmath}
---

  
# The Double Bottom Line Goal of Microfinance Institutions in Africa
\minitoc <!-- this will include a mini Table 6.of contents-->
\chaptermark{Achievement of Dual Objectives by MFIs}

<!-- LaTeX normally does not indent the first line after a heading - however, it does so after the mini Table 6.of contents. You can manually tell it not to with \noindent -->



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.height = 9, fig.width = 14, out.width = '8.8in', fig.align = "center")

library(tidyverse)
library(dtplyr)
library(plm)
library(pglm)
library(gmnl)
library(ggthemes)
library(GGally)
library(skimr)
library(prettydoc)
library(gridExtra)
library(psych)
library(stargazer)
library(corrplot)
library(excelR)
library(bookdown)
library(rmarkdown)
library(gghalves)
library(ggalt)  
library(ggrepel)  # for annotations
library(viridis)  # for nice colors
library(broom)  # for cleaning up models
library(treemapify)  # for making area graphs
library(wesanderson)  # for nice colors
library(janitor)
library(readxl)
library(magrittr)
library(mice)
library(patchwork)
library(Rchoice)
library(gplots)
library(margins)
library(lme4)
library(kableExtra)
library(caret)
library(nnet)
library(pROC)
#library(ConfusionTableR)
library(gtable)
library(gmodels)

#########################################
options(digits = 4)
options(scipen=999)
options(knitr.kable.NA = "-")
theme_set(ggthemes::theme_clean())
#########################################
```

\newpage

\begin{center}

\textbf{ABSTRACT}

\end{center}

> This article uses data from the World Bank to examine how microfinance institutions (MFIs) in Africa fare in pursuing the double bottom line - meeting financial and social objectives. It also looks into the factors associated with the capacity of MFIs to achieve the double bottom line. We capture social performance using the per cent of female borrowers while operational self-sufficiency proxies financial performance. The results show that most MFIs in Africa attain the dual objectives, at 35.88% compared to the 14.76% who fail in both missions. Interestingly, rural banks and NGOs are more likely to achieve the dual goals than banks, NBFIs and credit unions. Age, size, capital markets development, institutional quality, legal tradition, and legal status are the significant determinants of how MFIs fare in the effort to attain joint financial and social objectives. The results remain robust after removing outliers. 

vspace{10mm}

**Key Words**: Microfinance, Efficiency, Social, Financial, Performance, Africa.

\vspace{5mm}
**JEL Classification**: G210, G230

\newpage


## Background


Microfinance Institutions (MFIs) set out to reach out to the financially excluded people with little emphasis on making profits in the early stages. However, the rise of neoliberalism has seen an increasing number of MFIs also pursuing a financial returns goal. The argument is that financially sustainable MFIs could better serve the financially excluded without over-reliance on volatile donor funds and uncertain state subsidies [@garmaise2013cheap; @d2017aid; @armendariz2013subsidy; @d2013unsubsidized]. Consequently, most modern MFIs globally are hybrid firms that have a dual objective of reaching out to the financially excluded while striving for financial sustainability [@d2017ngos]. Like most hybrid firms, MFIs face a challenge in striking a balance between the pursuit of profit and the outreach to the poor, their chief social mission [@jia2016commercialization; @d2013unsubsidized]. When the financial goals of an MFI come at the expense of social goals, the MFI is said to have experienced mission drift [@mersland2010microfinance]. 

While some researchers posit that it is possible to profitably offer financial services to the poor, financially excluded individuals [@kodongo2013individual], others hold the opposite view [@mersland2010microfinance]. The opponents argue that offering financial services to indigent clients is a high cost, high-risk business owing to the high costs of administering small loans that affer no economies of scale [@ledgerwood2006transforming]. Similarly, the poor, more so in Africa, lack collateral, are often located in remote geographic areas, lack financial literacy, and engage in informal economic activity, making it hard to track finances to assess their creditworthiness. It is against this background that most initial MFIs like the Grameen Bank in Bangladesh ran on the welfare model, emphasising outreach to the poor even at the expense of profitability. MFIs following the welfare approach had substantial backing in donor funds and state subsidies [@armendariz2013subsidy]. 

As noted, the rise of neo-liberalism after the cold war led to a paradigm shift towards financial sustainability [@bateman2010doesn]. The transition has accompanied a reduction in the level of donations and subsidies, compelling many MFIs to also strive for financial sustainability [@d2017ngos]. The shift has forced MFIs to pursue a double bottom line, that is, achieve social goals while ensuring financial viability [@ramus2017]. The trend has been the conversion of NGO, welfare MFIs, to the commercial, profit-oriented microfinance model. As noted, many researchers hold differing viewpoints regarding the suitability of MFIs pursuing the dual objectives. Some researchers argue that seeking profits is detrimental to the social mandate of reaching the unbanked due to the possibility of "mission drift", where MFIs seek profits to the detriment of their social mandate. If MFIs drift from their mission, then they risk the legitimacy that affords them a favourable legal framework from the state and earns them goodwill from stakeholders [@market2018global]. Other researchers believe that financial sustainability makes MFIs better serve the excluded. @mersland2010microfinance conducted some empirical analysis and concluded that the pursuit of profits by MFIs leads to a lower level of outreach, referred to as "mission drift". On the contrary, other researchers claim that financially sustainable MFIs reach more financially excluded people, a phenomenon dubbed "mission expansion" [@mersland2010microfinance].

In this article, we pursue two issues. First, we explore the levels of combined financial and social performance of MFIs in Africa. Secondly, we examine the factors behind the level of joint financial and social performance of MFIs in Africa. We capture financial performance using the operational self-sufficiency, OSS ^[$OSS = \frac{operating revenue}{expenses on funding, loan loss provisions, and operations}$ [@market2018global]], while the per cent of female borrowers proxies social performance. The literature shows that the majority of the financially excluded are women and rural dwellers in Africa ^[We did not include MIX data on lending to rural dwellers as it had a large proportion of missing values.]. Specifically, the study takes MFIs with an OSS of at least one to be financially sustainable. Likewise, MFIs that have at least 50% of female borrowers have succeeded socially in reaching out to the financially excluded. Following @chattopadhyay2017applicability, we develop a matrix to capture the extent to which MFIs achieve the dual objectives as shown in Table 6.1 below. 

The article contributes to the existing literature in two main ways. First, the research work documents the extent of financial and social performance of MFIs in Africa, and thus contributes to the debate on mission drift versus mission expansion. Secondly and critically, while much research examines the consequences of the transformation of MFIs [@fernando2004micro; @hishigsuren2006transformation; @d2017ngos; @ramus2017], few delve into the factors that drive the success or failure in the dual missions of MFIs as this paper does. Instead, much of the currently available research examines the effects of MFI transformation on financial sustainability and social missions with each outcome examined in isolation. The other strand examines trade-offs between the financial and social performance of MFIs without delving into the drivers of the extent of the trade-offs. Hence, this research contributes to the existing literature by examining the determinants of the achievement of twin objectives. 

While much of the research has dwelt on the trade-offs or synergies between the two schools, little of it investigates why some MFIs would differ in achieving the dual objectives. @quayes2019probability is the closest research to our contribution. In their study, they examine the probability of an MFI achieving financial sustainability. The presumption is that financial sustainability is a proxy for social outreach, meaning that the researchers lean towards microfinance's financial systems approach. The researchers conclude that the probability of financial sustainability positively affects depth of outreach, breadth of outreach, and outreach to women. The researchers do not examine the financial and social objectives together as we do in this study. 

The classification in Table 6.1 shows four categories of MFIs based on achieving both financial and social goals. In class 1, the MFIs have failed both socially and financially. These are MFIs with a share of women borrowers lower than 50% of the total borrowers and a operational self-sufficiency (OSS) less than unity. MFIs in this class risk losing legitimacy, fail to attract donations, subsidies, and being loss-making ultimately collapse. There is little literature that examines situations where MFIs fail in the twin objectives reflecting the expectations that an MFI should at least exhibit positive social influence even if it does not fare well financially.

In class 2, the MFIs succeed socially in reaching the unbanked but fail in financial sustainability. The welfare approach (NGO-Model) subscribes to this approach [@kodongo2013individual]. Although some NGOs do turn profits, this class of MFIs is a prime candidate for donations and subsidies and illustrates, as welfarists do, that financial sustainability of MFIs is not compatible with social goals. However, better financial management could allow this class of MFIs to improve their financial sustainability without trading off social goals. The financial sustainability school argues that it is possible to push these MFIs to financial sustainability without losing sight of their social mandate. 

In category three, the MFIs succeed financially but fail in the social mission. This category contains MFIs that are subject to mission drift, confirming the welfare school's view on the incompatibility between profitability and social outreach [@mersland2010microfinance; @mia2017mission]. The MFIs in this category risk their legitimacy but could survive as they operate a commercial model like mainstream commercial banks. Most cooperatives, NBFIs, and commercial banks in our dataset fall into this category, calling into question the viability of the coexistence of the profit-oriented approach to microfinance and the need to reach out to the financially excluded. NGOs form a small proportion of this group showing their relevance in microfinance. Finally, some MFIs succeed both financially and socially, which is desirable. This category points to MFIs from which mission expansion could arise. This class presents an ideal scenario for the win-win approach to microfinance that argues for the possibility of pursuing both objectives. This class also serves the financial sustainability school well, although its viability is controversial.

This current study fits within the agency theory. The entry of private capital into microfinance is bound to raise a conflict between providing appropriate and affordable financial services to the financially excluded and pursuing profits [@miller2011angel].While equity and debt-holders may favour financial inclusion, maximising returns on their investments comes first, unless blended finance is the financing model in use. Blended finance allows MFIs to use private capital to do social good without an overemphasis on profitability. Even where agency conflicts adversely affect the provision of financial services to the poor, it is hard for MFIs to keep off the financial sustainability push. The institutional theory sheds light here, where the institutional environment has a greater influence on the adoption of institutional structures than market pressures. In this respect, pressures from donor agencies may still cause more MFIs to convert to the commercial model even where evidence shows that the conversion may be detrimental to the social goal of availing financial services to the financially excluded. 

There exist MFIs that serve different segments of society. For instance, cooperatives serve a limited geographic range, targeting people with a common bond like employment. Rural banks also serve limited geographic areas in remote rural locations. MFIs registered as commercial banks and NBFIs serve relatively better off, but still poor people not served by mainstream financial intermediaries. Consequently, some researchers argument that we should allow a broad range of MFIs to exist to serve different market segments appears valid [by @morduch1999microfinance; @morduch2000microfinance]. Supporting this point, @morduch2019challenges argue that if there were no market failures in the credit market that leaves out a segment of the population unbanked, NGOs would not exist as commercial banks because other MFIs would already have filled the gap. It follows, therefore, that the call to do away with NGOs does not augur well for the financially excluded. These viewpoints call to question the validity and relevance of the debate on the pros and cons of microfinance institutions' transformation across the globe. What is critical, it seems to us, is to evaluate factors relevant for MFIs to achieve their financial and social goals as a basis for crafting policy support. Moreover, the management of MFIs would better adjust their strategies when aware of the issues that hinder or facilitate the achievement of the twin objectives.

The rest of the research proceeds as follows. In the next section, we summarise the study results followed by a description of the econometric model. We then discuss the results of the regression in detail and then conclude the report. 


```{r}
tribble(~ ` `, ~ ` `, ~ `Achieves_Financial_Goals?`, ~ `Achieves_Financial_Goals?`,
        "", "", "YES", "NO",
        "Achieves_Social_Goals?", "YES", "Class 4 (SS)", "Class 2 (FS)",
        "Achieves_Social_Goals?", "NO", "Class 3 (SF)", "Class 1 (FF)") %>% 
  
  kableExtra::kbl(., caption = "Classification Matrix: Joint Financial and Social Performance of MFIs", 
      
  booktabs = TRUE) %>% 
  
  kable_paper(full_width = FALSE) %>% 
  
  footnote(general = "Adapted from Chattopadhyay, Manojit, and Subrata Kumar Mitra (2017)",
           
  general_title = "Source: ", 
  
  number = c("In labelling the classes, we start with financial sustainability followed by social performance.", "The letters F and S stand for Fails (F) and Succeeds (S), respectively.", "For instance, FS means the MFI fails (F) financially but succeeds (S) socially."), 
  
  number_title = "Note")
```


## Summary of Results
Overall, MFIs in Africa achieve both outreach (social goals) and financial goals more than they fail in both objectives at 35.88% and 14.76%, respectively. 25.55% of MFIs succeed financially but fail socially by not reaching out adequately to the financially excluded. This result is indicative of mission drift. Another 23.80% fail financially but fare well in their social mandate of reaching the financially excluded. Broken down further, 48.59% of NGOs and 52.17% of rural banks attain both financial and social goals, as against 7.34%  and 0.72%, respectively, that fail in both. The proportions of banks, NBFIs, and credit unions that succeed financially and socially are 45.72%, 36.87%, and 17.73%. Those that fail in both objectives are 6.3%, 13.51%, and 27.61%, respectively. NGOs have the lowest proportion of MFIs that experience mission drift by meeting financial goals while failing socially at 7.66%. On the other hand, credit unions have the second-highest mission drift at 40.43%, after rural banks at 43.48%. 

The regression results show that the significant factors in determining the extent of achieving both objectives are age, size, capital markets development, institutional quality, legal tradition, and legal status. Specifically, mature MFIs are less prone to mission drift given they are more likely to fail both financially and socially than succeed in one objective while failing in the other. Larger MFIs, on the other hand, are more likely to succeed financially and fail socially than they are to fail in both objectives. Similarly, large MFIs are more likely to succeed in both goals than to fail. The results are indicative of larger MFIs being more prone to mission drift. A higher level of capital markets development and governance corresponds to a higher chance of failing in both objectives, probably due to low demand for microfinance in countries with well developed mainstream financial systems. 

Similarly, MFIs in legal traditions other than common law are more likely to fail in both objectives. The result probably connotes weak legal and infrastructural support that suppresses the development of mainstream and alternative financial systems like microfinance. Finally, the legal status outcome shows that NGOs are less likely to succeed financially while failing socially. However, NGOs are more likely than other legal forms to fail socially while succeeding financially and succeeding in both objectives. The results show that commercial forms of MFIs are more prone to mission drift. 

## The Model
The article uses the multinomial logit model, given that our dependent variable is discrete and error terms may not be normally distributed [@cramer2002origins]. In the model, NGOs take a zero code, with commercial banks, NBFIs, credit unions, and Rural Banks coded one, two, three, and four, respectively. The following section lays out and describes the models, variables, and data sources. 

### The Model, Variables Description and Data Sources
We run a multinomial logit model on a panel dataset of 705 MFIs in Africa. The multinomial logit model is an extension of the logit model, and hence we start by describing the logit model. Assuming the error term $\epsilon$ follows a logistic distribution [@czepiel2002maximum], we have:

\begin{equation}
y_{it} = log(\frac{p_{it}}{(1-p_{it})} ) = \alpha + x_{it} + \varepsilon_{it}
\end{equation}

where,

\begin{equation}
p_{it}  =  \frac{1}{1 +  e^{- z_{it} } } 
\end{equation}

and

\begin{equation}
1 + p_{it}  =  \frac{1}{1 +  e^{z_{it} } }
\end{equation}

for $z_{it} = f(x_{it})$

In the model, $y_{it}$ is the current legal status of the MFI, the dependent variable, that is, the dependent variable is a dummy with NGOs, the base outcome (coded zero), and other legal traditions take a code of one. The symbol $x_{it}$ represents a vector of independent variables: age, size, capital market development, legal tradition, GDP growth rate, and institutional quality. Additionally, we include year dummies to cater for the trends towards commercialisation. 

The multinomial logit model extends the binary logit model to more than two unordered levels (discrete choices). The data at hand meets the requirements for running a multinomial logit model as the dependent variable (the legal status of each MFI) has one outcome for each case. Also, the independent variables do not predict the dependent variable perfectly [@petrucci2009primer]. Suppose we have a dependent variable $y$ consisting of $K$ choices for $K \geqslant 2$. Further, let the independent variables be $x_1, x_2,………. x_n$, then we can specify the multinomial logit model as follows. 

\begin{equation}
log(\frac{prob(k/X)}{prob(K/X)}) =   \beta_{0}^{k}  x_{0}  + \beta_{1}^{k}  x_{1} +  \cdots + \beta_{p}^{k}  x_{p}
\end{equation}

for $k = 1 \cdots K-1$

$y$ is the dependent variable, in this case, one of NGO, commercial bank, NBFI, credit union or rural bank.

$x$ is a vector of independent variables.

If $K>2$, then we have a multinomial logit with $K-1$ set of equations. Where $K=2$, the model is the binary logit model denoted in equation one (1) where we have one equation. Note that in this case, we have arbitrarily assigned the last category (K) as the reference. Any other group can serve as a reference and hence not be part of the equations set. 

One of the significant drawbacks of the multinomial logit is the violation of the assumption of the independence of irrelevant alternatives (IIA). @cheng2007testing ) illustrate this assumption using the blue bus-red bus example. If the choice between car transport and a red bus, and given that the probability of choosing a bus is $0.8$, and $0.2$ for a car, then the bus's odds over car transport is 4. Suppose we introduce a third alternative, the blue bus. If the probabilities of choosing a red bus, blue bus, and car transport are $0.6$, $0.25$, $0.15$, respectively, the assumption holds since the odds of selecting a red bus over a car are still $4$. If the odds are different from $4$, then the model violates the IIA, and the multinomial model is not fit for the data. In our case, we plausibly see the assumption holding because the legal status of an individual MFI is independent of the legal status of other MFIs. Table 6.2 (next page) describes the variables in detail. 


```{r}
## legal traditions 
### Common law countries in Africa
common <- tibble(country = c("Botswana", "Gambia, The", "Ghana", "Kenya", "Lesotho", "Liberia", "Malawi", "Namibia", "Nigeria", "Sierra Leone", "South Africa", "South Sudan", "Sudan", "Eswatini", "Tanzania", "Uganda", "Zambia", "Zimbabwe"), trad = c(rep("common", 18)))

### Civil law countries in Africa
civil <- tibble(country = c("Algeria", "Benin", "Burkina Faso", "Cameroon", "Central African Republic", "Chad", "Comoros", "Congo, Rep.", "Cote d'Ivoire", "Gabon", "Guinea", "Madagascar", "Mali", "Mauritania", "Morocco", "Niger", "Senegal", "Togo", "Tunisia"), trad = c(rep("civil", 19)))

### Other legal traditions in Africa
others <- tibble(country = c("Equatorial Guinea", "Angola", "Burundi", "Cape Verde", "Congo, Dem. Rep.", "Egypt, Arab Republic of", "Ethiopia", "Eritrea", "Guinea-Bissau", "Mozambique", "Rwanda"), trad = c(rep("others", 11)))

###Putting them all together
legal <- rbind(common, civil, others)
```

```{r}
# Bond market data - private and public bond market capitalization to GDP
bonds <- read_excel("bonds_oluoch.xlsx") %>% 
  
  janitor::clean_names()

```

```{r}
# Add the financial development index to the dataset
## Countries not part of Africa
mideast <- c("Bahrain", "Iran, Islamic Rep.", "Iraq", "Israel", "Jordan", "Kuwait", "Lebanon", "Malta", "Oman", "Qatar", "Saudi Arabia", "Syrian Arab Republic", "United Arab Emirates", "West Bank and Gaza", "Yemen, Rep.")

## Load the financial structure data
finstr <- read_excel("FinancialStructureDatabase20191018.xlsx", sheet = 4) %>% 
  
  ## Select desired variables
  select(country, region, year, pcrdbgdp, stmktcap, stvaltraded, stturnover, listco_pc) %>% 
  
  ### Filter out regions not in Africa or middle east
  filter(region == "Sub-Saharan Africa" | region == "Middle East & North Africa") %>% 
  ### Filter out countries in middle east and select year 1999 onwards
  filter(!country %in% mideast, year >= 1999) %>% 
  
## Replace NAs
          group_by(country) %>% 
  
          mutate(pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
                 
                 pcrdbgdp = replace_na(pcrdbgdp, 0),
                 
                 stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE)),
                 
                 stmktcap = replace_na(stmktcap, 0)) %>% ungroup() %>% 
  
## Join with the bonds data
  left_join(bonds, by = c("country", "year")) %>% 
  
## rename bonds columns 
  rename(prbonds = outstanding_t_bonds_percent_gdp, 
         
         pubonds = outstanding_c_bonds_percent_gdp) %>% 
  
  ## Replace NAs in public bond and private bond markets 
  mutate(pubonds = replace_na(pubonds, 0), 
         
         prbonds = replace_na(prbonds, 0)) %>% 
  
         ## Rename Ivory Coast
         mutate(country = if_else(country == "Côte d'Ivoire", "Cote d'Ivoire", 
                                  
                                  country))

## View missing data points
#mice::md.pattern(finstr)

#finstr %>% select(pcrdbgdp, stmktcap) %>% cor(.) %>% 
  
  #corrplot(method = "number", type = "lower")
```

```{r}
## Read in the dataset 
my_data <- read_csv("amelia.csv") %>% 

## Region
mutate(region = if_else(region == "Middle East and North Africa", 
                        
                        "North_Africa", region)) %>% 

# Clean the names 
janitor::clean_names() %>% 
  
# Set up factor variables 
## legal status 
mutate(currentlegalstatus = factor(currentlegalstatus, 
                           levels = c("NGO", "Bank", "NBFI", 
                            "Credit Union/ Cooperative", 
                            "Rural Bank")), 
      ## Age
      age = factor(age, levels = c("New", "Young", "Mature")),
       
      ## Region 
      region = factor(region, levels = c("North_Africa", "Africa"))) %>% 
  
      ## Add the financial structure data     
      left_join(finstr, by = c("country", "year")) %>% 
  
      ## Add a binary variable for the legal dummy- NGO vs Others
      mutate(currentlegaldummy = case_when(currentlegalstatus == "NGO" ~ "NGO",
                                           
                                           TRUE ~ "others"),
      
        currentlegaldummy = factor(currentlegaldummy, levels = c("NGO", "others")),
        
        legal_tradition = factor(legal_tradition, 
                                 
                                 levels = c("Common", "Civil", "Other"))) %>% 
  ## Select required variables 
  select(mfiid, mfiname, year, country, currentlegaldummy, currentlegalstatus, 
         
         percent_of_female_borrowers, operational_self_sufficiency,
         
         age, legal_tradition, region.x, asset_structure, 
         
         assets, kkm, education, pcrdbgdp, stmktcap, prbonds, 
         
         gdp_growth_annual, donations, donations_assets_ratio) %>% 
  
          ## Rename region
         rename(region = region.x) %>% 
  
  group_by(country) %>% 
  
  mutate(kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         education = replace_na(education, median(education, na.rm = TRUE)),
         prbonds = replace_na(prbonds, median(prbonds, na.rm = TRUE)),
         pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
         stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(mfiid) %>% 
  
  mutate(asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)), 
         
         percent_of_female_borrowers = replace_na(percent_of_female_borrowers, 
                                                  
                                                  median(percent_of_female_borrowers, na.rm = TRUE)),
         
         operational_self_sufficiency = replace_na(operational_self_sufficiency, 
                                                   
                                                   median(operational_self_sufficiency, na.rm = TRUE)),
         
         assets = replace_na(assets, median(assets, na.rm = TRUE)),
         
         donations = replace_na(donations, median(donations, na.rm = TRUE)),
         
         donations_assets_ratio = replace_na(donations_assets_ratio, 
                                             
                                  median(donations_assets_ratio, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(region) %>% 
  
  mutate(education = replace_na(education, median(education, na.rm = TRUE)),
         
         kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         
         gdp_growth_annual = replace_na(gdp_growth_annual, 
                                        
         median(gdp_growth_annual, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(currentlegalstatus) %>% 
  
  mutate(assets = replace_na(assets, median(assets, na.rm = TRUE)), 
         
         percent_of_female_borrowers = replace_na(percent_of_female_borrowers, 
                                                  
                        median(percent_of_female_borrowers, na.rm = TRUE)),
         
         operational_self_sufficiency = replace_na(operational_self_sufficiency, 
                                                   
                        median(operational_self_sufficiency, na.rm = TRUE)),
         
         donations = replace_na(donations, median(donations, na.rm = TRUE)),
         
         donations_assets_ratio = replace_na(donations_assets_ratio, 
                                             
                                  median(donations_assets_ratio, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  mutate(dummy = if_else(currentlegaldummy == "NGO", 0, 1)) %>% 
  
  mutate(assets = log(assets + 1),
         
         pcrdbgdp = log(pcrdbgdp + 1),
         
         stmktcap = log(stmktcap + 1),
         
         prbonds = log(prbonds + 1)) %>% 
  
  select(-asset_structure) %>% 
  
  add_count(mfiid, name = "count") %>% 
  
  mutate(currentlegalstatus = fct_recode(currentlegalstatus, Coop = "Credit Union/ Cooperative")) %>% 
  
  mutate(finsoc = case_when(operational_self_sufficiency >= 1 & percent_of_female_borrowers > 0.5 ~ "SS",
                            
                            operational_self_sufficiency > 1 & percent_of_female_borrowers < 0.5 ~ "SF", 
                            
                            operational_self_sufficiency < 1 & percent_of_female_borrowers >= 0.5 ~ "FS",
                            
                            TRUE ~ "FF")) %>% 
  
mutate(finsoc = factor(finsoc, levels = c("FF", "SF", "FS", "SS"))) %>% 
  
## replace negative donations with zero
mutate(donations = case_when(donations <= 0 ~ 1,
                             TRUE ~ donations))
## Write a csv for the data
my_data %>% write.csv(., "data.csv")

## Visualize missing data
#md.pattern(data)
## Amelia::missmap(data)

## MFIs with three (3) or more years of data
data3 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 3)
  
data3 %>% write.csv(., "data3.csv")

## MFIs with three (3) or more years of data
data5 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 5)  
  
data5 %>% write.csv(., "data5.csv")
```



### Variables Description and Data Sources
The dependent variable is a dummy with four levels that capture how well MFIs achieve financial and social objectives. The firm-level independent variables are the legal status, age and size of the MFIs. The legal tradition, institutional quality, private credit to GDP, stock market to GDP, and GDP growth rates capture country-level macro-factors. 

As illustrated in Table 6.1, we construct the dependent variable using the combination of the percentage of women borrowers and operational self-sufficiency (OSS). Lending to women proxies the social performance of MFIs, with success being where an MFI has women clients comprising 50% or more of the total borrowers. An OSS of at least one indicates a financially sustainable MFI. We then generate four categories starting from MFIs that succeed in both financial and social metrics on one extreme and those that fail in both on the other. In between are MFIs that succeed in one of the metrics but fail in the other. Apart from the proposition by @chattopadhyay2017applicability, little research has applied this approach to examine the joint financial and social efficiency of MFIs. 

As noted, some legal forms of MFIs restrict the capacity of MFIs to emphasise financial or social goals. NGOs are an extreme case where donors and stakeholders expect that they are more socially oriented. Their degree of social orientation is the source of legitimacy and justifies continued donor and state support. In Africa, rural banks serve a niche market that is most prone to financial exclusion and hence are expected to focus on social performance over and above financial performance. On the other hand, cooperatives are member-oriented and may not have room to improve their social outlook unless by recruiting more diverse group members. In countries and areas where people suffer financial exclusion, joining a cooperative is out of the question given their low-income status, which leads to their financial exclusion in the first place [@demirguc2018global]. The exception is farmers cooperatives that pool together smallholder farmers to gain scale economies in the procurement of inputs and sale of produce [@porter1987economic]. Commercial banks and NBFIs tend to have more external capital, and agency conflicts may arise between managers who want to optimise financial and social objectives and providers of funds who may chiefly focus on financial returns. An exceptional case is that of blended finance, where providers of funds do so knowing that achieving social goals is equally critical.  

The age and size of an MFI go together in explaining the firm-level factors that drive the achievement of the twin objectives. Mature MFIs tend to be larger (see Figure 6.1). Following the institutional theory, large, mature MFIs are less likely to succumb to donors and other stakeholders' pressures to attain financial sustainability [@d2017aid]. Alternatively, larger and more sTable 6.MFIs have more resources to afford to offer the poor financial services even as donations subside [@d2013unsubsidized]. As @mersland2010microfinance argue, such MFIs could offer financial services to the relatively well-off at market rates, allowing them to cross-subsidize services to the financially excluded. In such a scenario, @mersland2010microfinance argue that the conversion of MFIs to the commercial model is likely to lead to "mission expansion" as opposed to "mission drift". 

The country-level factors address the macro-environment. For example, researchers associate the legal tradition with the financial system's development [@schnyder2018twenty]. Common law and civil law traditions dominate in Africa, with the former exhibiting a higher financial development levels [@la2013law]. People in countries with higher quality of institutional development are more likely to access the mainstream financial system [@allen2013resolving; @allen2014african] and demand fewer microfinance services. Likewise, countries with better institutional quality have better developed financial system, which lowers the demand for microfinance. The country's level of financial development reflects in the private credit to GDP and stock markets capitalization to GDP. Better developed financial markets imply higher access and use of financial services and lower financial exclusion chances. The result is a lower demand for microfinance resulting in poor financial and social performance by MFIs [@allen2013resolving; @allen2014african]. 

Finally, the GDP growth rate reflects the health of the economy. With more output, people are likely to have higher incomes over time, making them demand financial services like savings and credit to smooth consumption, for example [@ahlin2011does; @buera2021macroeconomics]. As described in Table 6.2, the data comes from the World Bank. The firms level data is from the MIX market. The country-level data is from three chief sources: the World Development Indicators (WDI), the Worldwide Governance Indicators (WGI), and the Global Financial Development Database (GFDD). Table 6.2 shows a description of the variables employed in the study. 

```{r}
tribble(~ Variable_Description, "1. Current Legal Status: This is the dependent variable. For logit and probit models, we create a dummy with the MFIs following the NGO Model getting a code of zero, and one in the case of non-bank financial institutions (NBFIs), rural banks, and credit unions/ cooperatives. We assign codes of zero to four for the multinomial logit model for NGOs, Banks, NBFIs, Cooperatives and Rural Banks, respectively. The data are available from the Microfinance Information Exchange, MIX (See source on note 1).", "", "2.	Age: The period in which the MFI has been in operation. MFIs fall into one of three groups: new (1-4 years), young (4-8 years), and mature (over 8 years). The data are available from MIX.", "", "3. Legal Tradition (Legal): The indicator is a dummy variable with common law countries coded 0, civil law countries 1, and 2 otherwise as per the classification by Oto-Peralías and Romero-Ávila (2014).", "", "4. Size (Log of Total Assets): We proxy the size of MFI with the natural logarithm of total assets, again using MIX data.", "", "5. Governance/ Institutional Quality (KKM): We take the first principal component of the WGI developed by Daniel Kaufmann, Aart Kraay and Massimo Mastruzzi (KKM) available on the World Bank's Worldwide Governance Indicators, WGI (See source on note 3).", "", "6. Private Credit to GDP: We capture the total amount of credit advanced to the private sector by financial intermediaries as a proxy for capital markets development concerning the banking sector following Ito and Kawai (2018). The data source is the Global Financial Development Database (GFDD) of the World Bank (See note 4).", "", "7. Stock market capitalisation to GDP: We capture the  extent of stock market development using the ratio of stock market capitalisation to GDP to proxy how firms can raise equity capital. Although Africa's equity markets are thin, some relatively large stock markets like South Africa, Kenya, and Ghana exist. The data are from the GFDD.", "", "8. GDP annual growth rate (GDP): This is the year on year growth in output adjusted for inflation and sourced from the World Development Indicators (WDI) (See note 2).", "") %>% 
  
  kbl(., caption = "Description of Variables", booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE) %>% 
  
  footnote(number = c("MIX Database on www.themix.org and https://datacatalog.worldbank.org/dataset/mix-market", "WDI on https://databank.worldbank.org/source/world-development-indicators.", "WGI/ KKM on https://databank.worldbank.org/source/worldwide-governance-indicators.", "GFDD on https://www.worldbank.org/en/publication/gfdr/data/global-financial-development-database"), 
           
           number_title = "Notes",
    
           general = "Authors' construction from the literature",
           
           general_title = "Source: ")
  
  #knitr::kable(caption = "Description of variables")
```

## Results
In this section, we explore and describe the data, followed by a discussion of the output from the regression analysis.

### Exploratory Data Analysis and Data Visualization
#### Summary Statistics
Figure 6.1, Figure 6.2, and Tables 3 and 4 show a breakdown of the extent to which MFIs in Africa meet the dual financial and social objectives. Figure 6.1 shows that most MFIs in the sample achieve both financial goals with only a small proportion failing in both mandates. A marginally higher proportion of MFIs succeed financially while failing socially than those that fail financially while succeeding socially. The result could indicate that mission drift is not as widespread and that there is an even chance that an MFI will experience mission drift or not. The result goes against the welfare model of microfinance [@d2017ngos]. However, a clearer picture emerges when we break down the outcome by the legal status of MFIs in Figure 6.2. 

Panel A and B  of Figure 6.2 show the counts, while panel C and D show the proportions of MFIs and the extent they meet the twin objectives. Tables 3 and 4 show the respective proportions. We base the discussion on Figure 6.1 panel C and Table 6.4.  The results in Panel C show that cooperatives with the lowest proportion of MFIs succeeding financially and socially at 17.7%. Besides, they have the second lowest proportion (after rural banks with 43.5%) of failing socially and succeeding financially at 40.4%. By contrast, they have the lowest highest chance (after rural banks with 3.6%) of failing financially and succeeding socially at 14.2%. Notably, cooperatives have the highest chance of failing to meet both objectives at 27.6%. The results illustrate the nature of cooperatives as geographically limited entities whose sole focus is on members who can make savings to qualify for loans [@porter1987economic]. Not many  financially excluded individuals may join cooperatives due to limited incomes and information and their situation in remote geographical locations.


```{r, fig.width = 7, fig.height=5, fig.align='center', fig.cap = "Financial and Social Performance of MFIs in Africa"}
my_data %>% 
  
  count(finsoc, name = "Total") %>% 
  
  mutate(`Proportion(%)` = Total*100 / sum(Total)) %>% 
  
  rename(Finsoc = finsoc) %>% 

  ggplot(aes(x = fct_reorder(Finsoc, `Proportion(%)`, max) , y = `Proportion(%)`, fill = Finsoc)) + 
  
  geom_col() + 
  
  geom_label(aes(label = round(`Proportion(%)`, 2))) + 
  
  theme(legend.position = "none") + 
  
  labs(y = "Proportions (%)", x = "Financial and Social Performance", 
       
       title = "Financial and Social Performance of MFIs in Africa") + 
  
  coord_flip()
```




```{r}
# gmodels::CrossTable 6.(my_data$finsoc, my_data$currentlegalstatus, prop.chisq = FALSE)

prop.table(table(my_data$finsoc, my_data$currentlegalstatus), margin = 1) %>% 
  
  knitr::kable(caption = "Joint Financial and Social Performance by Legal Status of MFIs in       
               Africa (row-wise)", booktabs = TRUE) %>% 
  
  kableExtra::kable_styling(font_size = 8, full_width = TRUE, position = "center") %>% 
  
  footnote(general = "Authors' construction from MIX data",
           
  general_title = "Source: ", 
  
  number = c("The horizontal (row) values add up to 100%", "We start with financial sustainability followed by social performance", "For instance, FS means the MFI fails (F) financially but succeeds (S) socially.", "The letters F and S stand for Fail and Succeeds, respectively"), 
  
  number_title = "Note")
```



We turn to NBFIs. NBFIs have the third-highest proportion, after NGOs and commercial banks, of MFIs that meet the twin objectives at 36.9%. However, they have the second-highest chance, after NGOs of failing financially while succeeding socially. Similarly, after NGOs, NBFIs have the second-lowest chance of succeeding financially while failing socially at 27.2%. NBFIs also have the second highest chance after cooperatives of failing to meet the twin objectives at 13.5%. Also, NBFIs have the second-lowest proportion of MFIs that succeed financially while failing socially at 22.4%. In this respect, NBFIs show some degree of social orientation. NBFIs appear to strike a balance between the extremes of failing in both objectives versus succeeding in both objectives. 

NGOs have the second-highest instance of succeeding financially and socially at 48.6% in the sample data, after rural banks. NGOs also have the highest proportion of MFIs that fail financially while succeeding socially (36.41%). Again, NGOs have the lowest chance of succeeding financially while failing socially at 36.4%. NGOs have the third-lowest instance (7.3%) of failing both financially and socially after commercial banks (6.3%) and rural banks (0.7%). The results for NGOs illustrate their leaning towards the welfare school of prioritizing outreach over profitability. These results appear to confirm the welfare school's concerns that the explicit pursuit of profits is incompatible with the extension of financial services to the financially excluded [@d2017ngos]. 

Commercial banks come second after NGOs in the proportion of MFIs that succeed financially and socially at 45.7%. However, commercial banks have the lowest chance of failing financially while succeeding socially after rural banks and cooperatives. After rural banks and cooperatives, banks are the third least likely to succeed financially while failing to meet their social objectives. Besides, commercial banks have the second-lowest instance of failing to meet both goals. Lastly, though the sample of rural banks is small, they show the highest likelihood of succeeding financially and socially and failing to achieve the twin objectives. Rural banks have the least instance of succeeding financially while failing socially, and have no instance of failing to meet both objectives. Given that rural banks specifically target the financially excluded in rural areas, it is rare that they would fail in their social mandate. However, the number of rural banks in the sample data was small and hence the results in Table 6.3.

The observations in the visualisation appear to validate the concerns by the welfare school of microfinance that, indeed, pursuing a financial return is incompatible with outreach to the financially excluded. Except for NBFIs that seem evenly spread between the different classes, the other commercial MFIs, that is, banks, cooperatives, and rural banks, are biased against social outreach. NGOs show a high degree of social orientation, are at the top when it comes to achieving the twin objectives, and come last in the class of MFIs that succeed financially and fail socially. We shall revisit this issue in the regression analysis. Finally, for profit-oriented MFIs like commercial banks, financial performance is a prerequisite for achieving social objectives. The result could be due to the lower proportion of donations and subsidies that for-profit MFIs receive [@d2013unsubsidized], which forces them to focus on financial sustainability. Only after they achieve some degree of financial sustainability do they turn their attention to achieving social goals. We visualise the data in the next section. 

#### Data visualization
Figure 6.3 shows the correlation between the independent numeric variables. The highest correlation is between private credit to GDP and stock market capitalisation to GDP at 0.321. Institutional quality and private credit to GDP follow at -0.265. Overall the correlation between independent variables is not high to raise multicollinearity concerns (See Table 6.14 on variance inflation factors, VIF). Further, Figure 6.4 shows that smaller MFIs tend to fail financially while the bigger ones succeed. Socially, the smallest MFIs tend to succeed, while larger ones exhibit mixed results. Overall, larger MFIs show greater evidence of mission drift. Panel B shows that MFIs in countries with the robust institutional quality and higher incomes tend to fail socially, unlike their counterparts in countries with lower institutional quality. As noted, higher institutional quality lowers the demand for microfinance as many people have access to the mainstream financial system [@allen2014african; @allen2013resolving]. However, MFIs in countries with the poorest institutional quality tend to fail financially, while those in jurisdictions with the highest institutional quality succeed. The result suggests the high costs of serving financially excluded markets, making it hard to turn a financial return. ITherefore, it is important to examine the circumstances in individual countries before prescribing or discouraging the conversion of MFIs. In relatively well off countries, the transformation of MFIs could be feasible. In impoverished countries where financial exclusion is high, the conversion may fail as MFIs cannot make enough to sustain the extension of financial services to the many financially excluded people. 

As with institutional quality, MFIs in countries with high private credit to GDP imply better banking sector development and wealth, and have a higher chance of failing socially. With financial inclusion, there is low demand for microfinance in these countries [@huang2010political]. The opposite is true for MFIs in countries with low private sector credit to GDP. The link between the financial performance of MFIs and private credit shows mixed results, with MFIs in countries with the highest and lowest private credit tending to fail financially. Stock market development shows a trend that is opposite of private credit to GDP, with MFIs in countries with high levels of stock market development tending to succeed socially. The link between the financial performance of MFIs and stock market development is also mixed. The results may indicate the weak linkage between the stock markets and the financially excluded financial needs at the base of the income pyramid. Overall, the visualizations show that independent variables may be relevant in explaining the degree of joint financial and social performance of MFIs in Africa. 



```{r, eval=FALSE}
my_data %>% 
  
  dplyr::count(currentlegalstatus, finsoc, name = "Number_of_MFIs") %>% 
  
  mutate(Legal_Status = currentlegalstatus) %>% 
  
  select(-currentlegalstatus) %>% 
  
  relocate(Legal_Status) %>% 
  
  arrange(Legal_Status, finsoc) %>% 
  
  group_by(Legal_Status) %>% 
  
  mutate(Prop_of_MFIs = Number_of_MFIs / sum(Number_of_MFIs) * 100) %>% 
  
  select(-Number_of_MFIs) %>% 

  pivot_wider(names_from = finsoc, values_from = Prop_of_MFIs) %>% 
  
  kableExtra::kbl(caption = "Summary Statistics for Joint Financial and Social Performance of MFIs in Africa", booktabs = TRUE) %>% 
  
  kableExtra::kable_styling(font_size = 8, full_width = TRUE, position = "center") %>% 
  
  footnote(general = "Authors' construction from MIX data",
           
  general_title = "Source: ", 
  
  number = c("The horizontal (row) values add up to 100%", "We start with financial sustainability followed by social performance", "For instance, FS means the MFI fails (F) financially but succeeds (S) socially.", "The letters F and S stand for Fail and Succeeds, respectively"), 
  
  number_title = "Note") %>% 
  
  landscape()
```





```{r}
# gmodels::CrossTable 6.(my_data$finsoc, my_data$currentlegalstatus, prop.chisq = FALSE)

prop.table(table(my_data$finsoc, my_data$currentlegalstatus), margin = 2) %>% 
  
  knitr::kable(caption = "Joint Financial and Social Performance by Legal Status of MFIs in Africa (Columnwise)", booktabs = TRUE) %>% 
  
  kableExtra::kable_styling(font_size = 8, full_width = TRUE, position = "center") %>% 
  
  footnote(general = "Authors' construction from MIX data",
           
  general_title = "Source: ", 
  
  number = c("The vertical (column) values add up to 100%", "We start with financial sustainability followed by social performance", "For instance, FS means the MFI fails (F) financially but succeeds (S) socially.", "The letters F and S stand for Fail and Succeeds, respectively"), 
  
  number_title = "Note")
```




\newpage
\blandscape

```{r, fig.cap = "Financial and Social Performance of MFIs in Africa"}

library(patchwork)

(my_data %>% ggplot(mapping = aes(x = fct_infreq(currentlegalstatus), fill = finsoc)) + 
  
  stat_count() + 
  
  scale_fill_brewer(palette = 7) + 
  
  labs(x = "Financial and Social Perfomance", y = "Count", 
       
       title = "Panel A") +

my_data %>% ggplot(mapping = aes(x = fct_infreq(finsoc), fill = currentlegalstatus)) + 
  
  stat_count() + 
  
  scale_fill_brewer(palette = 4) + 
  
  labs(x = "Financial and Social Perfomance", y = "", 
       
       title = "Panel B") + 
  
  guides(fill=guide_legend(title="Legal Status"))) / 
           
(my_data %>% ggplot(mapping = aes(x = fct_infreq(currentlegalstatus), fill = finsoc)) + 
  
  geom_bar(position = "fill", show.legend = FALSE) + 
  
  scale_fill_brewer(palette = 7) + 
  
  labs(x = "Financial and Social Perfomance", y = "Proportion", 
       
       title = "Panel C") +

my_data %>% ggplot(mapping = aes(x = fct_infreq(finsoc), fill = currentlegalstatus)) + 
  
  geom_bar(position = "fill", show.legend = FALSE) + 
  
  scale_fill_brewer(palette = 4) + 
  
  labs(x = "Financial and Social Perfomance", y = "", 
       
       title = "Panel D") + 
  
  guides(fill=guide_legend(title="Legal Status")))
```
\elandscape



```{r}
median_n <- function(x){median(x, na.rm = TRUE)}
```

```{r}
theme_niwot <- function(){
  theme_bw() +
    theme(axis.text = element_text(size = 7), 
          axis.title.x = element_blank(),
          axis.title.y = element_text(size = 8),
          axis.line.x = element_line(color="black"), 
          axis.line.y = element_line(color="black"),
          panel.border = element_blank(),
          panel.grid.major.x = element_blank(),                                          
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          panel.grid.major.y = element_blank(),  
          plot.margin = unit(c(1, 1, 1, 1), units = , "cm"),
          plot.title = element_text(size = 10, vjust = 1, hjust = 0),
          legend.text = element_text(size = 8),          
          legend.title = element_blank(),                              
          legend.position = c(0.95, 0.15), 
          legend.key = element_blank(),
          legend.background = element_rect(color = "black", 
                                           fill = "transparent", 
                                           size = 2, linetype = "blank"))
}
```



```{r}
###########################################
#' ggplot Flat Violin
#' @export
#' @details Copy-pasted from https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R
#' somewhat hackish solution to:
#' https://twitter.com/EamonCaddigan/status/646759751242620928
#' based mostly on copy/pasting from ggplot2 geom_violin source:
#' https://github.com/hadley/ggplot2/blob/master/R/geom-violin.r
#' @examples:
#' ggplot(diamonds, aes(cut, carat)) +
#'   geom_flat_violin() +
#'   coord_flip()
#' @import ggplot2
geom_flat_violin <- function(mapping = NULL, data = NULL, stat = "ydensity",
                             position = "dodge", trim = TRUE, scale = "area",
                             show.legend = NA, inherit.aes = TRUE, ...) {
  layer(
    data = data,
    mapping = mapping,
    stat = stat,
    geom = GeomFlatViolin,
    position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = list(
      trim = trim,
      scale = scale,
      ...
    )
  )
}

#' @rdname ggplot2-ggproto
#' @format NULL
#' @usage NULL
#' @export
GeomFlatViolin <-
  ggproto("GeomFlatViolin", Geom,
          setup_data = function(data, params) {
            data$width <- data$width %||%
              params$width %||% (resolution(data$x, FALSE) * 0.9)

            # ymin, ymax, xmin, and xmax define the bounding rectangle for each group
            data %>%
              group_by(group) %>%
              mutate(ymin = min(y),
                     ymax = max(y),
                     xmin = x,
                     xmax = x + width / 2)

          },

          draw_group = function(data, panel_scales, coord) {
            # Find the points for the line to go all the way around
            data <- transform(data, xminv = x,
                              xmaxv = x + violinwidth * (xmax - x))

            # Make sure it's sorted properly to draw the outline
            newdata <- rbind(plyr::arrange(transform(data, x = xminv), y),
                             plyr::arrange(transform(data, x = xmaxv), -y))

            # Close the polygon: set first and last point the same
            # Needed for coord_polar and such
            newdata <- rbind(newdata, newdata[1,])

            ggplot2:::ggname("geom_flat_violin", GeomPolygon$draw_panel(newdata, panel_scales, coord))
          },

          draw_key = draw_key_polygon,

          default_aes = aes(weight = 1, colour = "grey20", fill = "white", size = 0.5,
                            alpha = NA, linetype = "solid"),

          required_aes = c("x", "y")
  )


"%||%" <- function(a, b) {
  if (!is.null(a)) a else b
}
###########################################################
```



```{r}
# plotting function
plotter <- function(data, x , y, z, xlabel, ylabel, title){
  
  library(tidyverse)
  library(ggthemes)
  library(gghalves)
  library(ggalt)  
  library(ggrepel)  # for annotations
  library(viridis)  # for nice colors
  library(broom)  # for cleaning up models
  library(treemapify)  # for making area graphs
  library(wesanderson)  # for nice colors
  
  ggplot(data = data, mapping = aes(x = reorder({{x}}, {{y}}, median_n), 
  y = {{y}}, fill = {{z}})) + 
  geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8, aes(fill = {{z}})) +
  geom_half_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) + 
    geom_point(position = position_jitter(width = 0.15), size = 1, alpha = 0.1) + 
    scale_y_log10() + labs(y = ylabel, x = xlabel, 
  title = title) + 
  theme_niwot() + 
  theme(legend.position = "none") + 
  stat_summary(fun = mean, geom = "point", 
                size = 1, color = "red")}

##################################################
second_plotter <- function(data, x , y, z, xlabel, ylabel, title){

library(ggalt)  
library(ggrepel)  # for annotations
library(viridis)  # for nice colours
library(broom)  # for cleaning up models
# devtools::install_github("wilkox/treemapify")
library(treemapify)  # for making area graphs
library(wesanderson)  # for nice colours

  ggplot(data = data, 
           mapping = aes(x = reorder({{x}}, {{y}}, median_n), y = {{y}}, fill = {{z}})) +
    
    # The half violins
    geom_flat_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) +
    
    # The points
    geom_point(aes(y = {{y}}, color = {{x}}), 
    
    position = position_jitter(width = 0.15), size = 1, alpha = 0.1) +
    
    # The boxplots
    geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8) +
    
    # \n adds a new line which creates some space between the axis and axis title
    labs(x = xlabel, y = ylabel, title = title) +
    
    # Removing legends
    guides(fill = FALSE, color = FALSE) +
    
    # Setting the limits of the y axis
    #scale_y_continuous(limits = c(0, 1.2)) +
    
    # Picking nicer colours
    scale_fill_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    scale_colour_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    theme_niwot() + scale_y_log10()
}
```


\blandscape

```{r, fig.cap="Correlation between Independent Variables", fig.width = 8, fig.height = 5}
my_data %>% 
  
  dplyr::select(where(is.numeric)) %>% 
  
  dplyr::select(-mfiid, -year, -dummy, -count, -education, -prbonds, -donations, -donations_assets_ratio) %>% 
  
  GGally::ggpairs(columnLabels = c("%Female", "OSS", "Assets", "KKM", "pcrdbgdp", "stmktcap", "GDP_Growth"))
```


\elandscape



\blandscape

```{r, fig.width = 8, fig.height = 5, fig.cap = "Financial and Social Performance of MFIs by Size, Governance and Capital Mrkets Development"}
(second_plotter(data = my_data, x = fct_reorder(finsoc, assets, median), y = assets, z = finsoc, xlabel = "Financial and Social Performance", ylabel = "Assets (size of MFI)", title = "Size and Perfomance of MFIs in Africa") +

second_plotter(data = my_data, x = fct_reorder(finsoc, kkm, median), y = kkm, z = finsoc, xlabel = "Financial and Social Performance", ylabel = "Governance (Institutional Quality)", title = "Perfomance of MFIs and Governance")) / 
  
(second_plotter(data = my_data, x = fct_reorder(finsoc, pcrdbgdp, median), y = pcrdbgdp, z = finsoc, xlabel = "Financial and Social Performance", ylabel = "Private Credit to GDP", title = "Perfomance of MFIs and Private Credit to GDP") + 
   
second_plotter(data = my_data, x = fct_reorder(finsoc, stmktcap, median), y = stmktcap, z = finsoc, xlabel = "Financial and Social Performance", ylabel = "Stock Market Development", title = "Perfomance of MFIs and Stock Market Development"))

```
\elandscape




\blandscape
```{r}
## Distribution of the independent variable
options(scipen=999)

my_data %>% 
  
  dplyr::select(where(is.numeric), -mfiid, -year, -dummy, -count, -education, -prbonds) %>% 
  
  skim_without_charts() %>% 
  
  select(-n_missing, -complete_rate, -skim_type) %>% 
  
  rename(Variable = skim_variable, Mean = numeric.mean, 
         
         SD = numeric.sd, Min = numeric.p0, Q1 = numeric.p25,
         
         Median = numeric.p50, Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  kableExtra::kbl(., caption = "Summary statistics for continous numeric variables", 
      
  booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Authors' construction from MIX data",
           
  general_title = "Source: ")
```

\elandscape

### Results of the Regression Model
The results of the regression model are in Tables 8 through 10. Given that we have an unbalanced dataset, we run the regressions separately for the entire data (Table 6.8), for MFIs with three or more years of data (Table 6.9), and those with 5 or more years of data (Table 6.10). Overall, the significant drivers of achieving the dual objectives are age, size, stock market capitalization to GDP, private credit to GDP, institutional quality, legal tradition, and MFI legal status. The GDP growth rate is not a significant driver of the extent which MFIs meet both financial and social objectives. The latter two regressions form a robustness check. We discuss each of the variables basing them on Table 6.8 but referring to Tables 9 and 10 for comparison. 

#### Age
\noindent Age is a categorical variable. New MFIs (that have existed for 0 - 4 years) are the base outcome. The results show that relative to new MFIs, young MFIs (4 -8 years) are less likely to succeed financially and fail socially than failing in both objectives. Put another way; young MFIs are more likely to experience both financial and social failure than they are to succeed financially and fail socially relative to new MFIs. Similarly, compared to new MFIs, young MFIs are less likely to fail financially and succeed in meeting their social goals than failing to meet the twin objectives. However, young MFIs are more likely than new MFIs to meet their financial and social goals than to fail in the dual mission. The results imply that young MFIs are more prone to financial and social failure than new MFIs. In other words, compared to new MFIs, young MFIs are more likely to fail to achieve both financial and social goals than they are to achieve social goals and to fail financially and vice versa, and succeeding both financially and socially. However, these relationships are not significant. Age is important given that newer MFIs have fewer resources and hence more reliant on donations which are also uncertain [@armendariz2013subsidy; @d2013unsubsidized]. Also, newer smaller firms have difficulties accessing finance [@beck2008finance]. Thus, age makes newer MFIs more prone to financial and social failure and more prone to mission drift than established MFIs [@d2017ngos]. 

```{r}
prop.table(table(my_data$age, my_data$finsoc), 1) %>% 
  
  kableExtra::kbl(., caption = "MFI Age and Achievement of Dual Objectives", 
      
  booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE) %>% 
  
  footnote(general = "Authors' construction from MIX data",
           
  general_title = "Source: ")
```


On the other hand, the results show that relative to new MFIs, mature MFIs are significantly less likely to succeed financially and fail socially than fail to meet the dual objectives. Similarly, mature MFIs are considerably less likely than new MFIs to fail financially while meeting their social goals than they are to meet both their goals. Both these results are significant. Also, the regression results show that relative to new MFIs, mature MFIs are less likely to meet the dual objectives than they are to fail in their twin mission. The latter result is not significant. These results illustrate that mature MFIs are more prone to failing in their twin mission than new MFIs. The results imply that as MFIs mature, they are less prone to mission drift. The observation holds, given that in the regression, older MFIs are more likely to fail to achieve both financial and social objectives than succeed in one and fail in the other or succeed in both financial and social goals, compared to new MFIs.

Indeed, Table 6.6 shows a higher proportion of mature MFIs fail to attain both objectives compared to new and young MFIs. although the difference is marginal. Likewise, a higher proportion of mature MFIs tend to succeed financially while failing socially, although, in the regression, the result is not significant. Financial success coupled with social failure implies mission drift and is detrimental to financial inclusion. Hence, these results suggest that mature MFIs are more prone to mission drift when they convert to the commercial model. Lastly, although the result is not significant in the regression, the Table 6.shows that mature MFIs that succeed financially also tend to succeed socially than do younger MFIs. ^[Note that the interpretation of Table 6.6 differs from the interpretation of the regression. The regression examines the relative likelihood. For instance, how likely are mature MFIs, as compared to new MFIs, to succeed in both objectives than fail in both objectives. The Table 6.gives absolute values.]

As noted, the results imply that mature MFIs are less prone to mission drift where success in one dimension (say, financial) accompanies failure in the other dimension (say social), and vice versa. However, when mature MFIs succeed financially, they also tend to fare equally well socially. The result could suggest that mature MFIs have a more extensive asset base to draw from, making them able to reach out to the financially excluded with less dependence on donations and subsidies. The larger asset base also means that larger MFIs have established their presence through marketing campaigns and technology such that they have a more extensive client base in diverse geographic locations [@jia2016commercialization]. In this case, it is much easier for mature MFIs to attain their social goals, given their greater market share that would allow them to operate even in remote areas with or without donors and state support. Newer MFIs on the other hand, have to legitimize their activities by ensuring that they meet their social goals. Hence, even though mature MFIs receive more donations on aggregate, the relative share of donations is lower than that of newer MFIs.   

#### Size
As noted, age and size move together. Mature MFIs have more assets on average than younger MFIs. The regression output shows that larger MFIs are significantly more likely to succeed financially while failing socially than they are to fail in both objectives. Specifically, suppose the asset base (the proxy for size) of an MFI rises by one unit. In that case, the MFI is 1.241102 times more likely to fall into the group that succeeds financially and fails socially than to be in the group that fails to meet the dual objectives. 

On the contrary, larger MFIs are marginally less likely to fail in meeting their financial goals while succeeding socially. Again, a unit increase in size results in 0.9685066 likelihood of falling into the group of MFIs that fail financially while succeeding socially. With the odds almost equal to one, it appears size is not as crucial in determining whether an MFI fails financially and succeeds socially. Indeed, this outcome is not statistically significant. However, larger MFIs are significantly more likely to meet their dual goals than to fail in both. In this case, a unit increase in MFI size corresponds to 1.192438 odds of achieving both objectives relative to failing in both goals ^[We exponentiate the coefficients to get the odds. Odds greater than one indicate greater likelihood. Odds less than one indicate less likelihood, while one indicates equal likelihood.]. 

The results highlight that size is a critical ingredient in determining whether or not MFIs meet their dual objectives. Larger MFIs have a greater likelihood of achieving both objectives and meeting their financial goals while failing socially. This means that while the size of an MFI is a crucial factor in meeting social goals, it is a factor of greater importance in meeting financial objectives. The results also imply that larger MFIs that meet their financial objectives are in a better position to also meet their social goals. Hence, meeting financial goals is a prerequisite for meeting social goals for larger MFIs relative to smaller, younger MFIs. Larger MFIs use their asset base to generate financial resources that they use to expand outreach to the financially excluded, consistent with the "mission expansion" view [@mersland2010microfinance]. For relatively small MFIs, donations and subsidies form a higher proportion of assets and hence are not as reliant on making financial returns to fund their operations.

#### Capital markets development
This section covers both the stock market development and the debt market development. The regression shows that across all classes, MFIs located in countries with better stock market development are less likely to meet the dual objectives than failing in both goals. Going by the coefficients, a unit increase in stock market capitalisation results in `r exp(-0.147)` times as likely to meet the twin objectives than to fail in both. Similarly, MFIs located in these countries are less likely to meet their financial goals and fail socially. In this case, a unit increase in stock market development corresponds with a `r exp(-0.154)` odds of being in the category of MFIs that succeed financially while failing socially than in the class that fails to meet both objectives. Likewise, higher stock market development connotes a higher probability of an MFI succeeding financially while failing in their social mandate than failing in both goals. Here, a unit increase in stock market capitalisation corresponds to `r exp(-0.195)` odds. 

Debt market development, whose proxy is the ratio of private credit to GDP follows a similar pattern. A higher level of debt market development corresponds to higher odds of succeeding financially while failing socially instead of failing in both objectives. The result is not significant, though. However, a higher level of debt market development lowers the odds of an MFI failing financially and succeeding socially. Also, higher debt market development reduces the odds of an MFI succeeding in both objectives versus failing in both. The corresponding odds are `r exp(-0.254)` and `r exp(-0.147)`, respectively. 

Indeed in countries where stock markets are well-developed, the mainstream financial system, including the debt market, is also likely well established, meaning that people can easily access finance. Research shows that a well developed debt market is a precursor to developing a stock market [@nguyen2012determinants; @tsaurai2018determinants]. Under these conditions, the demand for microfinance is low, meaning that it is hard for MFIs to realise their objectives. The few MFIs that exist in these conditions are more likely to serve a small, underprivileged class, meaning that the possibility of achieving their financial goals are minimal. They, however, almost always meet their social goals. 

#### Governance/ Institutional quality (KKM)
Institutional quality goes together with better financial sector development [@allen2014african]. The regressions results show that a unit increase in institutional quality corresponds with higher odds of succeeding financially while failing socially. The odds are `r exp(0.115)`. With odds of `r exp(-0.08)`, when institutional quality goes up by a unit, there is a lower chance of an MFI failing financially and succeeding socially than failing in both goals. These two results are statistically significant. Finally, a unit increase in institutional quality lowers the chances of an MFI meeting both objectives compared to failing in both objectives with  odd of `r exp(0.03)`. The result is, however, insignificant. As is the case for financial sector development, the populace in countries with better quality institutions is more likely to have access to the mainstream financial system, making social goals harder for MFIs given the low demand for microfinance [@butkiewicz2006institutional]. Given a low demand for microfinance, it is also harder for MFIs to succeed financially. 

#### Legal Tradition
The common law legal tradition is the base outcome for this variable. The results show that, relative to MFIs in common law countries, MFIs in civil law countries are less likely to succeed financially while failing socially than fail in both objectives. The odds are `r exp(-1.290)`. Similarly, MFIs in civil law countries are less likely than MFIs in common law countries to fail financially while succeeding socially than they are to fail in both objectives with an odds of `r exp(-0.952)`. Also, MFIs operating in civil law countries are less likely than those in common law countries to succeed in both objectives than to fail in both objectives. The odds are `r exp(-1.21)`. The odds are strikingly low, showing the high likelihood of MFIs in civil law countries to fail in both financial and social goals compared to those in common law countries. 

For MFIs in other legal traditions (neither common law nor civil law), the results are similar to those for civil law countries. The odds are lower (at `r exp(-1)`) that an MFI in a country with other legal traditions, compared to common law countries, will succeed financially and fail socially instead of failing in both objectives. The odds for failing financially while succeeding socially and succeeding in both goals are `r exp(-0.628)` and `r exp(-0.93)`, respectively. Table 6.7 confirms that indeed, MFIs in civil law countries and other legal traditions are more likely to fail to meet both objectives than those in common law countries. Also, MFIs in common law countries have the highest instance of succeeding socially. Civil law and other legal tradition countries have a lower capital markets development level than common law countries [@schnyder2018twenty; @kaidi2019financial]. 

Consequently, we would expect that MFIs find it easier to meet social goals in civil law countries. These results could point to poor reception of financial services in these countries [@la2013law]. Additionally, lack of a supportive legal framework, inadequate financial and physical infrastructure could also make it difficult for MFIs to meet their social mandate even when the demand for microfinance is potentially high.


```{r}
prop.table(table(my_data$legal_tradition, my_data$finsoc), 1) %>% 
  
  kableExtra::kbl(., caption = "Legal Traditions and Achievement of Dual Objectives", 
      
  booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE) %>% 
  
  footnote(general = "Authors' construction from MIX data",
           
  general_title = "Source: ")
```


#### MFI legal status
For legal status, the NGO model is the base outcome. Compared to NGOs, commercial banks are more likely to succeed financially while failing socially than they are to fail in both objectives. The results show that microfinance's commercial banking model is likely to put profits before outreach to the financially excluded. Similarly, commercial banks are less likely than NGOs to fail financially while succeeding socially than failing in both objectives. The result may highlight that for commercial banks to succeed socially, they have to be financially self-sustainable, without which they tend to fail in both objectives. Likewise, relative to NGOs, commercial banks are less likely to achieve both financial and social goals than fail in both goals. Again this shows the importance of financial success in determining the attainment of social objectives by commercial banks compared to NGOs. 

The other MFI legal forms, that is, NBFIs, cooperatives, and rural banks show a pattern similar to that of commercial banks. Overall, the results confirm the results of exploratory data analysis that show that NGOs are less prone to social failure than the commercial forms of MFIs [@jia2016commercialization; @mia2017mission]. The result confirms the welfare school's concerns that the transformation of MFIs is likely to cause mission drift [@d2017ngos]. Also, it implies that for commercial MFIs to prioritize social goals, they should first realize financial success which may be hard to come by unless with some form of support from the state and donors, at least in the initial stages of transformation. 


\newpage

```{r, results = 'hide'}
full <- my_data %>% multinom(finsoc ~ age + assets + stmktcap + + pcrdbgdp + kkm + gdp_growth_annual + legal_tradition + currentlegalstatus + factor(year), data = .) 

full3 <- my_data %>% group_by(mfiid) %>% filter(n() >= 3) %>% multinom(finsoc ~ age + assets + stmktcap + pcrdbgdp + kkm + gdp_growth_annual + legal_tradition + currentlegalstatus + factor(year), data = .)

full5 <- my_data %>% group_by(mfiid) %>% filter(n() >= 5) %>% multinom(finsoc ~ age + assets + stmktcap + pcrdbgdp + kkm + gdp_growth_annual + legal_tradition + currentlegalstatus + factor(year), data = .) 
```



```{r, results = "asis"}
stargazer(full, title = "Regression Results - Multinomial Logit Model- Full Data", font.size = "footnotesize", header = FALSE, omit = "^factor.", add.lines = list(c("Year Effects", "Yes", "Yes", "Yes"), c("Data", "Full", "Full", "Full")))
```


\newpage
```{r, results = "asis"}
stargazer(full3, title = "Regression Results - Multinomial Logit Model- At Least 3 Years of Data", font.size = "footnotesize", header = FALSE, omit = "^factor.", add.lines = list(c("Year Effects", "Yes", "Yes", "Yes"), c("Data", "At Least 3 Years", "At Least 3 Years", "At Least 3 Years")))
```


\newpage

```{r, results = 'asis'}
stargazer(full5, title = "Regression Results - Multinomial Logit Model, at Least 5 Years of Data", font.size = "footnotesize", header = FALSE, omit = "^factor.", add.lines = list(c("Year Effects", "Yes", "Yes", "Yes"), c("Data", ">at Least 5 Years", "at Least 5 Years", "at Least 5 Years")))
```



\newpage

### Overall Model Fit: Confusion Matrix
This section uses the regression model in Table 6.8 to generate a confusion matrix that shows how well the model predicts that an MFI will fall into one of the four financial vis-a-vis social performance classes. The results are in Table 6.11 and Table 6.12. In Table 6.11, while the model has low accuracy and sensitivity, it has a substantial specificity of about 80%. The results mean that the model can accurately predict that an MFI will not fall into a given category given that it does not fall into that category. However, the model is not significantly more accurate than guessing the most likely outcome. In this case, an MFI succeeds financially and socially, with an accuracy of 46.9% against a no-information rate of 52.9%. Table 6.12 shows that, for instance, the model accurately predicts that 141 MFIs would fail in attaining both financial and social goals. However, `r 141+242+99+224` fail to meet both objectives ^[This Figure 6.is the sum of the first row.]. This presents a poor prediction accuracy of  19.97%. However, the model does well to predict MFIs that succeed in both objectives, getting it right 1202 instances. In this case, the overall accuracy is high at 70%. The second (SF) and third categories (FS) accuracy are 41% and 34.8%, respectively. The model quickly picks out MFIs that succeed in both objectives better than it does the other categories. 

```{r}
multinom_predict <- predict(full)

conf_matrix <- confusionMatrix(my_data$finsoc, multinom_predict) 

######## MFI classes
mfis <- c("FF", "SF", "FS", "FF")

####### Metrics
Accuracy <- c(rep(0.469, 4))

NoInformationRate <- rep(0.529, 4)

Kappa <- rep(0.243 , 4)

sensitivity <- c(0.4040, 0.466, 0.4859, 0.475)

specificity <- c(0.8725, 0.806, 0.8130, 0.772)

PosPredValue <- c(0.1997, 0.414, 0.3480, 0.700)

NegPredValue <- c(0.9490, 0.837, 0.8850, 0.566)

Prevalence <- c(0.0730, 0.227, 0.1704, 0.529)

DetectionRate <- c(0.0295, 0.106, 0.0828, 0.251)

DetectionPrevalence <- c(0.1476, 0.256, 0.2380, 0.359)

BalancedAccuracy <- c(0.6383, 0.636, 0.6494, 0.623)
 
#####df
df <- rbind(Accuracy, NoInformationRate, Kappa, sensitivity, specificity, PosPredValue, NegPredValue, Prevalence, DetectionRate, DetectionPrevalence, BalancedAccuracy) %>% 
  
  data.frame()

names(df) <- mfis

df %>% 
  
  kableExtra::kbl(., caption = "Confusion Matrix and Statistics for the Multinomial Logit Model", 
      
  booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE) %>% 
  
  footnote(general = "Authors' construction",
           
  general_title = "Source: ",
  
  number = "Accuracy > NoInformationRate is significant at 1% confidence level, p = 0.0000",
  
  number_title = "Notes: ")
```




```{r}
conf_matrix$table %>% 
  
  kableExtra::kbl(., caption = "Confusion Matrix Table for the Multinomial Logit Model", 
      
  booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE) %>% 
  
  footnote(general = "Authors' construction",
           
  general_title = "Source: ")
```




### Regression Diagnostics
In this section, we do robustness checks on the regression for extreme values, multicollinearity and linearity. Note that we base the checks on the model in Table 6.8 that utilize the entire dataset.

#### Extreme Values
In the regression model, we winsorize the data by removing the top and bottom 10% and re-run the analysis. The results of the regression are in Table 6.13 below. Extreme values do not affect the results do not change except for the expected changes in the coefficients.

```{r, echo = FALSE, warning = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
######################################
remove_outliers <- function(x, na.rm = TRUE, ...) {
  qnt <- quantile(x, probs=c(.10, .90), na.rm = na.rm, ...)
  H <- 1.5 * IQR(x, na.rm = na.rm)
  y <- x
  y[x < (qnt[1] - H)] <- NA
  y[x > (qnt[2] + H)] <- NA
  y
}

### add mfiid, year, age, legal tradition, current legal status & finsoc
multinom_wins <- my_data %>% select(assets, stmktcap, pcrdbgdp, kkm, gdp_growth_annual, year)

#######################################
multinom_wins <- sapply(multinom_wins, remove_outliers) %>% 
  
  cbind(my_data %>% select(mfiid, year, finsoc, age, legal_tradition, currentlegalstatus)) %>% 
  
  relocate(mfiid:currentlegalstatus)

#########################################
## Regression
full_wins <- multinom_wins %>% multinom(finsoc ~ age + assets + stmktcap + pcrdbgdp + kkm + gdp_growth_annual + legal_tradition + currentlegalstatus + factor(year), data = .) 

```




```{r, results = 'asis'}
stargazer(full_wins, title = "Regression Results - Multinomial Logit Model, Winsorized Data", font.size = "footnotesize", header = FALSE, omit = "^factor.", add.lines = list(c("Year Effects", "Yes", "Yes", "Yes"), c("Data", "Full Data", "Full Data", "Full Data")))
```



#### multicollinearity
This section checks for multi-collinearity among the independent variables by generating the variance inflation factors (VIFs). In this case, the mainstream variables do not have exceptional variance inflation. The VIFs are in Table 6.14. However, the inclusion of year effects is vital in the regressions, given their panel structure. 



```{r}
car::vif(my_data %>% glm(dummy ~ age + assets + stmktcap + + pcrdbgdp + kkm + gdp_growth_annual + legal_tradition + currentlegalstatus + factor(year), data = .) ) %>% 
  
  knitr::kable(., caption = "Variance Inflation Factors for Logit Model", 
      
      booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE) %>% 
  
  footnote(general = "Authors' construction",
           
           general_title = "Source: ")
```



### Conclusion

This article examines the extent to which MFIs in Africa achieve their dual objectives - financial and social goals. Although most MFIs tend to succeed financially and socially, a substantial number also fails in both goals. In between, there is an even split between MFIs that achieve one objective and fail in the other. The factors that drive the extent to which MFIs achieve joint financial and social goals include age, size, legal status of the MFI, and country-level indicators like stock market capitalisation and institutional quality. However, rural banks and NGOs are more likely to achieve the dual objectives than banks, NBFIs and credit unions. Thus, the commercial model of microfinance could be more prone to mission drift than NGOs. Also, commercial microfinance MFIs that succeed socially tend to have a degree of financial success. For age, older, more established MFIs tend to appear less prone to mission drift than the relatively younger MFIs, which again underlines the need to support young MFIs in the early stages of transformation. Size shows a similar result, with larger MFIs being less prone to mission drift. The implication is that MFIs need financial support to allow them attain financial sustainability in the early stages of transformation while also fulfilling their social obligations. The country-level drivers of attaining financial and social objectives are capital markets development, institutional quality and legal tradition. MFIs in countries with better institutions and capital markets see lower demand for microfinance, thus suppressing both financial and social goals. However, MFIs in countries following civil law and other legal traditions are likely to fail in both financial and social goals relative to those in common law countries. These results remain robust after removing extreme values and other checks.


\blandscape

```{r, fig.cap = "Size and Age of Microfinance Institutions in Africa"}
#table(my_data$age, my_data$assets)

(second_plotter(data = my_data, x = fct_reorder(age, assets, median), y = assets, z = age, xlabel = "Age", ylabel = "Assets (size of MFI)", title = "Age and Size of MFIs in Africa"))/

(second_plotter(data = my_data, x = currentlegalstatus, y = percent_of_female_borrowers, z = currentlegalstatus, title = "Percent of Female Borrowers by MFI Legal Status", xlabel = "Current Legal Status", ylabel = "Percent of Female Borrowers") +

#### Operational Self-sufficiency of MFIs in Africa
second_plotter(data = my_data, x = currentlegalstatus, y = operational_self_sufficiency, z = currentlegalstatus, title = "Operational Self-sufficiency by MFIs Legal Status", xlabel = "Current Legal Status", ylabel = "Operational Self-sufficiency of MFIs in Africa"))

```

\elandscape



\newpage

```{r, results = "asis", eval = FALSE}
library(gmnl)
library(mlogit)

ddd <- my_data %>% 
  
  select(mfiid, finsoc, age, assets, stmktcap, pcrdbgdp, kkm, gdp_growth_annual, legal_tradition, currentlegalstatus, year) %>% 
  
  mutate(year = factor(year))

long.data <- mlogit.data(ddd, choice = "finsoc", shape = "wide")
long.data

my_model <- mlogit(finsoc ~ 1| age + assets + stmktcap + pcrdbgdp + kkm + gdp_growth_annual + legal_tradition + 
                     
                     currentlegalstatus + year, data = long.data, reflevel = "FF" )

stargazer(my_model, title = "Regression Results - Multinomial Logit Model- Full Data", 
          font.size = "footnotesize", header = FALSE, omit = "year.")
```

<!--chapter:end:06-dual_obj.Rmd-->

---
#########################################
# options for knitting a single chapter #
#########################################
output:
  bookdown::pdf_document2:
    template: templates/brief_template.tex
    citation_package: biblatex
  bookdown::html_document2: default
  bookdown::word_document2: default
documentclass: book
bibliography: references.bib
always_allow_html: true
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
- \usepackage[default]{sourcesanspro}
- \usepackage[T1]{fontenc}
- \usepackage{amsmath}
- \usepackage{dcolumn}
- \usepackage{url}
- \DeclareUnicodeCharacter{200E}{ }
- \usepackage[utf8x]{inputenc}
---

# Sources of Finance for Microfinance Institutions in Africa {#Introduction}
\minitoc <!-- this will include a mini Table 6. 5.of contents-->
\chaptermark{Financing MFIs in Africa}

<!-- LaTeX normally does not indent the first line after a heading - however, it does so after the mini Table 6. 5.of contents. You can manually tell it not to with \noindent -->


```{r, echo = FALSE, message = FALSE, warning = FALSE}

library("pacman")
library("bookdown") 
library("broom") 
library("car") 
library("caret") 
library("corrplot") 
library("dtplyr")
library("excelR") 
library("GGally") 
library("ggalt") 
library("ggeasy") 
library("gghalves") 
library("ggrepel")  
library("ggthemes") 
library("gmnl") 
library("gmodels") 
library("gplots") 
library("gridExtra") 
library("gtable")
library("here") 
library("janitor") 
library("kableExtra") 
library("knitr") 
library("lme4") 
library("lmtest")
library("magrittr") 
library("margins") 
library("mice") 
library("nnet") 
library("pacman") 
library("patchwork") 
library("pcse")
library("pglm") 
library("plm") 
library("prettydoc") 
library("pROC") 
library("psych") 
library("Rchoice") 
library("rDEA")
library("readxl")
library("rmarkdown") 
library("skimr") 
library("stargazer") 
library("tidymodels") 
library("tidyverse")
library("treemapify") 
library("viridis") 
library("wesanderson") 
library("zoo")

#########################################
options(digits = 3)
options(scipen=999)
options(knitr.kable.NA = "-")
theme_set(ggthemes::theme_clean())
#########################################
```

\newpage 

\begin{center}

\textbf{ABSTRACT}

\end{center}

> We examine the sources of finance for MFIs in Africa and their associated drivers. The sources of finance are leverage (debt-equity ratio), equity (capital to assets ratio), deposits (deposits to assets ratio), and donations (donations to assets ratio). Our analysis shows that at the firm level, size, age, legal status, and profitability drive financing alternatives, in line with theory. For example, asset structure varies inversely with leverage. At the country-level, institutional quality (KKM) varies inversely with deposits and donations. Intersstingly, coefficients of financial development are not statistically significant across all financial structure proxies, going against stylised facts on the macro-level drivers of firms' financing structure. Furthermore, we find that firm-level factors are more relevant in determining the financing structure of MFIs that country-level structures.

\vspace{10mm}

**Key Words**: Finance, Capital, leverage, Donations, Debt, Deposits, Microfinance, Africa.

\vspace{5mm}
**JEL Classification**: G210, G230

\newpage

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## legal traditions 
### Common law countries in Africa
common <- tibble(country = c("Botswana", "Gambia, The", "Ghana", "Kenya", "Lesotho", "Liberia", "Malawi", "Namibia", "Nigeria", "Sierra Leone", "South Africa", "South Sudan", "Sudan", "Eswatini", "Tanzania", "Uganda", "Zambia", "Zimbabwe"), trad = c(rep("common", 18)))

### Civil law countries in Africa
civil <- tibble(country = c("Algeria", "Benin", "Burkina Faso", "Cameroon", "Central African Republic", "Chad", "Comoros", "Congo, Rep.", "Cote d'Ivoire", "Gabon", "Guinea", "Madagascar", "Mali", "Mauritania", "Morocco", "Niger", "Senegal", "Togo", "Tunisia"), trad = c(rep("civil", 19)))

### Other legal traditions in Africa
others <- tibble(country = c("Equatorial Guinea", "Angola", "Burundi", "Cape Verde", "Congo, Dem. Rep.", "Egypt, Arab Republic of", "Ethiopia", "Eritrea", "Guinea-Bissau", "Mozambique", "Rwanda"), trad = c(rep("others", 11)))

###Putting them all together
legal <- rbind(common, civil, others)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Bond market data - private and public bond market capitalization to GDP
bonds <- read_excel("bonds_oluoch.xlsx") %>% 
  
  janitor::clean_names()

```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Add the financial development index to the dataset
## Countries not part of Africa
mideast <- c("Bahrain", "Iran, Islamic Rep.", "Iraq", "Israel", "Jordan", "Kuwait", "Lebanon", "Malta", "Oman", "Qatar", "Saudi Arabia", "Syrian Arab Republic", "United Arab Emirates", "West Bank and Gaza", "Yemen, Rep.")

## Load the financial structure data
finstr <- read_excel("FinancialStructureDatabase20191018.xlsx", sheet = 4) %>% 
  
  ## Select desired variables
  select(country, region, year, pcrdbgdp, stmktcap, stvaltraded, stturnover, listco_pc) %>% 
  
  ### Filter out regions not in Africa or middle east
  filter(region == "Sub-Saharan Africa" | region == "Middle East & North Africa") %>% 
  ### Filter out countries in middle east and select year 1999 onwards
  filter(!country %in% mideast, year >= 1999) %>% 
  
## Replace NAs
          group_by(country) %>% 
  
          mutate(pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
                 
                 pcrdbgdp = replace_na(pcrdbgdp, 0),
                 
                 stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE)),
                 
                 stmktcap = replace_na(stmktcap, 0)) %>% ungroup() %>% 
  
## Join with the bonds data
  left_join(bonds, by = c("country", "year")) %>% 
  
## rename bonds columns 
  rename(prbonds = outstanding_t_bonds_percent_gdp, 
         
         pubonds = outstanding_c_bonds_percent_gdp) %>% 
  
  ## Replace NAs in public bond and private bond markets 
  mutate(pubonds = replace_na(pubonds, 0), 
         
         prbonds = replace_na(prbonds, 0)) %>% 
  
         ## Rename Ivory Coast
         mutate(country = if_else(country == "Côte d'Ivoire", "Cote d'Ivoire", 
                                  
                                  country))

## View missing data points
#mice::md.pattern(finstr)

#finstr %>% select(pcrdbgdp, stmktcap) %>% cor(.) %>% 
  
  #corrplot(method = "number", type = "lower")
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Read in the dataset 
my_data <- read_csv("amelia.csv") %>% 

## Region
mutate(region = if_else(region == "Middle East and North Africa", 
                        
                        "North_Africa", region)) %>% 

# Clean the names 
janitor::clean_names() %>% 
  
# Set up factor variables 
## legal status 
mutate(currentlegalstatus = factor(currentlegalstatus, 
                           levels = c("NGO", "Bank", "NBFI", 
                            "Credit Union/ Cooperative", 
                            "Rural Bank")), 
      ## Age
      age = factor(age, levels = c("New", "Young", "Mature")),
       
      ## Region 
      region = factor(region, levels = c("North_Africa", "Africa"))) %>% 
  
      ## Add the financial structure data     
      left_join(finstr, by = c("country", "year")) %>% 
  
      ## Add a binary variable for the legal dummy- NGO vs Others
      mutate(currentlegaldummy = case_when(currentlegalstatus == "NGO" ~ "NGO",
                                           
                                           TRUE ~ "others"),
      
        currentlegaldummy = factor(currentlegaldummy, levels = c("NGO", "others")),
        
        legal_tradition = factor(legal_tradition, 
                                 
                                 levels = c("Common", "Civil", "Other"))
        
        ) %>% 
  ## Select required variables 
  select(mfiid, mfiname, year, country, currentlegaldummy, currentlegalstatus, 
         
         percent_of_female_borrowers, operational_self_sufficiency,
         
         age, legal_tradition, region.x, asset_structure, 
         
         assets, kkm, education, pcrdbgdp, stmktcap, prbonds, 
         
         gdp_growth_annual, donations, donations_assets_ratio, 
         
         profit_margin, capital_asset_ratio,
         
         debt_to_equity_ratio, operating_expense_assets, 
         
         average_loan_balance_per_borrower, gross_loan_portfolio_to_total_assets, 
         
         deposits_to_total_assets, liabilities_and_equity) %>% 
  
          ## Rename region
         rename(region = region.x) %>% 
  
  group_by(country) %>% 
  
  mutate(kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         education = replace_na(education, median(education, na.rm = TRUE)),
         prbonds = replace_na(prbonds, median(prbonds, na.rm = TRUE)),
         pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
         stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(mfiid) %>% 
  
  mutate(asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)), 
         
         percent_of_female_borrowers = replace_na(percent_of_female_borrowers, 
                                                  
                                                  median(percent_of_female_borrowers, na.rm = TRUE)),
         
         operational_self_sufficiency = replace_na(operational_self_sufficiency, 
                                                   
                                                   median(operational_self_sufficiency, na.rm = TRUE)),
         
         assets = replace_na(assets, median(assets, na.rm = TRUE)),
         
         donations = replace_na(donations, median(donations, na.rm = TRUE)),
         
         donations_assets_ratio = replace_na(donations_assets_ratio, 
                                             
                                  median(donations_assets_ratio, na.rm = TRUE)), 
         
         profit_margin = replace_na(profit_margin, median(profit_margin, na.rm = TRUE)),
         
         capital_asset_ratio = replace_na(capital_asset_ratio, median(capital_asset_ratio, na.rm = TRUE)),
         
         debt_to_equity_ratio = replace_na(debt_to_equity_ratio, median(debt_to_equity_ratio, na.rm = TRUE)),
         
         operating_expense_assets = replace_na(operating_expense_assets, median(operating_expense_assets, na.rm = TRUE)),
         
         deposits_to_total_assets = replace_na(deposits_to_total_assets, median(deposits_to_total_assets, na.rm = TRUE)), 
         
average_loan_balance_per_borrower = replace_na(average_loan_balance_per_borrower, median(average_loan_balance_per_borrower, na.rm = TRUE)),
    
liabilities_and_equity = replace_na(liabilities_and_equity, median(liabilities_and_equity, na.rm = TRUE)  
         
         )) %>% 
  
  ungroup() %>% 
  
  group_by(region) %>% 
  
  mutate(education = replace_na(education, median(education, na.rm = TRUE)),
         
         kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         
         gdp_growth_annual = replace_na(gdp_growth_annual, 
                                        
         median(gdp_growth_annual, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(currentlegalstatus) %>% 
  
  mutate(assets = replace_na(assets, median(assets, na.rm = TRUE)), 
         
         percent_of_female_borrowers = replace_na(percent_of_female_borrowers, 
                                                  
                        median(percent_of_female_borrowers, na.rm = TRUE)),
         
         operational_self_sufficiency = replace_na(operational_self_sufficiency, 
                                                   
                        median(operational_self_sufficiency, na.rm = TRUE)),
         
         donations = replace_na(donations, median(donations, na.rm = TRUE)),
         
         donations_assets_ratio = replace_na(donations_assets_ratio, 
                                             
                                  median(donations_assets_ratio, na.rm = TRUE)),
         
         profit_margin = replace_na(profit_margin, median(profit_margin, na.rm = TRUE)),
         
         capital_asset_ratio = replace_na(capital_asset_ratio, median(capital_asset_ratio, na.rm = TRUE)),
         
         asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)),
         
         debt_to_equity_ratio = replace_na(debt_to_equity_ratio, median(debt_to_equity_ratio, na.rm = TRUE)),
         
         operating_expense_assets = replace_na(operating_expense_assets, median(operating_expense_assets, na.rm = TRUE)),
         
average_loan_balance_per_borrower = replace_na(average_loan_balance_per_borrower, median(average_loan_balance_per_borrower, na.rm = TRUE)),
         
         deposits_to_total_assets = replace_na(deposits_to_total_assets, median(deposits_to_total_assets, na.rm = TRUE)), 
         
liabilities_and_equity = replace_na(liabilities_and_equity, median(deposits_to_total_assets, na.rm = TRUE))
         
         ) %>% 
  
  ungroup() %>% 
  
  mutate(dummy = if_else(currentlegaldummy == "NGO", 0, 1)) %>% 
  
  mutate(assets = log(assets + 1),
         
         pcrdbgdp = log(pcrdbgdp + 1),
         
         stmktcap = log(stmktcap + 1),
         
         prbonds = log(prbonds + 1)) %>% 
  
  add_count(mfiid, name = "count") %>% 
  
  mutate(currentlegalstatus = fct_recode(currentlegalstatus, Coop = "Credit Union/ Cooperative")) %>% 
  
  mutate(finsoc = case_when(operational_self_sufficiency >= 1 & percent_of_female_borrowers > 0.5 ~ "SS",
                            
                            operational_self_sufficiency > 1 & percent_of_female_borrowers < 0.5 ~ "SF", 
                            
                            operational_self_sufficiency < 1 & percent_of_female_borrowers >= 0.5 ~ "FS",
                            
                            TRUE ~ "FF")) %>% 
  
mutate(finsoc = factor(finsoc, levels = c("FF", "SF", "FS", "SS"))) %>% 
  
## replace negative donations with zero
mutate(donations = case_when(donations <= 0 ~ 1,
                             TRUE ~ donations))
## Write a csv for the data
my_data %>% write.csv(., "data.csv")

## Visualize missing data
#md.pattern(data)
## Amelia::missmap(data)

## MFIs with three (3) or more years of data
data3 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 3)
  
data3 %>% write.csv(., "data3.csv")

## MFIs with three (3) or more years of data
data5 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 5)  
  
data5 %>% write.csv(., "data5.csv")
```


######################################################################### 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
### Important functions ----
## Regression function - fixed, random and pooling
modelling <- function(data, depvar,
                      effect = c("individual", "twoways", "time", "nested"),
                      model = c("within", "random", "ht", "between", "pooling", "fd"),
                      inst.method = c("bvk", "baltagi", "am", "bms"),
                      random.method = c("swar", "amemiya", "walhus", "nerlove"),
                      digits = 4, index = c("mfiid", "year")){
  
## Load libraries
  library(plm)
  library(broom)
  library(pcse)
  library(car)
  library(zoo)
  library(lmtest)
  library(broom)
  library(stargazer)
  
  ## match arguments
  effect <- match.arg(effect)
  model <- match.arg(model)
  inst.method <- match.arg(inst.method)
  random.method <- match.arg(random.method)
  
  ## Run the Model
  unadjusted <- plm(depvar ~ currentlegalstatus + 
            age + legal_tradition + kkm +
+           asset_structure + pcrdbgdp + stmktcap +
            profit_margin + year, 
          data = data, effect = effect,
          model = model,inst.method = inst.method, 
          index = index, 
          digits = digits)

unadjusted
}
```

########################################################################## 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Hausmann Test function
hausmann_test <- function(data, depvar){
  
  library(plm)
  library(broom)
  library(pcse)
  library(car)
  library(zoo)
  library(lmtest)
  library(broom)
  
  fixed <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin, 
               data = data, effect = "individual", model = "within", 
      index = c("mfiid", "year")) 
  
  random <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin, 
          data = data, effect = "individual", model = "random", 
      index = c("mfiid", "year"))
 
  broom::tidy(phtest(fixed, random))
}

```

############################################ 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Median function
median_n <- function(x){median(x, na.rm = TRUE)}
```

############################################ 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
theme_niwot <- function(){
  theme_bw() +
    theme(axis.text = element_text(size = 7), 
          axis.title.x = element_blank(),
          axis.title.y = element_text(size = 8),
          axis.line.x = element_line(color="black"), 
          axis.line.y = element_line(color="black"),
          panel.border = element_blank(),
          panel.grid.major.x = element_blank(),                                          
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          panel.grid.major.y = element_blank(),  
          plot.margin = unit(c(1, 1, 1, 1), units = , "cm"),
          plot.title = element_text(size = 10, vjust = 1, hjust = 0),
          legend.text = element_text(size = 8),          
          legend.title = element_blank(),                              
          legend.position = c(0.95, 0.15), 
          legend.key = element_blank(),
          legend.background = element_rect(color = "black", 
                                           fill = "transparent", 
                                           size = 2, linetype = "blank"))
}
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
###########################################
#' ggplot Flat Violin
#' @export
#' @details Copy-pasted from https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R
#' somewhat hackish solution to:
#' https://twitter.com/EamonCaddigan/status/646759751242620928
#' based mostly on copy/pasting from ggplot2 geom_violin source:
#' https://github.com/hadley/ggplot2/blob/master/R/geom-violin.r
#' @examples:
#' ggplot(diamonds, aes(cut, carat)) +
#'   geom_flat_violin() +
#'   coord_flip()
#' @import ggplot2
geom_flat_violin <- function(mapping = NULL, data = NULL, stat = "ydensity",
                             position = "dodge", trim = TRUE, scale = "area",
                             show.legend = NA, inherit.aes = TRUE, ...) {
  layer(
    data = data,
    mapping = mapping,
    stat = stat,
    geom = GeomFlatViolin,
    position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = list(
      trim = trim,
      scale = scale,
      ...
    )
  )
}

#' @rdname ggplot2-ggproto
#' @format NULL
#' @usage NULL
#' @export
GeomFlatViolin <-
  ggproto("GeomFlatViolin", Geom,
          setup_data = function(data, params) {
            data$width <- data$width %||%
              params$width %||% (resolution(data$x, FALSE) * 0.9)

            # ymin, ymax, xmin, and xmax define the bounding rectangle for each group
            data %>%
              group_by(group) %>%
              mutate(ymin = min(y),
                     ymax = max(y),
                     xmin = x,
                     xmax = x + width / 2)

          },

          draw_group = function(data, panel_scales, coord) {
            # Find the points for the line to go all the way around
            data <- transform(data, xminv = x,
                              xmaxv = x + violinwidth * (xmax - x))

            # Make sure it's sorted properly to draw the outline
            newdata <- rbind(plyr::arrange(transform(data, x = xminv), y),
                             plyr::arrange(transform(data, x = xmaxv), -y))

            # Close the polygon: set first and last point the same
            # Needed for coord_polar and such
            newdata <- rbind(newdata, newdata[1,])

            ggplot2:::ggname("geom_flat_violin", GeomPolygon$draw_panel(newdata, panel_scales, coord))
          },

          draw_key = draw_key_polygon,

          default_aes = aes(weight = 1, colour = "grey20", fill = "white", size = 0.5,
                            alpha = NA, linetype = "solid"),

          required_aes = c("x", "y")
  )


"%||%" <- function(a, b) {
  if (!is.null(a)) a else b
}
###########################################################
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# plotting function
plotter <- function(data, x , y, z, xlabel, ylabel, title){
  
  library(tidyverse)
  library(ggthemes)
  library(gghalves)
  library(ggalt)  
  library(ggrepel)  # for annotations
  library(viridis)  # for nice colors
  library(broom)  # for cleaning up models
  library(treemapify)  # for making area graphs
  library(wesanderson)  # for nice colors
  
  ggplot(data = data, mapping = aes(x = reorder({{x}}, {{y}}, median_n), 
  y = {{y}}, fill = {{z}})) + 
  geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8, aes(fill = {{z}})) +
  geom_half_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) + 
    geom_point(position = position_jitter(width = 0.15), size = 1, alpha = 0.1) + 
    scale_y_log10() + labs(y = ylabel, x = xlabel, 
  title = title) + 
  theme_niwot() + 
  theme(legend.position = "none") + 
  stat_summary(fun = mean, geom = "point", 
                size = 1, color = "red")}

##################################################
second_plotter <- function(data, x , y, z, xlabel, ylabel, title){

library(ggalt)  
library(ggrepel)  # for annotations
library(viridis)  # for nice colours
library(broom)  # for cleaning up models
# devtools::install_github("wilkox/treemapify")
library(treemapify)  # for making area graphs
library(wesanderson)  # for nice colours

  ggplot(data = data, 
           mapping = aes(x = reorder({{x}}, {{y}}, median_n), y = {{y}}, fill = {{z}})) +
    
    # The half violins
    geom_flat_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) +
    
    # The points
    geom_point(aes(y = {{y}}, color = {{x}}), 
    
    position = position_jitter(width = 0.15), size = 1, alpha = 0.1) +
    
    # The boxplots
    geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8) +
    
    # \n adds a new line which creates some space between the axis and axis title
    labs(x = xlabel, y = ylabel, title = title) +
    
    # Removing legends
    guides(fill = FALSE, color = FALSE) +
    
    # Setting the limits of the y axis
    #scale_y_continuous(limits = c(0, 1.2)) +
    
    # Picking nicer colours
    scale_fill_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    scale_colour_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    theme_niwot() + scale_y_log10()
}

##################################################
# plotting scatter diagrams 
plotter_scatter <- function(data, x, y, z, 
                            xlab, ylab, title) {
  
  # Load libraries
  library(tidyverse)
  library(gghalves)
  library(ggeasy)
  library(ggthemes)
  
  # write the function
  data %>% ggplot(aes(x = {{x}}, y = {{y}}, col = {{z}})) + 
    
    geom_point(shape = 1, size = 2) + 
    
    labs(x = xlab, y = ylab, title = title)
}
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
remove_outliers <- function(x, na.rm = TRUE, ...) {
  qnt <- quantile(x, probs=c(.10, .90), na.rm = na.rm, ...)
  H <- 1.5 * IQR(x, na.rm = na.rm)
  y <- x
  y[x < (qnt[1] - H)] <- NA
  y[x > (qnt[2] + H)] <- NA
  y
}


data_wins_capital_structures <- my_data %>% 
  
  select(where(is.numeric), -mfiid, -year)


data_wins <- sapply(data_wins_capital_structures, remove_outliers) %>% 
  
  cbind(my_data[,c("mfiid", "mfiname", "region", "year", "age", 
                   
                   "currentlegalstatus", "legal_tradition")]) %>% 
  
  na.omit() %>% 
  
  relocate(mfiid:legal_tradition)
```


\newpage

## Background

@bayai2016financing cite institutional theory in explaining the way microfinance institutions (MFIs) in Africa fund their operations. They note that most MFIs tend to operate as Non-Governmental Organisations (NGOs) at the early stages. These NGOs derive substantial funding from donations and concessionary funds, given that commercial funders deem the MFIs too risky [@ledgerwood1998microfinance; @ledgerwood2006transforming]. Later, in the consolidation stage, the NGOs supplement their funds using government subsidies and equity funding. As they mature, they resort to deposits and debt whilst often using foreign donors as guarantees. At this stage, MFIs are likely to mutate from NGOs that focus on the social aspect of availing financial services to the financially excluded to the commercial model, where financial sustainability matters as much as social performance. 

The transformation of MFIs from NGOs to the commercial model has raised concern over mission drift. Mission drift happens when MFIs focus more on profitability and less on the social aspect of reaching the unbanked [@mia2017mission; @ramus2017stakeholders]. Also, some researchers argue that the hybrid business model of most MFIs makes it challenging to integrate them into the formal financial system as financiers deem them too risky for the level of return they offer [@campion1999institutional]. Conversely, the core argument for the institutional transformation of MFIs from the NGO, not-for-profit model, to the commercial model is access to capital markets. Advocates of the financial sustainability model of MFIs posit that capital market funding allows for improved corporate governance and reduces dependence on volatile donor funding [@garmaise2013cheap; @armendariz2013subsidy]. Financial sustainability also enables MFIs to reach more unbanked people in the long run [@tchakoute2010there]. 

Indeed, many MFIs are transitioning from the NGO not-for-profit model to the financial sustainability approach globally and in Africa. They strive to generate profit over and above meeting their social goal [@hudon2010management; @wagenaar2012institutional; @kodongo2013individual]. Having grown on a donations dependent model, the shift to the commercial model has implied a change in the business model, and most importantly, a search for a steady source of capital beyond donations and subsidies [@armendariz2013subsidy].

Table 1 shows the sources of financing for MFIs in Africa. As expected, NGOs are least reliant on debt compared to other MFI models. Rural banks, commercial banks, Credit unions and NBFIs, respectively, have the most debt relative to assets. The picture is the exact opposite for capital to assets ratio, where NGOs lead while rural banks trail. NGOs have the lowest median deposits to assets ratio, probably arising from the legal restrictions on deposit mobilisation. Lastly, and not surprisingly, NGOs have the highest median donations to assets. While the data shows some regularity in terms of the legal status of MFIs, it is notable that some MFIs are shifting from the NGO model to the commercial model, mainly as commercial banks and NBFIs [@sarma2011ngo; @jia2016commercialization]. For the NGOs converting to the commercial model, the likelihood of alternative, sustainable sources of finance is a vital consideration. 

This article examines the factors that determine the source of financing for MFIs in Africa, beyond the institutional life cycle proposition of @bayai2016financing. Specifically, we explore the drivers of two primary capital structure indicators; leverage (debt to equity ratio), equity (capital to assets ratio), deposits (deposits to assets ratio) and finally, donations (donations to assets ratio).  The existing literature on capital structure choices predominantly focuses on commercial (profit-oriented) firms [@gropp2010determinants; @liu2017optimal; @matias2017there]. The drivers of financing for MFIs may differ from those of purely commercial firms because the social goals of MFIs may conflict with those of the commercial providers of funds. Nonetheless, the extant literature on the funding structure of MFIs mainly examines the link between capital structure and the performance and sustainability of MFIs [@kyereboah2007determinants; @khachatryan2017performance]. 

In this respect, three studies by [@kyereboah2007determinants; @tchuigoua2014institutional; @tchuigoua2015capital] closely resonate with our work. However, in these studies, the researchers focus chiefly on the determinants of leverage (debt-to-equity ratio) for MFIs and find leverage to be positively related to asset tangibility, size, past-due loans, and inversely related to creditor rights and risk; confirming the literature on capital structure. Profitability and credit ratings have a limited impact on capital structure, while financial development and legal tradition are significant. @@tchuigoua2014institutional further finds that donations are negatively related to past-due loans and asset tangibility, implying donors do care about firm riskiness. None of the studies delves into the capital to assets ratio. 

The contribution of our study goes beyond previous research in this area of scholarship in two respects: context and scope. Prior studies dwell exclusively on leverage (debt-equity ratio) while our study examines leverage, capital-assets ratio. The additional financing structure measures are essential for MFIs transitioning to the financial sustainability model as they must source funds externally. Besides, this study goes beyond that of @kyereboah2007determinants that examined MFIs in Ghana only by focusing on Africa, thus allowing for cross-country comparisons. As @d2017ngos cautions, research-based on geographically dispersed regions could mask important regional characteristics, as is the case with the research by @tchuigoua2014institutional and @tchuigoua2015capital Tchakoute-Tchuigoua that draws from a global dataset. This study will allow for deeper insights and comparison using data from a relatively homogeneous region by focusing on Africa. Such knowledge would, in turn, permit us to evolve more effective funding strategies to support and enable the unique added benefit of MFIs (that is, financial inclusion for the poor) that is particularly significant for emerging and developing economies and, in particular, Africa. 

The following section highlights the study results, followed by a review of supporting theory and empirical literature. We then describe data and data sources, followed by the research method. We discuss the results and then conclude. 

## Summary of Results 
The results of the data analysis show that the age of an MFI and governance/ institutional quality are the chief drivers of leverage (debt to equity ratio). The capital to assets ratio for MFIs in Africa has statistically significant relationships with MFI legal status, age, and legal tradition. MFI legal status, age, legal tradition, and profit margin are the key drivers of the deposits to assets ratio. MFI legal form, age, legal tradition, institutional quality, asset structure, private credit, and profit margin drive the donations to assets ratio. Young and mature MFIs have lower leverage relative to new MFIs. At the same time, institutional quality has a negative relationship with the debt to equity ratio. However, after removing influential observations, MFI legal form, asset structure, and profit margin become statistically significant leverage drivers. Specifically, NGOs have lower leverage than the commercial MFIs: banks, credit unions, NBFIs, and rural banks. Asset structure has a negative relationship with the debt to equity ratio, meaning that MFIs with more tangible assets finance their operations using relatively more equity than debt. Likewise, the profit margin negatively affects the debt to equity ratio, given that profits are part of equity. 

NGOs have a consistently lower capital to assets ratio than other legal forms. Older MFIs have lower capital to assets proportions , while institutional quality negatively affects capital assets ratio. The relationship between the percentage of capital to assets and asset structure is mixed. Stock market capitalisation to GDP has a negative relationship with capital to assets ratio, while profit margin has a weak positive relationship. After removing outliers, assets structure shows a positive relationship with capital assets ratio, while private credit to GDP has a significant positive relationship with capital to assets ratio. NGOs have consistently lower deposits to assets ratio than other legal forms of MFIs.

In comparison, MFIs in civil and other legal traditions have a higher ratio than MFIs in civil law countries. Ceteris paribus, asset structure has a positive relationship with deposits to assets ratio. Without outliers, institutional quality private credit to GDP, stock market capitalisation to GDP, and profit margin also have a statistically significant relationship with deposits to assets ratio. Finally, the considerable drivers of the donations to assets ratio are MFI legal form, age, legal tradition, institutional quality, asset structure, private credit to GDP and profit margin. Specifically, NGOs have a higher ratio of donations to assets, while older MFIs and MFIs located in countries with civil law and other legal traditions have a lower ratio. Profit margin has a negative relationship with the donations to assets ratio, while institutional quality, assets structure, and private credit to GDP have the opposite effect. 

\blandscape

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## The data
my_data %>% 
  
  ## Get summaries for each legal status
  group_by(currentlegalstatus) %>% 
  
  ## Summarise to get mean, SD, min, Q1, median, Q3, and Max
  skim_without_charts(debt_to_equity_ratio, capital_asset_ratio, 
                      
                      ## More variables
                      deposits_to_total_assets, donations_assets_ratio) %>%
  
  select(-complete_rate, -n_missing, -skim_type) %>% 

  rename(Variable = skim_variable, Legal_form = currentlegalstatus, 
         
         Mean = numeric.mean, SD = numeric.sd, 
         
         Min = numeric.p0, Q1 = numeric.p25,
         
         Median = numeric.p50, Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  mutate(Variable = if_else(Variable == "debt_to_equity_ratio", "Debt/Equity", 
                            
                            Variable), 
         
         Variable = if_else(Variable == "capital_asset_ratio", "Capital/Assets", 
                            
                            Variable), 
         
         Variable = if_else(Variable == "donations_assets_ratio", "Donations/Assets", 
                            
                            Variable),
         
         Variable = if_else(Variable == "deposits_to_total_assets", "Donations/Assets", 
                            
                            Variable)
         
         
         ) %>% 
  
  kbl(., caption = "Summary Statistics for Categrical Independent Variables", 
      
      booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE, font_size = 8) %>% 
  
  footnote(general = "Authors' construction from the MIX data",
           
           general_title = "Source: ",
           
           number = c("N = 4782", "Legal status include NGO, Non-Bank Financial Institutions (NBFIs), Credit Unions, and Banks", "Age has mature MFIs older than 8 years, young ones (4 - 8 years), and new ones that are 4 years or less"),
           number_title = "Note: ")
```

\elandscape


## Theoretical Framework 

Like commercial firms, MFIs draw their capital from equity, debt (including deposits). Unlike commercial firms, MFIs have a substantial source of capital in the form of donations and subsidies (D’Espallier et al., 2013). As noted, despite the notable difference in financing structure, the empirical research on the financing of MFIs mainly relates to debt-equity mix [@kyereboah2007determinants; @tchuigoua2014institutional; @tchuigoua2015capital]. This study seeks to examine the drivers of the more comprehensive financing structure of MFIs concerning leverage and capital (equity) to assets ratio. The study draws its theoretical frame from two theories: the capital structure and institutional (life cycle) theories. 

The capital structure theories seek to explain the mix of long-term debt and equity in the financing structure of enterprises [@ehrhardt2016corporate]. The dominant literature in this respect revolves around the Modigliani & Miller capital structure theories, of which the trade-off theory against predominant [@sun2016ownership]. The classic trade-off theory holds that the debt-equity mix is relevant insofar as it generates a debt tax shield that organisations balance with the costs of possible financial distress that comes with high debt levels [@liu2017optimal]. Further, financial distress explains why firms favour easily negotiable debt, making firms approve bank loans in place of sourcing debt funds via capital markets [@de2011firms].

The implication is that mature, profitable firms rely on internal capital sources as do firms with little cash flows and intangible assets. In this case, the trade-off theory corresponds with the pecking order theory of Donaldson and Fox (1961) and @myers1984corporate, which posits that firms issue capital in a predetermined order, usually starting with the cheapest internal sources of funds while maintaining a reserve borrowing capacity. In the case of MFIs, we presume that donations and subsidies would come first in the pecking order. The reserve borrowing capacity allows firms to arrange debt funds quickly in case of profitable opportunities that arise. Moreover, the trade-off theory corresponds with the proposition by @bayai2016financing that the capital structure of MFIs evolves with the institutional life-cycle of firms. Younger firms are more proportionately reliant on donations and concessionary funds. Older firms more inclined to commercial funding. 

@bradley1984existence extended the trade-off theory, showing that, under certain conditions, the tax disadvantage of debt at the individual level offset the tax disadvantage at the corporate level. The result was the introduction of leverage related costs to the classical trade-off theory. These costs include the bankruptcy costs, agency costs of debt, the loss of non-debt tax shields (such as accelerated depreciation and investment tax credits). The additional leverage related costs mean that firms seek to balance the tax benefits of debt and the leverage-related costs. @miao2005optimal show that the choice of financing mix relates to these non-debt tax shields, in addition to financial and trade cycles. Hence the capital structure is firm-specific and mean-reverting. Still, the capital structure theories cannot explain the observed under-leveraged firms. Moreover, while the profit motive drives commercial firms, the capital structure theories may not fully apply to hybrid firms with a dual mission, like MFIs.

The institutional theory does have some congruence with the capital (financial) structure of MFIs. The observed rise in debt financing and the concurrent drop in donations could point to a shift by MFIs towards a financially sustainable MFI model. The pressure to move towards the financial sustainability model could reflect a broader change in the MF industry or result from pressure from donors, signalling fatigue and the intent to withdraw or reduce funding. The pressure would be incredibly intense for MFIs that are highly dependent on donations [@powell2012new], underlining the role of donors such as USAID in the push towards sustainability [@bateman2010doesn]. Although the institutional theory cannot fully account for the MFIs that have not changed from NGOs to commercial models, the changing capital structures indicate that financial sustainability is gaining traction. Figure 6.4 shows that even without a change in legal forms, the proportion of donations to MFIs in Africa is dropping. The following section details the empirical approach adopted in the study. 

## Method

The study adopts the fixed and random effects models depending on the outcome of the Hausman tests (see appendix 2). Following @roberts2013endogeneity. We consider the model that follows.


$Y_{it} = \beta_{0} + \beta_{1}X_{it} + \mu_{it}$


Further, assume that,


$\mu_{it} = C_{i} + \epsilon_{it}$


Where  $c_{i}$ captures the aggregate effects of the unobserved, time-invariant explanatory variables for $Y_{it}$ . Further, assume that $e_{it}$ has zero mean conditional on $X_{it}$. In the case where $C_{i}$ and $X_{it}$ are correlated, then $C_{t}$ is a fixed effect; otherwise, it is a random effect. Note that the existence of fixed effects implies the presence of endogeneity. For random effects, on the other hand, endogeneity is not a concern. However, the random-effects model affects the computation of standard errors (Roberts & Whited, 2013).

Thus, the fixed effects models seek the causes of changes within an entity. The fixed-effects model does this by controlling for all time-invariant differences between the individuals, so the estimated coefficients of the fixed-effects models cannot be biased because of omitted time-invariant characteristics, such as culture [@torres2007panel]. To deal with the endogeneity inherent in the fixed effects model, researchers recommend two strategies. The first approach involves the inclusion of firm-specific intercepts by running the least squares dummy variable regression. The method is not feasible with medium to large datasets. In the alternative within-estimator approach, researchers apply OLS to the deviations-from-the-within estimator, eliminating the fixed effect prone to endogeneity. The within-estimator regression is as follows ^[For a more detailed but simplified discussion on the derivation and application of the within-estimator, refer to Roberts and Whited (2013), pp. 558.]. 

\begin{equation}
Y_{it} = \beta_{1} \Delta X_{it} + \Delta \mu_{it}
\end{equation}

However, the model does not deal with the potential endogeneity between  $\Delta X_{it}$ and $\mu_{it}$. Differencing also reduces the efficiency of estimates if the fixed effect (differenced out of the model) and the dependent variable correlate strongly [@clark2015should]. Consequently, we run both fixed and random effects, even where the Hausmann test recommends one over the other.

### Variables Definitions and Data Sources 

We source panel data from the Microfinance Information Exchange (MIX) pooled database, the Worldwide Governance Indicators (WGI), and World Development Indicators (WDI) from the World Bank databases. Table 6. 2 below describes the variables.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
tribble(~ Variable_Description, 

"1. Debt-to-Equity Ratio: The ratio of total liabilities to equity, the amount of leverage supported by each unit of capital contributed by shareholders. The ratio shows how an MFI finances its portfolio of assets beyond equity capital to cushion or absorb losses when total assets fall short of all liabilities. Much of the extant research examines the debt-equity mix and its relationship with the performance of MFIs",

"2. Deposits to Total Assets: The ratio of deposits to assets that aids in determining the extent to which MFIs use deposits to finance assets. NGOs transitioning to the commercial model can mobilise deposits  to fund their operations over and above donations and equity",

"3. Capital to Assets Ratio: The ratio of total equity to total assets and a slightly modified reciprocal debt-to-equity ratio. Hence, it captures the ability to meet obligations and to absorb unexpected losses using capital contributions by the owner (Kimmel, Weygandt, & Kieso, 2018)",
        
"4. Current Legal Status: The legal forms of registration of an MFI are as follows; Commercial Bank, Non-Bank Financial Institution (NBFI), Non-Governmental Organization (NGO), Credit Union/ Cooperative, or Rural Bank. The legal status may dictate the profit orientation and sources of capital for the MFIs. The legal status of an MFI may impact the financing structure in several ways. First, legal status or form typically restricts NGOs from taking deposits, which lowers the debt-equity ratio and deposits to assets, raising the capital asset ratio. Also, NGOs may not venture into capital markets for funds, given their mostly not-for-profit orientation. The opposite is the case for MFIs of commercial banks legal form whose legal status allows for deposits.", "", 
        
"5.	Age: MIX classifies MFIs into three categories depending on the time that has elapsed since the MFI started operations- new (0-4 years), young (4-8 years) and mature (over eight years). The variable is hence a dummy. Older firms are likely better established, have a solid reputation and hence likely to attract more debt and deposits. The institutional life cycle view of Bayai and Ikhide (2016) captures the correspondence between age and debt.", "", 

"6. Legal Tradition (Legal): The indicator is a dummy variable with common law countries coded 0, civil law countries 1, and 2 otherwise as per the classification by Oto-Peralías and Romero-Ávila (2014). Typically, common law countries have relatively better financial infrastructure that allows firms to access financial markets easily. Hence, MFIs in common law countries may exhibit higher debt and equity ratios in their capital structures than those in common law and other legal traditions. (Schnyder, Gerhard, Mathias Siems, & Ruth V. Aguilera, 2018)", "", 

"7. Size (Log of Total Assets): We proxy the size of MFI with the natural logarithm of total assets, again using MIX data. Assets are supported by the sum of capital and liabilities or, equivalently, the total value of resources owned or controlled by the MFI resulting from past and current activities and from which the MFI derives future benefits. We expect firms with more assets to have a higher debt capacity and more debt-to-equity ratios, and lower capital to equity ratios. Large firms draw their strength from holding diversified investments and hence higher capacity to absorb risk. Besides, they have easy access to debt markets(Kurshev & Strebulaev, 2015). Furthermore, these firms are likely to attract more deposits, given the trust they inspire in depositors and their marketing reach (Kimmel et al., 2018). We hypothesise that donations vary positively with the size of MFI, as large, older firms have established a reputation with donors.", "", 

"7. Governance/ Institutional Quality (KKM): We create the country level KKM index using the first principal component of the WGI available in the World Bank databases. The index captures the institutional quality in corruption control, government effectiveness, political stability, the rule of law, and voice and accountability (Kaufmann, Kraay, & Mastruzzi, 2011). Firms in countries with better governance can quickly raise debt finance due to ease of contract enforcement — the result, a high debt-equity ratio and a low capital asset ratio. Similarly, the level of deposits mobilisation may be higher in better-governed countries arising from consumer confidence in legislation relating to deposits protection (La Porta, Lopez-de-Silanes, & Shleifer, 2013; Allen et al., 2014). Lastly, MFIs in countries with low KKM may have higher donations as donors opt to circumvent corrupt government channels. We use the terms institutional quality and governance interchangeably throughout the text", "", 

"8. Private Credit to GDP: We capture the total amount of credit advanced to the private sector by financial intermediaries as a proxy for capital markets development concerning the banking sector following Ito and Kawai (2018). The data source is the Global Financial Development Database, GFDD, of the World Bank (See note 4). Private credit to GDP represents the financial resources provided to the private sector by domestic money banks as a share of GDP. Domestic money banks comprise commercial banks and other financial institutions that accept transferable deposits, such as demand deposits. The data is available in WDI. Financial sector development is central to the acquisition of both equity and debt financing. We hypothesise a high debt to equity ratio, and deposits to assets ratios in countries with more robust financial sectors as financial institutions tend to be highly leveraged.", "", 

"9. Stock market capitalisation to GDP: We capture the extent of stock market development using the ratio of stock market capitalisation to GDP to proxy how firms can raise equity capital. Although Africa's equity markets are thin, some relatively large stock markets like South Africa, Kenya, and Ghana exist. The data are from the GFDD.", "", 

"11. Education: Education is the ratio of gross secondary school enrolment to gross primary school enrolment that captures the extent of graduation from elementary to secondary education and the overall literacy rate. The data is available in the WDI. We hypothesise a positive relationship between education and debt/equity ratio, implying a lower capital asset ratio. Similarly, education may enhance the capacity of the populace to use financial products like savings, hence a higher deposit to assets ratio.  Also, education may directly or indirectly influence financial sector development, which eases the acquisition of capital in financial markets (Allen et al., 2014).", "", 

"12. Asset Structure (Tangibility): Asset structure is is measured as the ratio of non-current assets to total assets of an MFI (Microfinance Information Exchange (MIX), 2019). The ratio indicates the extent of investment in physical infrastructure, a significant issue in constraining banking for the poor due to the perceived lack of scale economies to warrant the erection, for instance, of brick and mortar branches (Ledgerwood, 1998). MFIs with a more significant physical presence are likely to attract more deposits. Therefore, they also have a higher capacity to borrow and service debt. Further, tangible assets serve as collateral to protect lenders from the moral hazard problem (Jensen & Meckling, 1976), and hence a positive relationship between debt and asset tangibility (Titman & Wessels, 1988; Kyereboah-Coleman, 2007a).", "", 

"13. Profit Margin: The profit margin is the net operating income divided by financial revenue. The ratio represents the ability of MFIs to generate income from the core mandate of offering financial services like lending, savings, insurance, and so on. Profitability may enhance the capacity of an MFI to secure debt, thus leading to a higher debt to equity ratio and low capital to assets ratio. The opposite is the case when an MFI retains earnings and hence raises the level of equity.", "") %>% 
  
  kbl(., caption = "Description of Variables", 
      
      booktabs = TRUE, longtable = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9, 
                
                latex_options = "repeat_header") %>% 
  
  footnote(number = c("MIX Database on www.themix.org and https://datacatalog.worldbank.org/dataset/mix-market", "WDI on https://databank.worldbank.org/source/world-development-indicators.", "WGI/ KKM on https://databank.worldbank.org/source/worldwide-governance-indicators.", "GFDD on https://www.worldbank.org/en/publication/gfdr/data/global-financial-development-database"), 
           
           number_title = "Notes",
    
           general = "Source: Authors' construction from the literature",
           
           general_title = "")
  
  #knitr::kable(caption = "Description of variables")
```


## Exploratory Data Analysis 

Figure 1 shows the correlation matrix and scatter plots for the numeric variables used in this work's empiricalmodel. Furthermore, the debt-to-equity ratio, capital-to-assets ratio, deposits to assets ratio, and donations to assets ratio (the first four entries of the rows and columns) are the dependent variables. The rest are the independent variables, including the donations to assets ratio. The main diagonal shows the distribution of the representative variables in place of correlations of a variable with themselves. The main diagonal shows that most variables are highly skewed, except for assets. The lower half of the Figure shows the pairwise scatter plots between the variables, with the axis interpreted as we do correlation matrices as described next.

\blandscape

```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  select(debt_to_equity_ratio, capital_asset_ratio, 
         
         deposits_to_total_assets, donations_assets_ratio, 
         
         assets, kkm, education, pcrdbgdp, stmktcap,
         
         gdp_growth_annual, profit_margin  
         
         ) %>% 
  
  skimr::skim_without_charts() %>% 
  
  select(-n_missing, -complete_rate, -skim_type) %>% 
  
  rename(Variable = skim_variable, Mean = numeric.mean, SD = numeric.sd, 
         
         Min = numeric.p0, Q1 = numeric.p25, Median = numeric.p50,
         
         Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  mutate(Variable = stringr::str_to_sentence(Variable)) %>% 
  
  kbl(., caption = "Summary Statistics", booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE, font_size = 10) %>% 
  
  footnote( number_title = "Notes",
    
           general = "Authors' construction from MIX data",
           
           general_title = "Source: ")
  
```
\elandscape


\blandscape


```{r, fig.height = 6, fig.width = 9, fig.align='center', fig.cap="Correlation Matrix for Independent Variables", echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  select(debt_to_equity_ratio, capital_asset_ratio, 
         
         deposits_to_total_assets, donations_assets_ratio, 
         
         assets, kkm, pcrdbgdp, stmktcap, profit_margin) %>% 
  
 ggpairs(lower = list(continuous = wrap("points", alpha = 0.2, 
          color = "skyblue"), 
          combo = wrap("dot_no_facet", alpha = 0.1, size = 0.05)))
```


\elandscape

There is a substantial negative and significant relationship between capital-asset-ratio (which captures the ratio of equity capital to total assets) and deposits-assets-ratio for dependent variables. The correlations indicate that for MFIs that garner deposits, the injection of equity capital is not a priority as these MFIs, like commercial banks, tend to leverage on deposits and just put in enough equity to meet regulatory requirements. The debt to equity ratio and the deposits to asset ratio have a significant positive relationship, although the magnitude is not high. The capital to asset ratio and debt to equity ratio has no meaningful association. For the dependent variables, the highest observed correlation is between education on the one hand and the proxies for capital market development; private credit to GDP and stock market capitalisation to GDP, at 0.461 and 0,538, which is in line with the literature [@allen2013resolving; @allen2014african]. Consequently, we exclude education from our regressions. 

Finally, except for the debt to equity ratio, the other three independent variables significantly correlate with the dependent variables. Specifically, the debt to equity ratio has a low but significant correlation with the other dependent and independent variables. The capital asset ratio has no statistically significant correlation with profit margin and stock market capitalisation to GDP. Likewise, donations have no significant correlation with GDP growth and education, while deposits exhibit a substantial correlation with donations, institutional quality/ governance, and stock market capitalisation to GDP. While correlation does not imply causation, these results point to the need for further investigation. The following section on regression models revisits this result for an in-depth interrogation of the relationships. Table 6. 3 shows the summary statistics for the numeric variables while Table 6. 4 summarises the categorical variables. 

Figure 2 shows the breakdown of the dependent variables across MFI legal status. Note that rural banks and commercial banks have the highest median debt to equity and deposits to assets ratios, followed by credit unions, NBFI, and NGOs. The former could indicate ease in accessing capital markets. At the same time, deposits reflect the capacity of banks to mobilise deposits. Their focus on niche rural markets with the unbanked populace makes it easier to garner deposits for rural banks. The visualisation rightly shows that rural banks, commercial banks and cooperatives have the highest deposits to assets ratio.

Consequently, commercial banks, cooperatives, and rural banks have the lowest capital to assets ratio. The results show that commercial banks and rural banks emphasise offering a broader range of financial services, specifically savings products in place of credit alone. For NGOs, Garnering deposits is a challenge due to legal hurdles. Coupled with the emphasis on the social aspect of reaching the poor, NGOs would have a more significant difficulty accessing commercial funding compared to other legal types of MFIs. Reinforcing the welfare approach to microfinance, NGOs have the highest median donations to assets ratios, followed by NBFIs, while commercial banks and rural banks come last. These results arise out of the mission of MFIs, where donors fund MFIs that explicitly focus on social aspects of reaching the unbanked- meaning that donors still do value the welfare approach to microfinance.

Finally, Figure 6.4 shows the trends in the dependent variables over time, with the debt to equity ratio trending gradually upwards while the capital to assets ratio trends downwards. It shows that MFIs have steadily been increasing their debt capital over this period as they grow and get to access capital markets.  Likewise, deposits have been trending upwards as more MFIs reach a higher number of consumers or as they mature and get the legal mandate to garner deposits. The trend for the donations to assets ratio is like literature in microfinance suggests; donors have gradually reduced their relative contribution to MFIs. Alternatively, MFIs are less reliant on donations as they grow, given that donations form a decreasing proportion of their assets base. The implication here is that both donors and MFIs have gradually embraced the financial sustainability approach to microfinance, thus requiring MFIs to be financially sustainable while fulfilling their social mandate. Next, we discuss the results of the regressions. 

\blandscape

```{r, fig.height = 6, fig.width = 9, fig.align='center', fig.cap="Capital Sources by MFI Legal Status", echo = FALSE, message = FALSE, warning = FALSE}

(my_data %>% 
  
  select(currentlegalstatus, debt_to_equity_ratio, capital_asset_ratio, deposits_to_total_assets, 
         
         donations_assets_ratio) %>% 
  
  plotter(x = currentlegalstatus, 
          
          y = debt_to_equity_ratio, 
          
          z = currentlegalstatus, 
          
          xlabel = "Current Legal Status", 
          
          ylabel = "Debt to Equity Ratio", 
          
          title = "Debt to Equity Ratio by Legal Status") +


my_data %>% 
  
  select(currentlegalstatus, debt_to_equity_ratio, capital_asset_ratio, deposits_to_total_assets, 
         
         donations_assets_ratio) %>% 
  
  plotter(x = currentlegalstatus, 
          
          y = capital_asset_ratio, 
          
          z = currentlegalstatus, 
          
          xlabel = "Current Legal Status", 
          
          ylabel = "Capital Asset Ratio", 
          
          title = "Capital Asset Ratio by Legal Status")) /

(my_data %>% 
  
  select(currentlegalstatus, debt_to_equity_ratio, capital_asset_ratio, deposits_to_total_assets, 
         
         donations_assets_ratio) %>% 
  
  plotter(x = currentlegalstatus, 
          
          y = deposits_to_total_assets, 
          
          z = currentlegalstatus, 
          
          xlabel = "Current Legal Status", 
          
          ylabel = "Deposits to Total Assets", 
          
          title = "Deposits to Total_assets by Legal Status") +

my_data %>% 
  
  select(currentlegalstatus, debt_to_equity_ratio, capital_asset_ratio, deposits_to_total_assets, 
         
         donations_assets_ratio) %>% 
  
  plotter(x = currentlegalstatus, 
          
          y = donations_assets_ratio, 
          
          z = currentlegalstatus, 
          
          xlabel = "Current Legal Status", 
          
          ylabel = "Donations Assets Ratio", 
          
          title = "Donations Assets Ratio by Legal Status")) + 
  
  plot_annotation(title = "Capital Sources by MFI Legal Status", 
                  
                  caption = "Source: Authors' construction from MIX data")
```

\elandscape


\blandscape

```{r, fig.height = 6, fig.width = 9, fig.align='center', fig.cap = "Assets, Asset Structure, and Profit margin of MFIs in Africa", echo = FALSE, message = FALSE, warning = FALSE}
######################################
######################################
(my_data %>% 
  
  ggplot(aes(x = fct_reorder(age, asset_structure, mean), y = (asset_structure + 1), fill = age)) + 
   
  geom_violin() +
  
  geom_boxplot() + 
  
  theme(legend.position = "none") + 
  
  coord_trans(y = "log10") + 
   
  labs(x = "Age", y = "Asset Structure", 
       
       title = "Asset Structure by Age") +
   
   

########################################
my_data %>% 
  
  ggplot(aes(x = fct_reorder(age, assets, mean), y = assets, fill = age)) + 
  
  geom_boxplot() + 
  
  theme(legend.position = "none") + 
  
  coord_trans(y = "log10") + 
  
  labs(x = "Age", y = "Assets", title = "Assets of MFIs by Age")) 

```


\elandscape

\blandscape

```{r, fig.height = 6, fig.width = 9, fig.align='center', fig.cap="Trends in Capital, Debt, Deposits, and Donations", echo = FALSE, message = FALSE, warning = FALSE}
###########################################
(my_data %>% 
  
  select(mfiid, year, debt_to_equity_ratio) %>% 
  
  group_by(year) %>% 
  
  mutate(mean_data = mean(debt_to_equity_ratio)) %>% 
  
  ggplot(aes(x = year, y = mean_data)) + 
  
  geom_point() + 
  
  geom_smooth() + 
  
  labs(x = "Year", y = "Debt/Equity Ratio", title = "Trends in Debt to Equity Ratio") +

############################################################
my_data %>% 
  
  select(mfiid, year, capital_asset_ratio) %>% 
  
  group_by(year) %>% 
  
  mutate(mean_data = mean(capital_asset_ratio)) %>% 
  
  ggplot(aes(x = year, y = mean_data)) + 
  
  geom_point() + 
  
  geom_smooth() + 
  
  labs(x = "Year", y = "Capital/Assets Ratio", title = "Trends in Capital to Assets Ratio")) /

##############################################################
(my_data %>% 
  
  select(mfiid, year, deposits_to_total_assets) %>% 
  
  group_by(year) %>% 
  
  mutate(mean_data = mean(deposits_to_total_assets)) %>% 
  
  ggplot(aes(x = year, y = mean_data)) + 
  
  geom_point() + 
  
  geom_smooth() + 
  
  labs(x = "Year", y = "Deposits to Total Assets", title = "Trends in Deposits to Total Assets Ratio") +

###############################################################
my_data %>% 
  
  select(mfiid, year, donations_assets_ratio) %>% 
  
  group_by(year) %>% 
  
  mutate(mean_data = mean(donations_assets_ratio)) %>% 
  
  ggplot(aes(x = year, y = mean_data)) + 
  
  geom_point() + 
  
  geom_smooth() + 
  
  labs(x = "Year", y = "Donations/Assets Ratio", title = "Trends in Donations to Total Assets Ratio")) + 
  
  plot_annotation(title = "Trends in Capital, Debt, Deposits and Donations for MFIs in Africa", 
                  
                  caption = "Source: Authors' construction from MIX data")
```

\elandscape


```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  select(asset_structure, assets, pcrdbgdp, 
         
         stmktcap, profit_margin, 
         
         pcrdbgdp, stmktcap) %>% 
  
  skim_without_charts() %>% 
  
  mutate(N = 4782) %>% 
  
  select(-complete_rate, -n_missing, -skim_type) %>% 

  rename(Variable = skim_variable, 
         
         Mean = numeric.mean, SD = numeric.sd, 
         
         Min = numeric.p0, Q1 = numeric.p25,
         
         Median = numeric.p50, Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  relocate(N, .after = Variable) %>% 
  
  kbl(., caption = "Summary Statistics for Categrical Independent Variables", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from the MIX data",
           
           general_title = "",
           
           number = c("Legal status include NGO, Non-Bank Financial Institutions (NBFIs), Credit Unions, and Banks", "Age has mature MFIs older than 8 years, young ones (4 - 8 years), and new ones that are 4 years or less"),
           number_title = "Note: ")
```

## Regression Results
This section discusses the output from the regression models, starting with the debt to equity ratio, the capital to assets ratio, the deposits to total assets ratio, and the donations to assets ratio. Appendix 1 shows the results of the Hausmann Test and the choice over fixed and random effects models [@clark2015should]. For the Hausmann test, the null hypothesis is for the random-effects model [@torres2007panel]. The results favour the random-effects model, except for the model with debt to equity ratio as the response. For robustness, however, we run both fixed and random effects. The data at hand is an unbalanced panel.

For this reason, we ran a random-effects model on the full dataset. We then subset the data for instances with three or more years of data and then five or more years of data. These Figures (three and five) correspond to the mean and median number of years of data per MFI dataset. Finally, we run a pooled OLS and a fixed-effects model using the entire dataset.

### Drivers of Leverage (Debt to Equity Ratio)
Tables 5 shows the output of the relevant regression models with debt to equity ratio as the dependent variable. The regressions indicate that MFI age matters the most in determining the debt to equity ratio at the firm level. At the macro-level, institutional quality is a significant driver of leverage.

#### Age
Regarding age, new MFIs (0-4 years) in Africa have a significantly higher debt to equity ratio than young MFIs (4-8 years), on average. However, there is no significant difference between the leverage of new MFIs and mature MFIs (8 years and above), although the coefficient has a negative sign suggesting lower debt to equity ratio. This result means that the oldest firms and the newest MFIs tend to finance their operations with more equity than debt. Given that equity is riskier than debt, it follows that investors have more confidence in older MFIs and youngest MFIs. The capital structure theory does not mention the age of a firm as a significant driver of capital structure. However, suppose age has a direct correspondence with size. In that case, we expect that older, larger MFIs are more profitable (a source of internal equity) and can attract long term equity funding due to their track record [@barclay2005capital; @barclay2006debt]. The relatively high debt to equity ratio of new MFIs could reflect the emphasis on the financial sustainability of MFIs which makes start-ups resort to relatively more debt to finance their operations due to reduced availability of donations and government subsidies [@gwatidzo2009corporate]. Without the initial support from donors, equity funders deem start-up MFIs too risky. Without the initial seed capital in grants and concessionary funds, the institutional lifecycle theory of @bayai2016financing may not hold. 


#### Institutional Quality (KKM)
Institutional quality or governance (KKM) has an inverse relationship with the debt to equity ratio of MFIs in Africa. Higher KKM corresponds to a lower debt to equity ratio and vice versa, implying that MFIs in high KKM countries rely more on equity than debt. Research on capital structure theory shows that indeed governance matters in determining the ease of contract enforcement and safeguarding property rights [@butkiewicz2006institutional]. Governance also reflects the effective regulation of capital markets, hence better capital markets development [@matias2017there; @ombati2016effects]. In MFIs, better KKM may encourage long term equity investment relative to debt investment and thus the observed relationship.

\blandscape

```{r, results = "asis", echo = FALSE, message = FALSE, warning = FALSE}
########################
fixed_effects_de <- modelling(data = my_data, depvar = my_data$debt_to_equity_ratio)

fixed_effects_de3 <- modelling(data = data3, depvar = data3$debt_to_equity_ratio)

fixed_effects_de5 <- modelling(data = data5, depvar = data5$debt_to_equity_ratio)

random_effects_de <- modelling(data = my_data, depvar = my_data$debt_to_equity_ratio, model = "random")

random_effects_de3 <- modelling(data = data3, depvar = data3$debt_to_equity_ratio, model = "random")

random_effects_de5 <- modelling(data = data5, depvar = data5$debt_to_equity_ratio, model = "random")

pooling_de <- modelling(data = my_data, depvar = my_data$debt_to_equity_ratio, model = "pooling")

#####################################################

inference_m101 <- coeftest(fixed_effects_de, vcov = vcovBK(fixed_effects_de, method = "arellano", type="HC1", cluster = "group"))

inference_m111 <- coeftest(fixed_effects_de3, vcov = vcovBK(fixed_effects_de3, method = "arellano", type="HC1", cluster = "group"))

inference_m121 <- coeftest(fixed_effects_de5 , vcov = vcovBK(fixed_effects_de5 , method = "arellano", type="HC1", cluster = "group"))

inference_m131 <- coeftest(random_effects_de, vcov = vcovBK(random_effects_de, method = "arellano", type="HC1", cluster = "group"))

inference_m141 <- coeftest(random_effects_de3, vcov = vcovBK(random_effects_de3, method = "arellano", type="HC1", cluster = "group"))

inference_m151 <- coeftest(random_effects_de5, vcov = vcovBK(random_effects_de5, method = "arellano", type="HC1", cluster = "group"))


####################################################

stargazer(fixed_effects_de, fixed_effects_de3, 
     
     fixed_effects_de5, random_effects_de, random_effects_de3, random_effects_de5,
     
     se = list(inference_m101[,2], inference_m111[,2], inference_m121[,2], 
     
     inference_m131[,2], inference_m141[,2], inference_m151[,2]),
     
     title = "Regression Output for Debt to Equity Ratio (Standard Errors in Brackets)", 
     
     align = TRUE, font.size = "tiny", header = FALSE, 
     
     omit = c("year.", "Constant"),
     
     add.lines = list(c("Model", "Within", "Within", "Within", 
            
            "Random", "Random", "Random"), 
     
     c("Data", "Full", ">=3 Years", ">=5 Years", 
      
      "Full", ">=3 Years", ">=5 Years")))
```

\elandscape

### Drivers of Capital to Assets Ratio
Regression results for the drivers of the capital-assets ratio among MFIs in Africa appear in Table 6. 6. Capital assets ratio is the ratio of total equity to total assets. Again, legal status, age, legal tradition, and stock market development are related to the equity to total assets ratio. We examine these significant variables in turn. 

#### Current Legal Status
NGOs consistently have higher capital to assets ratio than other legal traditions: banks, cooperatives, NBFIs, and rural banks. The definition of debt to equity ratio means that NGOs finance their operations using more equity than debt. The results align with the institutional life cycle theory, which posits that MFIs often start financing operations using donations and concessionary funds, then switch to equity as they mature [@bayai2016financing]. Debt is often for well established MFIs, at which point they are likely financially sustainable and likely to switch to the commercial model [@d2017ngos]. NBFIs have the second-highest mean and median levels of capital to assets ratio, followed by banks, while cooperative and rural banks come last in that order. These results align with the literature confirming the high leverage of banks [@mettenheim2013back], with the bulk of the capital in deposits.

The results also reflect the market conditions where donations and subsidies are getting less available as donors begin to stress sustainability. Mature firms have a long-running relationship with donors to the extent they have a profitable business model and developed a business profile that allows them to make profits and issue equity. Characteristically, commercial banks and other deposit-taking institutions tend to be more leveraged than other financial intermediaries because they have the license and scale to garner deposits and other debt instruments, explaining the pattern of results. 

#### Age
The capital to asset ratio of MFIs in Africa decreases with age. Young (4-8 years) and mature (8 years and over) MFIs have lower capital to assets ratios, on average than new MFIs (0-4 years). The mean and median capital to assets ratio These results are also in line with the literature on capital structure. Older firms are likely larger with more support to pledge as collateral and quickly raise funds in the debt markets [@barclay2005capital]. Also, as MFIs mature, they are likely to graduate from the loans only model to start accepting deposits which further raises their leverage. Overall, this makes the equity component smaller relative to the debt component. In the capital structure literature, age is not a significant driver of the capital structure except through its link to the size of an MFI, as we discuss next. 

#### Legal Tradition
MFIs located in common law countries have, on average, higher capital to assets ratio than equivalent MFIs in civil law or other legal tradition countries. The results follow from the law and finance literature, showing that common law legal tradition corresponds to a higher level of capital market development, especially stock market development [@la2013law]. Civil law countries have the lowest mean and median capital to assets ratio confirming the law and finance literature in Africa's context [@schnyder2018twenty]. If capital markets and especially equity markets are more developed in common law countries, it means that MFIs can quickly issue equity financial instruments. Also, venture capitalists are more willing to inject private equity in MFIs in common law countries. The public equity markets offer an opportunity to exit the investment once it takes root [@kent2013bankers].

#### Stock Market Development
There is a weak negative but statistically significant relationship between stock market development and capital to assets ratio. It means that MFIs in countries with vulnerable stock markets have more equity relative to assets and vice versa. These results may reflect the bank-based versus capital market-based model of financing. Most economies in Africa follow the bank-based model [@gropp2010determinants], where firms mainly raise funds from commercial banks in loans instead of equity and debt markets. Effectively, there is a weak link between microfinance and the equity and debt market, reflecting the small coefficients [@ahmed2014financial]. MFIs appear to have little linkage with the equity markets, and even where they do, prefer retained earnings and private equity to listing publicly. Available evidence shows very few cases of MFIs that are publicly listed [@hishigsuren2006transformation]. 

#### Other Insignificant Variables
Governance or institutional quality (KKM), asset structure, private credit to GDP, and profit margin are statistically insignificant capital to assets ratio drivers. However, KKM and private credit to GDP both have a positive relationship with capital to assets ratio, reflecting the importance of institutions both in the development of debt and equity markets. The relationship between assets structure and profit margin on the one hand, and capital to assets ratio on the other, shows mixed results, which may highlight the low profitability of MFIs in Africa (see appendix 7). 
 
\blandscape

```{r, results = "asis", echo = FALSE, message = FALSE, warning = FALSE}
#####################################
fixed_effects_car <- modelling(data = my_data, depvar = my_data$capital_asset_ratio)

fixed_effects_car3 <- modelling(data = data3, depvar = data3$capital_asset_ratio)

fixed_effects_car5 <- modelling(data = data5, depvar = data5$capital_asset_ratio)

random_effects_car <- modelling(data = my_data, depvar = my_data$capital_asset_ratio, model = "random")

random_effects_car3 <- modelling(data = data3, depvar = data3$capital_asset_ratio, model = "random")

random_effects_car5 <- modelling(data = data5, depvar = data5$capital_asset_ratio, model = "random")

pooling_car <- modelling(data = my_data, depvar = my_data$capital_asset_ratio, model = "pooling")

##############################################
inference_m201 <- coeftest(fixed_effects_car, vcov = vcovBK(fixed_effects_car, method = "arellano", type="HC1", cluster = "group"))

inference_m211 <- coeftest(fixed_effects_car3, vcov = vcovBK(fixed_effects_car3, method = "arellano", type="HC1", cluster = "group"))

inference_m221 <- coeftest(fixed_effects_car5 , vcov = vcovBK(fixed_effects_car, method = "arellano", type="HC1", cluster = "group"))

inference_m231 <- coeftest(random_effects_car, vcov = vcovBK(random_effects_car, method = "arellano", type="HC1", cluster = "group"))

inference_m241 <- coeftest(random_effects_car3, vcov = vcovBK(random_effects_car3, method = "arellano", type="HC1", cluster = "group"))

inference_m251 <- coeftest(random_effects_car5, vcov = vcovBK(random_effects_car5, method = "arellano", type="HC1", cluster = "group"))


##############################################

stargazer(fixed_effects_car, fixed_effects_car3, 
     
     fixed_effects_car5, random_effects_car, random_effects_car3, random_effects_car5,
     
     title = "Regression Output for Capital to Assets Ratio (Standard Errors in Brackets)", 
     
     align = TRUE, font.size = "tiny", header = FALSE, 
     
     se = list(inference_m201[,2], inference_m211[,2], inference_m221[,2], 
     
     inference_m231[,2], inference_m241[,2], inference_m251[,2]),
     
     omit = c("year.", "Constant"),
     
     add.lines = list(c("Model", "Within", "Within", "Within", 
            
            "Random", "Random", "Random"), 
     
     c("Data", "Full", ">=3 Years", ">=5 Years", 
      
      "Full", ">=3 Years", ">=5 Years")))
```

\elandscape


### Drivers of Deposits to Total Assets
The deposits to assets ratio has a positive relationship with MFI legal form, age, asset structure, size proxied by the logarithm of assets, and profit margin (see Table 6. 7). Significant drivers of the deposits to assets ratio at the country level are legal tradition and institutional quality, KKM. Proxies for capital markets development, that is, private credit to GDP and stock markets capitalisation to GDP do not significantly affect the ratio. We discuss these relationships next. 

#### Current Legal Status
NGOs have lower deposits to assets ratio than commercial banks, credit unions, NBFIs, and rural banks. These results may arise out of the different business models followed by different legal forms of MFIs. NGOs have taken root dependent on donations and subsidies with little emphasis on deposits mobilisation [@d2013unsubsidized; @d2017ngos]. Also, NGOs face legal restrictions on deposit mobilisation given that most are not under the supervision of central banks. Credit unions, on the other hand, thrive on taking deposits from members making them have higher capacity for deposit mobilisation than NGOs [@lauer2008transforming]. As expected, rural banks, commercial banks and cooperatives have the highest mean and median deposits ratios. Like credit unions, commercial banks actively seek donations and are licensed to do so. Hence, commercial banks have higher levels of deposits-driven leverage than NGOs [@abbas2020commercial].

#### Age
Older MFIs have higher deposits to assets ratio than younger MFIs. This result reflects the more comprehensive regional presence of older, larger MFIs, which aligns with the capital structure theory [@barclay2005capital; @barclay2006debt] and enhanced goodwill from the public. Also, older MFIs have invested in information technology to reach people in remote locations [@di2021technology]. Again, older MFIs are likely to have attained deposit mobilisation licenses from relevant regulatory bodies like central banks. The results are in line with capital structure theory, where the size of an MFI, which is also positively related to age, has a significant relationship with leverage. For most financial intermediaries, the largest deposits are the largest source of debt financing [@gale2020bank]. 

#### Legal Tradition
MFIs in countries with civil law and other legal traditions tend to have a higher deposit to assets ratio than those in common law countries, with MFIs in civil law countries having the highest proportion. It means that MFIs in common law countries finance their operations using more equity than civil law countries. These results are in line with the higher levels of capital markets development in common law countries [@la2013law; @schnyder2018twenty] that allows MFIs to quickly raise equity capital and debt capital in a form other than deposits. 

#### Institutional Quality (KKM)
The institutional quality or governance (KKM) has a weak negative relationship with the deposits to assets ratio, holding all other variables constant. In other words, MFIs located in countries with better governance rely less on deposits and more on alternative forms of finance, namely equity and debt, than MFIs with lower governance metrics. These results would imply that as institutional quality improves, people are less likely to maintain deposits, and instead, prefer the capital markets and other sorts of investments. The argument will hold if KKM supports the development of financial and other markets that facilitates investments with better returns than bank deposits offer [@la2013law; @schnyder2018twenty]. Indeed, although primarily insignificant, the degree of capital market development has a negative relationship with the deposits to assets ratio, which could render credence to the argument. Also, with better-developed capital markets, MFIs can access finance from other sources, lowering the relative importance of deposits. 

#### Asset Structure
Asset structure or asset tangibility has a mixed relationship with deposits to assets ratio, ceteris paribus. However, capital structure theory shows that firms can use tangible assets as collateral for debt funding. Thus, firms with more tangible assets usually have more debt at a lower cost than firms with less tangible assets [@campello2011capital; @ombati2016effects]. However, the rise of information technology means that MFIs no longer have to hold high tangible (fixed) assets, especially in property, plant and equipment, to reach the unbanked population [@asadullah2021access]. Except for older firms that had already invested in many branches before information technology took root, asset structure is likely insignificant in deposits mobilisation [@di2021technology]. 

#### Profit Margin
Profit margin has a positive but very weak positive relationship with deposits to assets ratio. The result could hold that profitable MFIs reach more consumers by opening more branches or investing more in information technology [@di2021technology]. Moreover, in line with the capital structure theory, Profitable firms are usually large and mature with free cash flows to support debt repayment and thus hold more debt. Firms take up debt to minimise cash that managers could misallocate. The debtholders act as delegated monitors and further monitor management [@barclay2005capital; @gwatidzo2009corporate; @ombati2016effects]. Finally, both stock market capitalisation to GDP and private credit to GDP has no significant effect on the deposits to assets ratio. 


\blandscape

```{r, results = "asis", eval = TRUE, echo=FALSE, warning=FALSE, message=FALSE}

fixed_effects_depo <- modelling(data = my_data, depvar = my_data$deposits_to_total_assets)

fixed_effects_depo3 <- modelling(data = data3, depvar = data3$deposits_to_total_assets)

fixed_effects_depo5 <- modelling(data = data5, depvar = data5$deposits_to_total_assets)

random_effects_depo <- modelling(data = my_data, depvar = my_data$deposits_to_total_assets, model = "random")

random_effects_depo3 <- modelling(data = data3, depvar = data3$deposits_to_total_assets, model = "random")

random_effects_depo5 <- modelling(data = data5, depvar = data5$deposits_to_total_assets, model = "random")

pooling_depo <- modelling(data = my_data, depvar = my_data$deposits_to_total_assets, model = "pooling")

####################################################
##############################################
inference_m301 <- coeftest(fixed_effects_depo, vcov = vcovBK(fixed_effects_depo, method = "arellano", type="HC1", cluster = "group"))

inference_m311 <- coeftest(fixed_effects_depo3, vcov = vcovBK(fixed_effects_depo3, method = "arellano", type="HC1", cluster = "group"))

inference_m321 <- coeftest(fixed_effects_depo5 , vcov = vcovBK(fixed_effects_depo5, method = "arellano", type="HC1", cluster = "group"))

inference_m331 <- coeftest(random_effects_depo, vcov = vcovBK(random_effects_depo, method = "arellano", type="HC1", cluster = "group"))

inference_m341 <- coeftest(random_effects_depo3, vcov = vcovBK(random_effects_depo3, method = "arellano", type="HC1", cluster = "group"))

inference_m351 <- coeftest(random_effects_depo5, vcov = vcovBK(random_effects_depo5, method = "arellano", type="HC1", cluster = "group"))
####################################################


stargazer(fixed_effects_depo, fixed_effects_depo3, 
     
     fixed_effects_depo5, random_effects_depo, 
     
     random_effects_depo3, random_effects_depo5,
     
     title = "Regression Output for Deposits to Assets Ratio (Standard Errors in Brackets)", 
     
     align = TRUE, font.size = "tiny", header = FALSE, 
     
     se = list(inference_m301[,2], inference_m311[,2], inference_m321[,2], 
     
     inference_m331[,2], inference_m341[,2], inference_m351[,2]),
     
     omit = c("year.", "Constant"),
     
     add.lines = list(c("Model", "Within", "Within", "Within", 
            
      "Random", "Random", "Random"), 
      
      c("Data", "Full", ">=3 Years", ">=5 Years", 
                       
      "Full", ">=3 Years", ">=5 Years")))
```

\elandscape


### Drivers of Donations to Assets Ratio
In Table 6. 9, donations to assets ratio show the most robust relationship with the variables in the regression, except for stock market to GDP ratio. We discuss these relationships next. 

#### Current legal status 
Compared to other legal forms of MFIs, NGOs have the highest proportion of donations to assets. The result is expected because the microfinance industry started as a not-for-profit model with NGO as the legal form of choice [@d2017ngos]. These pioneer NGOs have developed relationships with donors over time than the younger MFIs. Hence, donations are likely to flow to these NGOs from the donors still keen on the welfare approach to microfinance where outreach to the financially excluded is more important than profitability. Late entrants into the microfinance industry find a changed landscape where financial sustainability is also important and hence have to resort to commercial funding [@d2013unsubsidized; @armendariz2013subsidy]. 

#### Age
Older, larger firms have smaller donations to assets ratio than younger, smaller firms. The result holds due to the relatively larger assets base of older MFIs. Table 6. 8 shows that older MFIs (that is, young and mature) still receive more donations in absolute terms than younger ones. Hence, as MFIs grow, the relative importance of contributions diminishes as they build their asset base. However, older MFIs still retain a stronger financial relationship with donors [@armendariz2013subsidy; @cgap2017].

```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
 
 group_by(age) %>% 
 
 summarise(Donations = mean(donations),
      Donations_Assets = mean(donations_assets_ratio), 
      Donations1 = median(donations),
      Donations_Assets1 = median(donations_assets_ratio)) %>% 
 
 set_names(names(.) %>% str_to_sentence()) %>% 
 
 knitr::kable(caption = "Mean and Median Donations and Donations to Assets Ratio", 
        
        booktabs = TRUE) %>% 
 
 add_header_above(c("."=1, "Mean" = 2, "Median" = 2)) %>% 
 
 kable_classic(full_width = TRUE, font_size = 9) %>% 
 
 footnote(number = "Younger MFIs have higher donations to assets ratios but lower absolute donations", 
      
      number_title = "Notes",
  
      general = "Source: Authors' construction from the literature",
      
      general_title = "") 
 

 
 
```

#### Legal tradition
MFIs located in common law countries have higher and statistically significant donations to assets ratio than those in civil law countries. The theoretical link, in this case, is that from the law and finance literature where common law countries exhibit higher levels of financial development [@la2013law; @schnyder2018twenty]. The higher levels of financial development further derive from the better institutional quality. MFIs in countries with better institutional quality are more likely to attract donations, presumably because there is a lower incidence of corruption which may drive donors away. The following section shows that institutional quality positively relates to the donations to assets ratio [@huang2010political].

#### Institutional Quality (KKM)
As the relationship between legal tradition and donations implies, institutional quality has a positive relationship with the donations to assets ratio. The result shows that donors care about the relative levels of accountability in a country before choosing to donate funds to MFIs because there is a higher likelihood that the cash will benefit the intended target, the financially excluded [@kaufmann2011worldwide; @huang2010political]. 

#### Asset structure
Asset structure has a positive relationship with the donations to assets ratio. It follows that MFIs with more property, plant and equipment, which implies they are larger and older, receive more donations than their assets [@cull2018microfinance]. These results could hold given that, as noted earlier, larger, older firms have a long and elaborate relationship with donors than the relatively younger MFIs. 

#### Private credit to GDP
MFIs located in countries with better-developed debt markets have lower donations to assets ratios. For an MFI in a well-developed capital market, there are alternative avenues for raising funds to finance assets that lower donations' relative contribution. Moreover, better developed financial markets could translate to a lower incidence of financial exclusion for donors to fund [@marron2013governing].

#### Profit margin
Profit margin has an inverse relationship with donations to assets ratio. As is the case with private credit to GDP, a more profitable MFI can retain more earnings to finance operations. Consequently, the proportion of donations that goes into financing assets diminishes. Likewise, profitable MFIs are more likely to raise funds from banks which is in line with the capital structure theory [@dorfleitner2017access]. 

\blandscape

```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
fixed_effects_dona <- modelling(data = my_data, depvar = my_data$donations_assets_ratio)

fixed_effects_dona3 <- modelling(data = data3, depvar = data3$donations_assets_ratio)

fixed_effects_dona5 <- modelling(data = data5, depvar = data5$donations_assets_ratio)

random_effects_dona <- modelling(data = my_data, depvar = my_data$donations_assets_ratio, model = "random")

random_effects_dona3 <- modelling(data = data3, depvar = data3$donations_assets_ratio, model = "random")

random_effects_dona5 <- modelling(data = data5, depvar = data5$donations_assets_ratio, model = "random")

pooling_dona <- modelling(data = my_data, depvar = my_data$donations_assets_ratio, model = "pooling")

####################################################
inference_m401 <- coeftest(fixed_effects_dona, vcov = vcovBK(fixed_effects_dona, method = "arellano", type="HC1", cluster = "group"))

inference_m411 <- coeftest(fixed_effects_dona3, vcov = vcovBK(fixed_effects_dona3, method = "arellano", type="HC1", cluster = "group"))

inference_m421 <- coeftest(fixed_effects_dona5, vcov = vcovBK(fixed_effects_dona5, method = "arellano", type="HC1", cluster = "group"))

inference_m431 <- coeftest(random_effects_dona, vcov = vcovBK(random_effects_dona, method = "arellano", type="HC1", cluster = "group"))

inference_m441 <- coeftest(random_effects_dona3, vcov = vcovBK(random_effects_dona3, method = "arellano", type="HC1", cluster = "group"))

inference_m451 <- coeftest(random_effects_dona5, vcov = vcovBK(random_effects_dona5, method = "arellano", type="HC1", cluster = "group"))
####################################################


stargazer(fixed_effects_dona, fixed_effects_dona3, 
     
     fixed_effects_dona5, random_effects_dona, 
     
     random_effects_dona3, random_effects_dona5,
     
     title = "Regression Output for Donations to Assets Ratio (Standard Errors in Brackets)", 
     
     align = TRUE, font.size = "tiny", header = FALSE, 
     
     se = list(inference_m401[,2], inference_m411[,2], inference_m421[,2], 
     
     inference_m431[,2], inference_m441[,2], inference_m451[,2]),
     
     omit = c("year.", "Constant"),
     
     add.lines = list(c("Model", "Within", "Within", "Within", 
            
      "Random", "Random", "Random"), 
      
      c("Data", "Full", ">=3 Years", ">=5 Years", 
                       
      "Full", ">=3 Years", ">=5 Years")))

```

\elandscape

However, in the Appendix (Table 13), when we winsorise the data to remove outliers, age is no longer an essential driver of donations, which would explain the mixed results in Table 6. 9.


## Robustness Checks 
This section highlights the robustness checks on the models run in four areas: extreme values (outliers), heteroscedasticity, autocorrelation, and cross-sectional dependence. In each case, we discuss the corrective measures taken. 

### Extreme values/ Outliers

The likelihood that extreme values could influence the results is highly likely in a panel setting containing different units [@torres2007panel]. To check whether the outliers affect our inference, we winsorise the data by removing the top 10% and the bottom 10% for each continuous variable used in the regression analysis. We then ran regression models on the new dataset with the results displayed in appendix 2 and 3. 

Age and institutional quality remain essential drivers of the debt to equity ratio. The MFI legal form, asset structure and profit margin are also significant when we remove influential observations. Institutional quality retains its inverse relationship with leverage. Regarding age, the association is the opposite of that observed in the regression using the full dataset, with older MFIs more leveraged, in line with the theory [@barclay2005capital]. The current legal status also becomes a significant driver of leverage, with commercial forms of MFIs having a higher debt to equity ratios. This result is also in line with banking literature where deposits-taking intermediaries have higher leverage [@gale2020bank]. Asset structure is also a significant driver of leverage in MFIs, although the direction of the relationship is mixed. Profit margin has a positive relationship with leverage, again confirming the theory on capital structure. 

Turning to capital to assets ratio, MFI legal form and age, country legal tradition and stock market capitalisation remain consistent drivers. After removing outliers, institutional quality or governance (KKM), asset structure, and profit margin positively correlate with the capital to assets ratio. Similarly, the legal form of MFI, age, country legal tradition remains consistent drivers of deposits to assets ratio. While asset structure had a mixed relationship with deposits to assets ratio in the full model, the relationship is consistently negative after removing outliers. In contrast, the profit margin has a negative relationship with deposits. Institutional quality, private credit to GDP and stock market capitalisation to GDP are not important drivers of deposits to assets ratio even after removing outliers. For donations, stock market capitalisation to GDP becomes an important driver after removing outliers. In contrast, the sign of the coefficient of private credit changes to positive and that of profit margin becomes positive. 

### Cross-Sectional Dependence and serial correlation

In panel data settings, cross-sectional dependence (CSD) is an important consideration []. CSD arises when there is a correlation between units in the same cross-section, usually due to unobserved common factors that affect all groups, although probably to differing extents. The omission of common elements in the model results in inconsistent estimates for fixed effects, random effects, and even the first difference model [@henningsen2019analysis]. In our case, we run the Breusch-Pagan LM test of independence with the results shown in appendix 4 and 5. The analyses indicate cross-sectional dependence in the regressions with Capital to Total Assets Ratio and Deposits to Total Assets Ratio as the dependent variables.  

Extant research deals with CSD in three main ways. The traditional method is the use of seemingly unrelated regressions (SUR) of @zellner1962further [@arouri2013econometric]. SUR allows for the estimation of the individual coefficient $\beta_{it}$ and hence estimate the effects of the independent variables on the dependent variables for each unit of analysis, in our case, MFIs [@sarafidis2012cross]. Again, the cross-sectional data is not sufficient for SUR analysis. The second method developed by @esaran2021general - the panel mean groups- works by averaging individual coefficients across panels. Hence, the technique requires panel data where each panel has sufficient data for a regression, which is not possible in this study. Therefore, we implement the third approach, the Panel Corrected Standard Errors (PCSE) [@bailey2011implementing; @croissant2008panel]. PCSE is useful when working with heterogeneous dynamic panel data by correcting autocorrelation and cross-sectional dependence while providing more robust standard errors [@ikpesu2019growth]. The results presented have their standard errors corrected for CSD, resulting in heteroscedastic consistent coefficients. 

## Conclusion 

This article examined the drivers of four typical indicators of the financing structure of MFIs in Africa: Debt to equity ratio, capital to assets ratio, Deposits to assets ratio and Donations to assets ratio. The results show that the size, legal status, and age of MFIs are consistently related to the financing structure. Profit margin is directly related to leverage and inversely to capital to assets ratio, as capital structure theory predicts. Institutional quality (KKM) pertains mainly to deposits and donations, with lower KKM corresponding to more deposits and donations. Education and asset structure relate weakly to leverage, while financial development is surprisingly not a significant factor that contradicts stylized facts on firms' capital structure.  For MFIs, it is the institutional level factors that drive the financing structure. Overall, microfinance in Africa shows a weak linkage to the macro-economy, that is, macroeconomic determinants vis=a-vis the macroeconomic drivers of MFIs activities. 

\newpage 

## Appendix

### Appendix 1: Results of the Hausmann Test

```{r, echo = FALSE, message = FALSE, warning = FALSE}
rbind(hausmann_test(my_data, my_data$debt_to_equity_ratio),

hausmann_test(my_data, my_data$capital_asset_ratio),

hausmann_test(my_data, my_data$deposits_to_total_assets),

hausmann_test(my_data, my_data$donations_assets_ratio)

) %>% 
  
  tibble() %>% 
  
  mutate(Variable = c("Debt-Equity Ratio", "Capital/Asset Ratio", "Deposits/Assets Ratio", 
                      "Donations/Assets Ratio")) %>% 
  
  relocate(Variable) %>% 
  
  set_names(names(.) %>% str_to_sentence()) %>% 
  
  kbl(., caption = "Hausmann Tests", booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9, 
                
                latex_options = "hold_position") %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "", 
           
           number = "Alternative Hypothesis: One model is inconsistent",
           
           number_title = "Note: ")
```

### Appendix 2: Multicollinearity: Variance Inflation Factors

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Variance Inflation factors
vif1 <- car::vif(random_effects_car)
vif2 <- car::vif(random_effects_de)
vif_final <- cbind(vif1, vif2)
vif_final %>% 
  
  kbl(., caption = "Variance Inflation Factors", booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9, latex_options = "hold_position") %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "", 
           
           number = "The first three rows show VIF for the model on capital asset ratio followed by debt-equity ratio",
           
           number_title = "Note: ")
```


\newpage

\blandscape



```{r, results='asis', fig.cap = "Regressions Using Winsorized Data for Leverage and Capital to Assets Ratio", echo = FALSE, message = FALSE, warning = FALSE}
fixed_effects_car_wins <- modelling(data = data_wins, depvar = data_wins$debt_to_equity_ratio)

random_effects_car_wins <- modelling(data = data_wins, depvar = data_wins$debt_to_equity_ratio, model = "random")

fixed_effects_de_wins <- modelling(data = data_wins, depvar = data_wins$capital_asset_ratio)

random_effects_de_wins <- modelling(data = data_wins, depvar = data_wins$capital_asset_ratio, model = "random")

############################################
inference_m501 <- coeftest(fixed_effects_car_wins, vcov = vcovBK(fixed_effects_car_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m511 <- coeftest(random_effects_car_wins, vcov = vcovBK(random_effects_car_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m521 <- coeftest(fixed_effects_de_wins, vcov = vcovBK(fixed_effects_de_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m531 <- coeftest(random_effects_de_wins, vcov = vcovBK(random_effects_de_wins, method = "arellano", type="HC1", cluster = "group"))
################################################

stargazer(fixed_effects_car_wins, random_effects_car_wins, 
          
          fixed_effects_de_wins, random_effects_de_wins,
          
          title = "Regression Output for Winsorized Data (Standard Errors in Brackets)", 
          
          dep.var.labels = "Fixed and Random Effects with Leverage and Capital to Assets Ratio",
          
          se = list(inference_m501[,2], inference_m511[,2], inference_m521[,2], 
          
          inference_m531[,2]),
          
          align = TRUE, font.size = "tiny", header = FALSE, 
          
          omit = c("year.", "Constant"),
          
          add.lines = list(c("Model", "Within", "Random", "Within", 
                        
                        "Random"), 
                        
          c("Dependent Variable", "Debt/Equity", "Debt/Equity",
                          
                          "Capital/Assets", "Capital/Assets"),
          
          c("Data", "Winsorized", "Winsorized", 
            
            "Winsorized", "Winsorized")))

         
```

\elandscape

\newpage

\blandscape


```{r, results='asis', fig.cap = "Regressions Using Winsorized Data for Deposits and Donations", echo = FALSE, message = FALSE, warning = FALSE}
fixed_effects_deposits_wins <- modelling(data = data_wins, depvar = data_wins$deposits_to_total_assets)

random_effects_deposits_wins <- modelling(data = data_wins, depvar = data_wins$deposits_to_total_assets, model = "random")

fixed_effects_donations_wins <- modelling(data = data_wins, depvar = data_wins$donations_assets_ratio)

random_effects_donations_wins <- modelling(data = data_wins, depvar = data_wins$donations_assets_ratio, model = "random")

######################################
inference_m601 <- coeftest(fixed_effects_deposits_wins, vcov = vcovBK(fixed_effects_deposits_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m611 <- coeftest(random_effects_deposits_wins, vcov = vcovBK(random_effects_deposits_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m621 <- coeftest(fixed_effects_donations_wins, vcov = vcovBK(fixed_effects_donations_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m631 <- coeftest(random_effects_donations_wins, vcov = vcovBK(random_effects_donations_wins, method = "arellano", type="HC1", cluster = "group"))
####################################################


stargazer(fixed_effects_car_wins, random_effects_car_wins, 
          
          fixed_effects_de_wins, random_effects_de_wins,
          
          title = "Regression Output for Winsorized Data (Standard Errors in Brackets)", 
          
          dep.var.labels = "Fixed and Random Effects with Deposits and Donations",
          
          se = list(inference_m601[,2], inference_m611[,2], inference_m621[,2], 
          
          inference_m631[,2]),
          
          align = TRUE, font.size = "tiny", header = FALSE, 
          
          omit = c("year.", "Constant"),
          
          add.lines = list(c("Model", "Within", "Random", "Within", 
                        
                        "Random"), 
                        
                        c("Dependent Variable", "Deposits/Assets", "Deposits/Assets",
                          
                          "Donations/Assets", "Donations/Assets"),
          
          c("Data", "Winsorized", "Winsorized", 
            
            "Winsorized", "Winsorized")))

         
```


\elandscape









<!--chapter:end:07-troubleshooting.Rmd-->

---
#########################################
# options for knitting a single chapter #
#########################################
output:
  bookdown::pdf_document2:
    template: templates/brief_template.tex
    citation_package: biblatex
  bookdown::html_document2: default
  bookdown::word_document2: default
documentclass: book
bibliography: references.bib
always_allow_html: true
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
- \usepackage[default]{sourcesanspro}
- \usepackage[T1]{fontenc}
- \usepackage{amsmath}
- \usepackage{dcolumn}
- \usepackage{url}
---

```{block type='savequote', include=knitr::opts_knit$get('rmarkdown.pandoc.to') == 'latex', quote_author='(ref:goethe-quote)'}
He who chases two rabbits catches neither.

<!-- ending a line with a lonely backslash inserts a linebreak -->
```
(ref:goethe-quote) --- Confucius [@caseau2020impact]

# Conclusion and Policy Derivatives

This study examined the potential impacts of the transformation of MFIs in Africa. The conversion of MFIs has seen a substantial number of MFIs that previously operated as NGOs convert to a commercial, profit-seeking model that rely less on donations and state subsidies and more on funding from capital markets. The motivation for the transformation of MFIs is that financially sustainable MFIs stand a better chance of expnading finnancial inclusion than those MFIs that rely on donations and subsidies. However, there are  concerns in microfinance research literature of the potential of mission drift among the transformed MFIs [@armendariz2011mission; @serrano2014microfinance]. Mission drift occurs when transformed MFIs stress financial sustainability at the expense of the social goal of offering appropriate and affordable financial services to the financially excluded [@d2017ngos]. So far, there is lack of consensus on the extent and direction of the effect of transformation of MFIs. Much of the extant research draws from global datasets, which could mask regional heterogeneity. 

The research extended the existing research by examining the factors that drive the conversion of MFIs to the commercial model. This research research oversight is surprising given that as more MFIs adopt the profit-oriented model, an appropriate policy framework should be in place to support the transformation and mitigate potential side effects of the conversion. The research further explored the extent to which the conversion of MFIs to the commercial model affects financial inclusion in Africa. The output from this objective will allow researchers to assess the impacts of the transformation of MFIs on financial inclusion and craft appropriate interventions. As noted before, there is lack of consensus on the effects of MFI transformation on financial inclusion and this objctive contributes to the existing body of evidence. 

Critically, the study also examined the levels of financial and social efficiency of MFIs and the factors that determine whether or not MFIs in Africa meet their financial and social goals. In this regard, much of the literature examines the financial and social outcomes of MFIs separately instead of evaluating them jointly as two sides of the same coin. This research goes beyond the existing research by evaluating the joint financial and social goals of MFIs in Africa, the extent to which MFIs achieve these goals, and the factors that drive or hinder the achievement of the dual goals. 

Also, few researchers examine the financing model of MFIs, considering that, as hybrid organisations, the mainstream capital structure theory may be deficient as it addresses the financing of commercial firms. The output from this objective will inform policies focusing on the financing of MFIs in Africa, considering that the double bottom line objective of MFIs may necessitate trade-offs between profitability and the achievement of the social goals of reaching the unbanked. 

In this regard, the study sought answers to the following questions in light of the research gaps highlighted. 

1. Why do some MFIs in Africa transform into the commercial model while others retain the NGO Model?
2. To what extent has the institutional transformation of MFIs in Africa affected financial inclusion?
3. After transformation, what factors explain the joint level of sustainability and outreach by MFIs in Africa?
4. What are the drivers of financial efficiency, social efficiency and socio-financial efficiency of MFIs in Africa?
5. What are the factors that influence the choice of financing sources by transformed MFIs in Africa? 

## Highlight of the Results

The first research question examines factors that make MFIs to adopt the commercial, profit-seeking model that gets funding from capital markets instead of relying on donations and subsidies. The analysis show that at the firm level, age and size influence transformation. Legal tradition, institutional quality, and stock market development are significant factors at the country level. Specifically, larger and older MFIs are less likely to be NGOs. These results suggest that as MFIs mature, they tend to convert to the commercial model either due to pressure from donors or the decision by management to pursue the double bottom line as they get more financially sustainable and as donor support subsides. MFIs in civil law countries are also less likely to be NGOs, while those in countries that follow other legal traditions are more likely to adopt the commercial model. 

Again,  Institutional quality raises the chances of MFI conversion to the commercial model. Institutional quality captures a wide range of governance measures that enhance contract enforcement and property rights. Hence, countries with stronger institutions tend to attract more private investments and hence the higher rate at which MFIs adopt the commercial model. Stock market capitalisation and private credit to GDP have a negative relationship with transformation. The development of capital markets corresponds to better access to financial services, a pre-condition for financial inclusion. Hence, MFIs in countries with well-developed financial markets will likely be competing against established financial intermediaries for the existing market. The competition limits the financial viability of MFIs. Hence, MFIs in these markets will likely remain NGOs that serve small population in the fringes of the market. 

I then examined how the transformation of MFIs in Africa has affected or could potentially affect financial inclusion on the continent. The results show that the change from the NGO model to the commercial models could negatively affect the depth of financial outreach, especially given that NGOs characteristically have better outreach to women and advance smaller denomination loans on average than for-profit MFIs. Also, NGOs have higher median gross loans to assets ratio than other legal forms of MFIs except for credit unions/cooperatives. Overall, the results indicate the potential mission drift, where MFIs that convert to the for-profit model focus more on financial sustainability to the detriment of outreach to the unbanked. 

in Chapter 4, I examined the levels and drivers of financial and social efficiency of MFIs in Africa. In this case, i captured the efficiencies using output oriented data envelopment analysis (DEA). Broadly, our results show a trend of declining financial efficiency by MFIs but no discernible trend in social and socio-financial efficiency. However, NGOs have markedly better social efficiency and socio-financial efficiency scores than other legal forms of MFIs. Surprisingly, only cooperatives and rural banks consistently outperform NGOs financially. The proxies for financial sector development, stock market capitalization to GDP and private credit to GDP,  have a negative relationship with social and socio-financial efficiency. Financial efficiency has an inverse relationship with both the size and asset structure of MFIs. These results suggest that the commercialization of MFIs does not necessarily improve their financial sustainability.

Related to chapter 4, chapter 5 examined the extent to which MFIs in Africa achieve financial and social goals. The chapter also sought to uncover factors that drive the achievement of the dual objectives. The results show that most MFIs in Africa attain the dual objectives, at 35.88% compared to 14.76% that fail in both missions. 23.85% fail socially but succeed financially, and 25.55% succeed socially while failing financially. In total, 61.43% of MFIs attain their social goals. 40.31% fail financially. However, these results vary across the legal status of an MFI. Rural banks and NGOs are more likely to achieve the dual goals than banks, NBFIs and credit unions. Accordingly, the legal status of an MFI is the most significant driver of the extent of the achievement of the dual goals. NGOs have the highest likelihood of achieving both financial and social goals. This result highlights the risk of mission drift should MFIs convert to the for-profit model. Larger MFIs have a higher chance of meeting financial and social goals. Likewise, larger firms are more likely to succeed socially while failing financially, meaning that larger firms emphasise social impact. Age raises the probability that an MFI will fail financially and socially, as does stock market capitalisation to GDP that proxies capital markets development. Lastly, MFIs in countries following civil law and other legal traditions are more likely to meet at least one of the objectives, unlike MFIs in common law countries. 

Finally, in chapter 6, I looked into the factors that drive the adoption of alternative finance sources. In this case I examined four primary sources of finance; leverage, equity, deposits, and donations. The significant determinants of financing at the firm level are size, age, legal status, and profitability consistent with theory. For example, asset structure varies inversely with leverage. At the country level, institutional quality (KKM) varies inversely with deposits and donations. Interestingly, coefficients of financial development are not significant across all financial structure proxies, going against stylised facts on the macro-level drivers of firms’ financing structure. The results suggest that firm-level factors are more relevant in determining the financing structure of MFIs. 

## Policy Implications 

There are some important policy derivatives from the outcomes of the research. But first, it is important to restate the objectives and outcomes of the research that form the basis of the policy recommendations. The study sought to examine the possible impacts of the transformation of MFIs in Africa on financial inclusion. The transformation aimed at making MFIs less reliant on donor funding and state subsidies by making them financially sustainable. Financially sustainable MFIs would then experience mission expansion instead of mission drift [@mersland2010microfinance]. This logic arose after the cold war and the rise of neo-liberalism that emphasises the financial viability of institutions. I first look at the implications of the research on the financial and social goals of MFIs in Africa, and the implications on financial inclusion.

First, the conversion of MFIs does not appear to improve the financial sustainability of MFIs in Africa. The conversion of MFIs does not help improve their financial sustainability, at least in the short and medium term. Overall, MFIs fare badly financially. However, NGOs have better financial efficiency scores than banks and NBFIs. Only cooperatives and rural banks do better financially than NGOs. With cooperatives more inclined to serving their members more than offering financial services to the unbanked, it appears that the argument for financial sustainability as an enabler of mission expansion does not hold.  

Indeed, the analysis shows that NGOs form the largest proportion of MFIs that are financially viable while maintaining their social focus. This result shows that NGOs are better at balancing social and financial goals more than the converted MFIs. Even where they fail financially, NGOs have the highest proportion of MFIs that succeed socially, meaning that NGOs are more keen on their social mission than on financial goals. The mission of NGOs together with donor support could be the reason they are able to stick to their social mission [@berbegal2019impact].The results show that there is high likelihood of mission drift where MFIs that seek financial sustainability focus less of availing financial services to the financially excluded. These results are an indiction against the coercive pressure from donors and governments for MFIs to be financially viable. 

These results leave two possible policy interventions. First, are there policies that would support the conversion of MFIs from NGOs to the commercial model without causing mission drift? Secondly, among the converted MFIs what kind of support would best allow them to be financially sustainable without losing focus on their social goals? Third, what financing options are best suited to support the dual objectives of microfinance institutions? Fourth, there is a prominent proposition by @morduch1999microfinance and @morduch2000microfinance that advocates for allowing a broad range of MFIs- from those that seek financial sustainability to those that focus on financial exclusion with donor and state support. I examine these points next. 

Chapter 2 established some of the factors that drive the conversion of MFIs to the commercial model. I found that age and size influence the transformation, whereas legal tradition, institutional quality, and stock market development are significant factors at the country level. Larger MFIs and MFIs located in countries with “other” legal traditions are more likely to follow the commercial model. Institutional quality raises the chances of conversion, while stock market capitalisation has a negative relationship with transformation. Among the factors associated with a higher chance that an MFI will achieve both financial goals and social goals are MFI age, size and legal status, country legal tradition, level of capital markets development, and institutional quality. The latter three have a negative relationship with the extent of achieving financial and social goals. 

These results imply that MFIs located in countries with better institutions and by extension better capital markets development are better following the commercial model especially given the low levels of financial exclusion in these countries. Better institutions allow MFIs in these countries to achieve their financial goals even when not meeting their social goals without extensive loss in public welfare. On the contrary, MFIs located in countries with low levels of financial development with low institutional quality would better retain a greater degree of NGO-type MFIs. The substantial levels of financial exclusion in these countries mean that conversion of MFIs will have substantial impact on financial inclusion which goes against the millennium development goals and the African Union Agenda 2063 on financial inclusion for all. It means that for the achievement of financial inclusion goals, some level of donations and state subsidies are necessary especially in countries with large financial inclusion gaps.The neo-liberal approach to the coercive adoption of the commercial mode of MFIs uniformly across all countries, especially in Africa, is inappropriate as @bateman2010doesn notes. 

Also, @morduch1999microfinance and @morduch2000microfinance argue that the microfinance industry should allow for a wide range of MFIs. In this model, the NGO-type MFIs could still rely on donations and subsidies and reach out to the poorest section of the population that is shunned by the mainstream financial system. Then, as these customers get better off, they could join the mainstream financial system. This models implies that the customers of MFIs could be segmented and served on the basis of need. This model will then allow for the coexistence of different types of MFIs- profit seeking versus NGO type - instead of prioritizing some types of MFIs over others. To extend this argument, the model of microfinance should also be different depending on the differing situations between countries. As noted, countries with very low levels of financial inclusion due follow levels of capital markets development should allow and support more NGO-type MFIs, relative to countries with relatively lower levels of financial exclusion. 

A related issue in financing hybrid organisations like MFIs is the rise of impact finance and blended finance. Impact investing relates to the use of corporate principles to generate environmental, social and governance (ESG) gains over and above financial goals. The defining features of impact investing are as follows. 

- Intentionality of impact,

- Expectation of financial returns, and

- Measurable impact along non-financial dimensions—notably, social, environmental, or governance (or two or three of these) dimensions [@caseau2020impact]. 

This research has established the decline in donations to MFIs in line with the rise of neo-liberalism. Also, most MFIs have poor financial results and may not attract capital market funding.Impact financing could bridge this deficiency by offering support without expecting financial returns as high as those demanded by mainstream providers of capital. @barber2021impact show that impact investors derive non-pecuniary utility from investing in dual-objective Venture Capital (VC) funds, thus sacrificing returns. The entry of impact financing into microfinance could help mitigate the administrative challenges associated with the double bottom-line objective of MFIs. 

A related concept is blended finance [@attridge2019blended]  which the [IFC](https://www.ifc.org/wps/wcm/connect/topics_ext_content/ifc_external_corporate_site/bf) defines as follows:

>The use of relatively small amounts of concessional donor funds to mitigate specific investment risks and help rebalance risk-reward profiles of pioneering investments that are unable to proceed on strictly commercial terms. Concessional funds are structured as co-investments, with an expectation of reflows for future investments or other uses ^[This definition is available https://www.ifc.org/wps/wcm/connect/topics_ext_content/ifc_external_corporate_site/bf].

Blended finance would be especially useful for MFIs in the initial stages of conversion when financial goals may be hard to attain. Then, as MFIs adjust to the commercial model and become more financially sustainable, the blended funding could scale down. 

The providers of impact and blended financing should consider the needs of MFIs in each country or region. For instance, this research has established that MFIs in countries with high levels of financial development do not fare well financially. Still, there is a substantial number of marginalised people that would benefit from the services of MFIs. MFIs in countries with low levels of financial development have better financial prospects as they serve a relatively large pool of clients. In this case, impact and blended finance could complement financing from the mainstream financial markets. 

## Possible Future Research Directions

In this section, I describe some potential areas for future research. First, it would be interesting to examine MFIs that succeed financially as well as socially after conversion and see what differentiates them. The research could then examine firm level factors that drive the extent that MFIs achieve financial and social goals. These firm-level drivers may include, for example, inefficient employment of resources like human capital which could be addressed by increased use of Fintech or optimising the number of clients per loan officer. This examination would help inform management of MFIs as well as policy makers on the possible areas of intervention to allow MFIs to meet the double bottom line objective. 

Along the same line, it would be worthy examining the longer term examination of financial sustainability vis-a-vis social performance measures of MFIs. This current research did not have the benefit of a longer time series to allow the tracking of financial and social goals of MFIs. It is possible that MFIs may struggle financially at the initial stages but improve as they adjust to the commercial model of operations. This kind of research would help uncover areas that transforming MFIs should address in order to swiftly adjust and be able to meet financial and social goals. 

Even as MFIs convert to the commercial model, a new reality has hit the financial services industry: the rise of Fintech. FinTech promises to deliver financial services at a lower cost than the traditional brick and mortar model. In this regard, MFIs that are converting to the commercial model could benefit immensely from adopting FinTech, both from the financial sustainability and the social outreach perspectives. From this perspective, it would be critical to assess the extent that MFIs that transform invest in FinTech and how the investment in FinTech by MFIs impacts their investments in physical infrastructure, profitability and outreach. 

Perhaps the most critical issue for future research is establishing the best ways to finance MFIs that transform to the commercial model. Much of the literature examines the financing structures of financial intermediaries that only have a commercial goal. Thus, the capital structure theory do not address MFIs that have dual goals. In the mainstream capital structure theory, a firm's value will increase with increased debt upto that time where the costs of financial distress outweigh the corporate and personal tax advantage of debt. In the case of MFIs, the value of a firm is not just the value of debt and equity but also the intangible value arising out of meeting social goals that raises the worth of the firm to stakeholders. Hence, it is paramount to establish the best financing structure to optimise the hybrid goals of MFIs. 






<!--chapter:end:08-conclusion.Rmd-->

`r if(knitr:::is_latex_output()) '\\startappendices'`

`r if(!knitr:::is_latex_output()) '# (APPENDIX) Appendix {-}'` 

<!-- If you feel it necessary to include an appendix, it goes here. The first appendix should include the commands above. -->


# R Packages Utilised in the Research

In my data analysis, I have relied a great deal on the efforts of the work by the `R foundation` [@R], `R Studio`, and many other contributors to the R project. The listing below shows the packages utilised in my research. 

:::::::::::::: {.columns}
::: {.column width="40%"}

bookdown[@bookdown],
broom[@broom],
caret[@caret],
car[@car],
corrplot[@corrplot2021],
GGally[@ggally],
ggalt[@ggalt],
ggeasy[@ggeasy],
gghalves[@gghalves],
ggrepel[@ggrepel],
ggthemes[@ggthemes],
gmnl[@gmnl],
gmodels[@gmodels],
gplots[@gplots], 
gridExtra[@gridextra],
gtable[@gtable],
here[@here],
janitor[@janitor],
kableExtra[@kableExtra],
knitr[@knitr], 
lme4[@lme4], 
lmtest[@lmtest].

:::
::: {.column width="40%"}

margins[@margins],
mice[@mice],
nnet[@nnet],
oxforddown[@lyngsOxforddown2019],
pacman[@pacman], 
patchwork[@patchwork], 
pcse[@pcse],
pglm[@pglm], 
plm [@plm],
prettydoc[@prettydoc], 
pROC[@pROC], 
psych[@psych], 
Rchoice[@rchoice], 
rDEA[@rdea],
readxl[@readxl],
rmarkdown[@rmarkdown],
skimr[@skimr],
stargazer[@stargazer],
thesisdown[@thesisdown2021],
tidymodels[@tidymodels],
tidyverse[@tidyverse],
treemapify[@treemap], 
viridis[@viridis], 
wesanderson[@wesanderson],
zoo[@zoo].

:::
::::::::::::::


# The Second Appendix, for Fun

<!--chapter:end:front-and-back-matter/98-appendices.Rmd-->

`r if(!knitr:::is_latex_output()) '# References {-}'`

<!-- If you're outputting to LaTeX, the heading and references will be generated by the OxThesis LaTeX template. This .Rmd file serves only to add the References headline to gitbook output before  the references are added by pandoc -->

<!--chapter:end:front-and-back-matter/99-references.Rmd-->

