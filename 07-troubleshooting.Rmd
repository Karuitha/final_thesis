---
#########################################
# options for knitting a single chapter #
#########################################
output:
  bookdown::pdf_document2:
    template: templates/brief_template.tex
    citation_package: biblatex
  bookdown::html_document2: default
  bookdown::word_document2: default
documentclass: book
bibliography: references.bib
always_allow_html: true
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
- \usepackage[default]{sourcesanspro}
- \usepackage[T1]{fontenc}
- \usepackage{amsmath}
- \usepackage{dcolumn}
- \usepackage{url}
- \DeclareUnicodeCharacter{200E}{ }
- \usepackage[utf8x]{inputenc}
---

# Sources of Finance for Microfinance Institutions in Africa {#Introduction}
\minitoc <!-- this will include a mini Table 6. 5.of contents-->
\chaptermark{Financing MFIs in Africa}

<!-- LaTeX normally does not indent the first line after a heading - however, it does so after the mini Table 6. 5.of contents. You can manually tell it not to with \noindent -->


```{r, echo = FALSE, message = FALSE, warning = FALSE}

library("pacman")
library("bookdown") 
library("broom") 
library("car") 
library("caret") 
library("corrplot") 
library("dtplyr")
library("excelR") 
library("GGally") 
library("ggalt") 
library("ggeasy") 
library("gghalves") 
library("ggrepel")  
library("ggthemes") 
library("gmnl") 
library("gmodels") 
library("gplots") 
library("gridExtra") 
library("gtable")
library("here") 
library("janitor") 
library("kableExtra") 
library("knitr") 
library("lme4") 
library("lmtest")
library("magrittr") 
library("margins") 
library("mice") 
library("nnet") 
library("pacman") 
library("patchwork") 
library("pcse")
library("pglm") 
library("plm") 
library("prettydoc") 
library("pROC") 
library("psych") 
library("Rchoice") 
library("rDEA")
library("readxl")
library("rmarkdown") 
library("skimr") 
library("stargazer") 
library("tidymodels") 
library("tidyverse")
library("treemapify") 
library("viridis") 
library("wesanderson") 
library("zoo")

#########################################
options(digits = 3)
options(knitr.kable.NA = "-")
theme_set(ggthemes::theme_clean())
#########################################
```

\newpage 

\begin{center}

\textbf{ABSTRACT}

\end{center}

> We examine the sources of finance for MFIs in Africa and their associated drivers. The sources of finance are debt-equity ratio (leverage) and capital to assets ratio (equity), deposits to assets ratio (deposits), and donations to assets ratio (donations). Our analysis shows that at the firm level, size, age, legal status, and profitability drive financing alternatives in line with theory. For example, asset structure varies inversely with leverage. At the country-level, institutional quality (KKM) varies inversely with deposits and donations. Intersstingly, coefficients of financial development and education variables are not significant across all financial structure proxies, going against stylised facts on the macro-level drivers of firms' financing structure. We find that firm-llevel that firm-level factors are more relevant in determining the financing structure of MFIs.

\vspace{10mm}

**Key Words**: Finance, Capital, leverage, Donations, Debt, Deposits, Microfinance, Africa.

\vspace{5mm}
**JEL Classification**: G210, G230

\newpage

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## legal traditions 
### Common law countries in Africa
common <- tibble(country = c("Botswana", "Gambia, The", "Ghana", "Kenya", "Lesotho", "Liberia", "Malawi", "Namibia", "Nigeria", "Sierra Leone", "South Africa", "South Sudan", "Sudan", "Eswatini", "Tanzania", "Uganda", "Zambia", "Zimbabwe"), trad = c(rep("common", 18)))

### Civil law countries in Africa
civil <- tibble(country = c("Algeria", "Benin", "Burkina Faso", "Cameroon", "Central African Republic", "Chad", "Comoros", "Congo, Rep.", "Cote d'Ivoire", "Gabon", "Guinea", "Madagascar", "Mali", "Mauritania", "Morocco", "Niger", "Senegal", "Togo", "Tunisia"), trad = c(rep("civil", 19)))

### Other legal traditions in Africa
others <- tibble(country = c("Equatorial Guinea", "Angola", "Burundi", "Cape Verde", "Congo, Dem. Rep.", "Egypt, Arab Republic of", "Ethiopia", "Eritrea", "Guinea-Bissau", "Mozambique", "Rwanda"), trad = c(rep("others", 11)))

###Putting them all together
legal <- rbind(common, civil, others)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Bond market data - private and public bond market capitalization to GDP
bonds <- read_excel("bonds_oluoch.xlsx") %>% 
  
  janitor::clean_names()

```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Add the financial development index to the dataset
## Countries not part of Africa
mideast <- c("Bahrain", "Iran, Islamic Rep.", "Iraq", "Israel", "Jordan", "Kuwait", "Lebanon", "Malta", "Oman", "Qatar", "Saudi Arabia", "Syrian Arab Republic", "United Arab Emirates", "West Bank and Gaza", "Yemen, Rep.")

## Load the financial structure data
finstr <- read_excel("FinancialStructureDatabase20191018.xlsx", sheet = 4) %>% 
  
  ## Select desired variables
  select(country, region, year, pcrdbgdp, stmktcap, stvaltraded, stturnover, listco_pc) %>% 
  
  ### Filter out regions not in Africa or middle east
  filter(region == "Sub-Saharan Africa" | region == "Middle East & North Africa") %>% 
  ### Filter out countries in middle east and select year 1999 onwards
  filter(!country %in% mideast, year >= 1999) %>% 
  
## Replace NAs
          group_by(country) %>% 
  
          mutate(pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
                 
                 pcrdbgdp = replace_na(pcrdbgdp, 0),
                 
                 stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE)),
                 
                 stmktcap = replace_na(stmktcap, 0)) %>% ungroup() %>% 
  
## Join with the bonds data
  left_join(bonds, by = c("country", "year")) %>% 
  
## rename bonds columns 
  rename(prbonds = outstanding_t_bonds_percent_gdp, 
         
         pubonds = outstanding_c_bonds_percent_gdp) %>% 
  
  ## Replace NAs in public bond and private bond markets 
  mutate(pubonds = replace_na(pubonds, 0), 
         
         prbonds = replace_na(prbonds, 0)) %>% 
  
         ## Rename Ivory Coast
         mutate(country = if_else(country == "CÃ´te d'Ivoire", "Cote d'Ivoire", 
                                  
                                  country))

## View missing data points
#mice::md.pattern(finstr)

#finstr %>% select(pcrdbgdp, stmktcap) %>% cor(.) %>% 
  
  #corrplot(method = "number", type = "lower")
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Read in the dataset 
my_data <- read_csv("amelia.csv") %>% 

## Region
mutate(region = if_else(region == "Middle East and North Africa", 
                        
                        "North_Africa", region)) %>% 

# Clean the names 
janitor::clean_names() %>% 
  
# Set up factor variables 
## legal status 
mutate(currentlegalstatus = factor(currentlegalstatus, 
                           levels = c("NGO", "Bank", "NBFI", 
                            "Credit Union/ Cooperative", 
                            "Rural Bank")), 
      ## Age
      age = factor(age, levels = c("New", "Young", "Mature")),
       
      ## Region 
      region = factor(region, levels = c("North_Africa", "Africa"))) %>% 
  
      ## Add the financial structure data     
      left_join(finstr, by = c("country", "year")) %>% 
  
      ## Add a binary variable for the legal dummy- NGO vs Others
      mutate(currentlegaldummy = case_when(currentlegalstatus == "NGO" ~ "NGO",
                                           
                                           TRUE ~ "others"),
      
        currentlegaldummy = factor(currentlegaldummy, levels = c("NGO", "others")),
        
        legal_tradition = factor(legal_tradition, 
                                 
                                 levels = c("Common", "Civil", "Other"))
        
        ) %>% 
  ## Select required variables 
  select(mfiid, mfiname, year, country, currentlegaldummy, currentlegalstatus, 
         
         percent_of_female_borrowers, operational_self_sufficiency,
         
         age, legal_tradition, region.x, asset_structure, 
         
         assets, kkm, education, pcrdbgdp, stmktcap, prbonds, 
         
         gdp_growth_annual, donations, donations_assets_ratio, 
         
         profit_margin, capital_asset_ratio,
         
         debt_to_equity_ratio, operating_expense_assets, 
         
         average_loan_balance_per_borrower, gross_loan_portfolio_to_total_assets, 
         
         deposits_to_total_assets, liabilities_and_equity) %>% 
  
          ## Rename region
         rename(region = region.x) %>% 
  
  group_by(country) %>% 
  
  mutate(kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         education = replace_na(education, median(education, na.rm = TRUE)),
         prbonds = replace_na(prbonds, median(prbonds, na.rm = TRUE)),
         pcrdbgdp = replace_na(pcrdbgdp, median(pcrdbgdp, na.rm = TRUE)),
         stmktcap = replace_na(stmktcap, median(stmktcap, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(mfiid) %>% 
  
  mutate(asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)), 
         
         percent_of_female_borrowers = replace_na(percent_of_female_borrowers, 
                                                  
                                                  median(percent_of_female_borrowers, na.rm = TRUE)),
         
         operational_self_sufficiency = replace_na(operational_self_sufficiency, 
                                                   
                                                   median(operational_self_sufficiency, na.rm = TRUE)),
         
         assets = replace_na(assets, median(assets, na.rm = TRUE)),
         
         donations = replace_na(donations, median(donations, na.rm = TRUE)),
         
         donations_assets_ratio = replace_na(donations_assets_ratio, 
                                             
                                  median(donations_assets_ratio, na.rm = TRUE)), 
         
         profit_margin = replace_na(profit_margin, median(profit_margin, na.rm = TRUE)),
         
         capital_asset_ratio = replace_na(capital_asset_ratio, median(capital_asset_ratio, na.rm = TRUE)),
         
         debt_to_equity_ratio = replace_na(debt_to_equity_ratio, median(debt_to_equity_ratio, na.rm = TRUE)),
         
         operating_expense_assets = replace_na(operating_expense_assets, median(operating_expense_assets, na.rm = TRUE)),
         
         deposits_to_total_assets = replace_na(deposits_to_total_assets, median(deposits_to_total_assets, na.rm = TRUE)), 
         
average_loan_balance_per_borrower = replace_na(average_loan_balance_per_borrower, median(average_loan_balance_per_borrower, na.rm = TRUE)),
    
liabilities_and_equity = replace_na(liabilities_and_equity, median(liabilities_and_equity, na.rm = TRUE)  
         
         )) %>% 
  
  ungroup() %>% 
  
  group_by(region) %>% 
  
  mutate(education = replace_na(education, median(education, na.rm = TRUE)),
         
         kkm = replace_na(kkm, median(kkm, na.rm = TRUE)),
         
         gdp_growth_annual = replace_na(gdp_growth_annual, 
                                        
         median(gdp_growth_annual, na.rm = TRUE))) %>% 
  
  ungroup() %>% 
  
  group_by(currentlegalstatus) %>% 
  
  mutate(assets = replace_na(assets, median(assets, na.rm = TRUE)), 
         
         percent_of_female_borrowers = replace_na(percent_of_female_borrowers, 
                                                  
                        median(percent_of_female_borrowers, na.rm = TRUE)),
         
         operational_self_sufficiency = replace_na(operational_self_sufficiency, 
                                                   
                        median(operational_self_sufficiency, na.rm = TRUE)),
         
         donations = replace_na(donations, median(donations, na.rm = TRUE)),
         
         donations_assets_ratio = replace_na(donations_assets_ratio, 
                                             
                                  median(donations_assets_ratio, na.rm = TRUE)),
         
         profit_margin = replace_na(profit_margin, median(profit_margin, na.rm = TRUE)),
         
         capital_asset_ratio = replace_na(capital_asset_ratio, median(capital_asset_ratio, na.rm = TRUE)),
         
         asset_structure = replace_na(asset_structure, median(asset_structure, na.rm = TRUE)),
         
         debt_to_equity_ratio = replace_na(debt_to_equity_ratio, median(debt_to_equity_ratio, na.rm = TRUE)),
         
         operating_expense_assets = replace_na(operating_expense_assets, median(operating_expense_assets, na.rm = TRUE)),
         
average_loan_balance_per_borrower = replace_na(average_loan_balance_per_borrower, median(average_loan_balance_per_borrower, na.rm = TRUE)),
         
         deposits_to_total_assets = replace_na(deposits_to_total_assets, median(deposits_to_total_assets, na.rm = TRUE)), 
         
liabilities_and_equity = replace_na(liabilities_and_equity, median(deposits_to_total_assets, na.rm = TRUE))
         
         ) %>% 
  
  ungroup() %>% 
  
  mutate(dummy = if_else(currentlegaldummy == "NGO", 0, 1)) %>% 
  
  mutate(assets = log(assets + 1),
         
         pcrdbgdp = log(pcrdbgdp + 1),
         
         stmktcap = log(stmktcap + 1),
         
         prbonds = log(prbonds + 1)) %>% 
  
  add_count(mfiid, name = "count") %>% 
  
  mutate(currentlegalstatus = fct_recode(currentlegalstatus, Coop = "Credit Union/ Cooperative")) %>% 
  
  mutate(finsoc = case_when(operational_self_sufficiency >= 1 & percent_of_female_borrowers > 0.5 ~ "SS",
                            
                            operational_self_sufficiency > 1 & percent_of_female_borrowers < 0.5 ~ "SF", 
                            
                            operational_self_sufficiency < 1 & percent_of_female_borrowers >= 0.5 ~ "FS",
                            
                            TRUE ~ "FF")) %>% 
  
mutate(finsoc = factor(finsoc, levels = c("FF", "SF", "FS", "SS"))) %>% 
  
## replace negative donations with zero
mutate(donations = case_when(donations <= 0 ~ 1,
                             TRUE ~ donations))
## Write a csv for the data
my_data %>% write.csv(., "data.csv")

## Visualize missing data
#md.pattern(data)
## Amelia::missmap(data)

## MFIs with three (3) or more years of data
data3 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 3)
  
data3 %>% write.csv(., "data3.csv")

## MFIs with three (3) or more years of data
data5 <- my_data %>% 
  
  group_by(mfiid) %>% 
  
  filter(n() > 5)  
  
data5 %>% write.csv(., "data5.csv")
```


######################################################################### 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
### Important functions ----
## Regression function - fixed, random and pooling
modelling <- function(data, depvar,
                      effect = c("individual", "twoways", "time", "nested"),
                      model = c("within", "random", "ht", "between", "pooling", "fd"),
                      inst.method = c("bvk", "baltagi", "am", "bms"),
                      random.method = c("swar", "amemiya", "walhus", "nerlove"),
                      digits = 4, index = c("mfiid", "year")){
  
## Load libraries
  library(plm)
  library(broom)
  library(pcse)
  library(car)
  library(zoo)
  library(lmtest)
  library(broom)
  library(stargazer)
  
  ## match arguments
  effect <- match.arg(effect)
  model <- match.arg(model)
  inst.method <- match.arg(inst.method)
  random.method <- match.arg(random.method)
  
  ## Run the Model
  unadjusted <- plm(depvar ~ currentlegalstatus + 
            age + legal_tradition + kkm +
+           asset_structure + pcrdbgdp + stmktcap +
            profit_margin + year, 
          data = data, effect = effect,
          model = model,inst.method = inst.method, 
          index = index, 
          digits = digits)

unadjusted
}
```

########################################################################## 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Hausmann Test function
hausmann_test <- function(data, depvar){
  
  library(plm)
  library(broom)
  library(pcse)
  library(car)
  library(zoo)
  library(lmtest)
  library(broom)
  
  fixed <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin, 
               data = data, effect = "individual", model = "within", 
      index = c("mfiid", "year")) 
  
  random <- plm(depvar ~ currentlegalstatus + age + region +
+           operating_expense_assets + 
+           donations_assets_ratio + 
+           capital_asset_ratio +
+           asset_structure + log(assets) + 
+           education + profit_margin, 
          data = data, effect = "individual", model = "random", 
      index = c("mfiid", "year"))
 
  broom::tidy(phtest(fixed, random))
}

```

############################################ 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Median function
median_n <- function(x){median(x, na.rm = TRUE)}
```

############################################ 

```{r, echo = FALSE, message = FALSE, warning = FALSE}
theme_niwot <- function(){
  theme_bw() +
    theme(axis.text = element_text(size = 7), 
          axis.title.x = element_blank(),
          axis.title.y = element_text(size = 8),
          axis.line.x = element_line(color="black"), 
          axis.line.y = element_line(color="black"),
          panel.border = element_blank(),
          panel.grid.major.x = element_blank(),                                          
          panel.grid.minor.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          panel.grid.major.y = element_blank(),  
          plot.margin = unit(c(1, 1, 1, 1), units = , "cm"),
          plot.title = element_text(size = 10, vjust = 1, hjust = 0),
          legend.text = element_text(size = 8),          
          legend.title = element_blank(),                              
          legend.position = c(0.95, 0.15), 
          legend.key = element_blank(),
          legend.background = element_rect(color = "black", 
                                           fill = "transparent", 
                                           size = 2, linetype = "blank"))
}
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
###########################################
#' ggplot Flat Violin
#' @export
#' @details Copy-pasted from https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R
#' somewhat hackish solution to:
#' https://twitter.com/EamonCaddigan/status/646759751242620928
#' based mostly on copy/pasting from ggplot2 geom_violin source:
#' https://github.com/hadley/ggplot2/blob/master/R/geom-violin.r
#' @examples:
#' ggplot(diamonds, aes(cut, carat)) +
#'   geom_flat_violin() +
#'   coord_flip()
#' @import ggplot2
geom_flat_violin <- function(mapping = NULL, data = NULL, stat = "ydensity",
                             position = "dodge", trim = TRUE, scale = "area",
                             show.legend = NA, inherit.aes = TRUE, ...) {
  layer(
    data = data,
    mapping = mapping,
    stat = stat,
    geom = GeomFlatViolin,
    position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = list(
      trim = trim,
      scale = scale,
      ...
    )
  )
}

#' @rdname ggplot2-ggproto
#' @format NULL
#' @usage NULL
#' @export
GeomFlatViolin <-
  ggproto("GeomFlatViolin", Geom,
          setup_data = function(data, params) {
            data$width <- data$width %||%
              params$width %||% (resolution(data$x, FALSE) * 0.9)

            # ymin, ymax, xmin, and xmax define the bounding rectangle for each group
            data %>%
              group_by(group) %>%
              mutate(ymin = min(y),
                     ymax = max(y),
                     xmin = x,
                     xmax = x + width / 2)

          },

          draw_group = function(data, panel_scales, coord) {
            # Find the points for the line to go all the way around
            data <- transform(data, xminv = x,
                              xmaxv = x + violinwidth * (xmax - x))

            # Make sure it's sorted properly to draw the outline
            newdata <- rbind(plyr::arrange(transform(data, x = xminv), y),
                             plyr::arrange(transform(data, x = xmaxv), -y))

            # Close the polygon: set first and last point the same
            # Needed for coord_polar and such
            newdata <- rbind(newdata, newdata[1,])

            ggplot2:::ggname("geom_flat_violin", GeomPolygon$draw_panel(newdata, panel_scales, coord))
          },

          draw_key = draw_key_polygon,

          default_aes = aes(weight = 1, colour = "grey20", fill = "white", size = 0.5,
                            alpha = NA, linetype = "solid"),

          required_aes = c("x", "y")
  )


"%||%" <- function(a, b) {
  if (!is.null(a)) a else b
}
###########################################################
```

```{r, echo = FALSE, message = FALSE, warning = FALSE}
# plotting function
plotter <- function(data, x , y, z, xlabel, ylabel, title){
  
  library(tidyverse)
  library(ggthemes)
  library(gghalves)
  library(ggalt)  
  library(ggrepel)  # for annotations
  library(viridis)  # for nice colors
  library(broom)  # for cleaning up models
  library(treemapify)  # for making area graphs
  library(wesanderson)  # for nice colors
  
  ggplot(data = data, mapping = aes(x = reorder({{x}}, {{y}}, median_n), 
  y = {{y}}, fill = {{z}})) + 
  geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8, aes(fill = {{z}})) +
  geom_half_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) + 
    geom_point(position = position_jitter(width = 0.15), size = 1, alpha = 0.1) + 
    scale_y_log10() + labs(y = ylabel, x = xlabel, 
  title = title) + 
  theme_niwot() + 
  theme(legend.position = "none") + 
  stat_summary(fun = mean, geom = "point", 
                size = 1, color = "red")}

##################################################
second_plotter <- function(data, x , y, z, xlabel, ylabel, title){

library(ggalt)  
library(ggrepel)  # for annotations
library(viridis)  # for nice colours
library(broom)  # for cleaning up models
# devtools::install_github("wilkox/treemapify")
library(treemapify)  # for making area graphs
library(wesanderson)  # for nice colours

  ggplot(data = data, 
           mapping = aes(x = reorder({{x}}, {{y}}, median_n), y = {{y}}, fill = {{z}})) +
    
    # The half violins
    geom_flat_violin(position = position_nudge(x = 0.2, y = 0), alpha = 0.8) +
    
    # The points
    geom_point(aes(y = {{y}}, color = {{x}}), 
    
    position = position_jitter(width = 0.15), size = 1, alpha = 0.1) +
    
    # The boxplots
    geom_boxplot(width = 0.2, outlier.shape = NA, alpha = 0.8) +
    
    # \n adds a new line which creates some space between the axis and axis title
    labs(x = xlabel, y = ylabel, title = title) +
    
    # Removing legends
    guides(fill = FALSE, color = FALSE) +
    
    # Setting the limits of the y axis
    #scale_y_continuous(limits = c(0, 1.2)) +
    
    # Picking nicer colours
    scale_fill_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    scale_colour_manual(values = c("#5A4A6F", "#E47250",  "#EBB261", "#9D5A6C", "#FFFF80FF")) +
    
    theme_niwot() + scale_y_log10()
}

##################################################
# plotting scatter diagrams 
plotter_scatter <- function(data, x, y, z, 
                            xlab, ylab, title) {
  
  # Load libraries
  library(tidyverse)
  library(gghalves)
  library(ggeasy)
  library(ggthemes)
  
  # write the function
  data %>% ggplot(aes(x = {{x}}, y = {{y}}, col = {{z}})) + 
    
    geom_point(shape = 1, size = 2) + 
    
    labs(x = xlab, y = ylab, title = title)
}
```


```{r, echo = FALSE, message = FALSE, warning = FALSE}
remove_outliers <- function(x, na.rm = TRUE, ...) {
  qnt <- quantile(x, probs=c(.10, .90), na.rm = na.rm, ...)
  H <- 1.5 * IQR(x, na.rm = na.rm)
  y <- x
  y[x < (qnt[1] - H)] <- NA
  y[x > (qnt[2] + H)] <- NA
  y
}


data_wins_capital_structures <- my_data %>% 
  
  select(where(is.numeric), -mfiid, -year)


data_wins <- sapply(data_wins_capital_structures, remove_outliers) %>% 
  
  cbind(my_data[,c("mfiid", "mfiname", "region", "year", "age", 
                   
                   "currentlegalstatus", "legal_tradition")]) %>% 
  
  na.omit() %>% 
  
  relocate(mfiid:legal_tradition)
```


\newpage

## Background

@bayai2016financing cite institutional theory in explaining the way microfinance institutions (MFIs) in Africa fund their operations. They note that most MFIs tend to operate as Non-Governmental Organisations (NGOs) at the early stages. These NGOs derive substantial funding from donations and concessionary funds, given that commercial funders deem the MFIs too risky [@ledgerwood1998microfinance; @ledgerwood2006transforming]. Later, in the consolidation stage, the NGOs supplement their funds using government subsidies and equity funding. As they mature, they resort to deposits and debt whilst often using foreign donors as guarantees. At this stage, MFIs are likely to mutate from NGOs that focus on the social aspect of availing financial services to the financially excluded to the commercial model, where financial sustainability matters as much as social performance. 

The transformation of MFIs from NGOs to the commercial model has raised concern over mission drift. Mission drift happens when MFIs focus more on profitability and less on the social aspect of reaching the unbanked [@mia2017mission; @ramus2017stakeholders]. Also, some researchers argue that the hybrid business model of most MFIs makes it challenging to integrate them into the formal financial system as financiers deem them too risky for the level of return they offer [@campion1999institutional]. Conversely, the core argument for the institutional transformation of MFIs from the NGO, not-for-profit model, to the commercial model is access to capital markets. Advocates of the financial sustainability model of MFIs posit that capital market funding allows for improved corporate governance and reduces dependence on volatile donor funding [@garmaise2013cheap; @armendariz2013subsidy]. Financial sustainability also enables MFIs to reach more unbanked people in the long run [@tchakoute2010there]. 

Indeed, many MFIs are transitioning from the NGO not-for-profit model to the financial sustainability approach globally and in Africa. They strive to generate profit over and above meeting their social goal [@hudon2010management; @wagenaar2012institutional; @kodongo2013individual]. Having grown on a donations dependent model, the shift to the commercial model has implied a change in the business model, and most importantly, a search for a steady source of capital beyond donations and subsidies [@armendariz2013subsidy].

Table 1 shows the sources of financing for MFIs in Africa. As expected, NGOs are least reliant on debt compared to other MFI models. Rural banks, commercial banks, Credit unions and NBFIs, respectively, have the most debt relative to assets. The picture is the exact opposite for capital to assets ratio, where NGOs lead while rural banks trail. NGOs have the lowest median deposits to assets ratio, probably arising from the legal restrictions on deposit mobilisation. Lastly, and not surprisingly, NGOs have the highest median donations to assets. While the data shows some regularity in terms of the legal status of MFIs, it is notable that some MFIs are shifting from the NGO model to the commercial model, mainly as commercial banks and NBFIs [@sarma2011ngo; @jia2016commercialization]. For the NGOs converting to the commercial model, the likelihood of alternative, sustainable sources of finance is a vital consideration. 

This article examines the factors that determine the source of financing for MFIs in Africa, beyond the institutional life cycle proposition of @bayai2016financing. Specifically, we explore the drivers of two primary capital structure indicators; leverage (debt to equity ratio), equity (capital to assets ratio), deposits (deposits to assets ratio) and finally, donations (donations to assets ratio).  The existing literature on capital structure choices predominantly focuses on commercial (profit-oriented) firms [@gropp2010determinants; @liu2017optimal; @matias2017there]. The drivers of financing for MFIs may differ from those of purely commercial firms because the social goals of MFIs may conflict with those of the commercial providers of funds. Nonetheless, the extant literature on the funding structure of MFIs mainly examines the link between capital structure and the performance and sustainability of MFIs [@kyereboah2007determinants; @khachatryan2017performance]. 

In this respect, three studies by [@kyereboah2007determinants; @tchuigoua2014institutional; @tchuigoua2015capital] closely resonate with our work. However, in these studies, the researchers focus chiefly on the determinants of leverage (debt-to-equity ratio) for MFIs and find leverage to be positively related to asset tangibility, size, past-due loans, and inversely related to creditor rights and risk; confirming the literature on capital structure. Profitability and credit ratings have a limited impact on capital structure, while financial development and legal tradition are significant. @@tchuigoua2014institutional further finds that donations are negatively related to past-due loans and asset tangibility, implying donors do care about firm riskiness. None of the studies delves into the capital to assets ratio. 

The contribution of our study goes beyond previous research in this area of scholarship in two respects: context and scope. Prior studies dwell exclusively on leverage (debt-equity ratio) while our study examines leverage, capital-assets ratio. The additional financing structure measures are essential for MFIs transitioning to the financial sustainability model as they must source funds externally. Besides, this study goes beyond that of @kyereboah2007determinants that examined MFIs in Ghana only by focusing on Africa, thus allowing for cross-country comparisons. As @d2017ngos cautions, research-based on geographically dispersed regions could mask important regional characteristics, as is the case with the research by @tchuigoua2014institutional and @tchuigoua2015capital Tchakoute-Tchuigoua that draws from a global dataset. This study will allow for deeper insights and comparison using data from a relatively homogeneous region by focusing on Africa. Such knowledge would, in turn, permit us to evolve more effective funding strategies to support and enable the unique added benefit of MFIs (that is, financial inclusion for the poor) that is particularly significant for emerging and developing economies and, in particular, Africa. 

The following section highlights the study results, followed by a review of supporting theory and empirical literature. We then describe data and data sources, followed by the research method. We discuss the results and then conclude. 

## Summary of Results 
The results of the data analysis show that the age of an MFI and governance/ institutional quality are the chief drivers of leverage (debt to equity ratio). The capital to assets ratio for MFIs in Africa has statistically significant relationships with MFI legal status, age, and legal tradition. MFI legal status, age, legal tradition, and profit margin are the key drivers of the deposits to assets ratio. MFI legal form, age, legal tradition, institutional quality, asset structure, private credit, and profit margin drive the donations to assets ratio. Young and mature MFIs have lower leverage relative to new MFIs. At the same time, institutional quality has a negative relationship with the debt to equity ratio. However, after removing influential observations, MFI legal form, asset structure, and profit margin become statistically significant leverage drivers. Specifically, NGOs have lower leverage than the commercial MFIs: banks, credit unions, NBFIs, and rural banks. Asset structure has a negative relationship with the debt to equity ratio, meaning that MFIs with more tangible assets finance their operations using relatively more equity than debt. Likewise, the profit margin negatively affects the debt to equity ratio, given that profits are part of equity. 

NGOs have a consistently lower capital to assets ratio than other legal forms. Older MFIs have lower capital to assets proportions , while institutional quality negatively affects capital assets ratio. The relationship between the percentage of capital to assets and asset structure is mixed. Stock market capitalisation to GDP has a negative relationship with capital to assets ratio, while profit margin has a weak positive relationship. After removing outliers, assets structure shows a positive relationship with capital assets ratio, while private credit to GDP has a significant positive relationship with capital to assets ratio. NGOs have consistently lower deposits to assets ratio than other legal forms of MFIs.

In comparison, MFIs in civil and other legal traditions have a higher ratio than MFIs in civil law countries. Ceteris paribus, asset structure has a positive relationship with deposits to assets ratio. Without outliers, institutional quality private credit to GDP, stock market capitalisation to GDP, and profit margin also have a statistically significant relationship with deposits to assets ratio. Finally, the considerable drivers of the donations to assets ratio are MFI legal form, age, legal tradition, institutional quality, asset structure, private credit to GDP and profit margin. Specifically, NGOs have a higher ratio of donations to assets, while older MFIs and MFIs located in countries with civil law and other legal traditions have a lower ratio. Profit margin has a negative relationship with the donations to assets ratio, while institutional quality, assets structure, and private credit to GDP have the opposite effect. 

\blandscape

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## The data
my_data %>% 
  
  ## Get summaries for each legal status
  group_by(currentlegalstatus) %>% 
  
  ## Summarise to get mean, SD, min, Q1, median, Q3, and Max
  skim_without_charts(debt_to_equity_ratio, capital_asset_ratio, 
                      
                      ## More variables
                      deposits_to_total_assets, donations_assets_ratio) %>%
  
  select(-complete_rate, -n_missing, -skim_type) %>% 

  rename(Variable = skim_variable, Legal_form = currentlegalstatus, 
         
         Mean = numeric.mean, SD = numeric.sd, 
         
         Min = numeric.p0, Q1 = numeric.p25,
         
         Median = numeric.p50, Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  mutate(Variable = if_else(Variable == "debt_to_equity_ratio", "Debt/Equity", 
                            
                            Variable), 
         
         Variable = if_else(Variable == "capital_asset_ratio", "Capital/Assets", 
                            
                            Variable), 
         
         Variable = if_else(Variable == "donations_assets_ratio", "Donations/Assets", 
                            
                            Variable),
         
         Variable = if_else(Variable == "deposits_to_total_assets", "Donations/Assets", 
                            
                            Variable)
         
         
         ) %>% 
  
  kbl(., caption = "Summary Statistics for Categrical Independent Variables", 
      
      booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE, font_size = 8) %>% 
  
  footnote(general = "Authors' construction from the MIX data",
           
           general_title = "Source: ",
           
           number = c("N = 4782", "Legal status include NGO, Non-Bank Financial Institutions (NBFIs), Credit Unions, and Banks", "Age has mature MFIs older than 8 years, young ones (4 - 8 years), and new ones that are 4 years or less"),
           number_title = "Note: ")
```

\elandscape


## Theoretical Framework 

Like commercial firms, MFIs draw their capital from equity, debt (including deposits). Unlike commercial firms, MFIs have a substantial source of capital in the form of donations and subsidies (DâEspallier et al., 2013). As noted, despite the notable difference in financing structure, the empirical research on the financing of MFIs mainly relates to debt-equity mix [@kyereboah2007determinants; @tchuigoua2014institutional; @tchuigoua2015capital]. This study seeks to examine the drivers of the more comprehensive financing structure of MFIs concerning leverage and capital (equity) to assets ratio. The study draws its theoretical frame from two theories: the capital structure and institutional (life cycle) theories. 

The capital structure theories seek to explain the mix of long-term debt and equity in the financing structure of enterprises [@ehrhardt2016corporate]. The dominant literature in this respect revolves around the Modigliani & Miller capital structure theories, of which the trade-off theory against predominant [@sun2016ownership]. The classic trade-off theory holds that the debt-equity mix is relevant insofar as it generates a debt tax shield that organisations balance with the costs of possible financial distress that comes with high debt levels [@liu2017optimal]. Further, financial distress explains why firms favour easily negotiable debt, making firms approve bank loans in place of sourcing debt funds via capital markets [@de2011firms].

The implication is that mature, profitable firms rely on internal capital sources as do firms with little cash flows and intangible assets. In this case, the trade-off theory corresponds with the pecking order theory of Donaldson and Fox (1961) and @myers1984corporate, which posits that firms issue capital in a predetermined order, usually starting with the cheapest internal sources of funds while maintaining a reserve borrowing capacity. In the case of MFIs, we presume that donations and subsidies would come first in the pecking order. The reserve borrowing capacity allows firms to arrange debt funds quickly in case of profitable opportunities that arise. Moreover, the trade-off theory corresponds with the proposition by @bayai2016financing that the capital structure of MFIs evolves with the institutional life-cycle of firms. Younger firms are more proportionately reliant on donations and concessionary funds. Older firms more inclined to commercial funding. 

@bradley1984existence extended the trade-off theory, showing that, under certain conditions, the tax disadvantage of debt at the individual level offset the tax disadvantage at the corporate level. The result was the introduction of leverage related costs to the classical trade-off theory. These costs include the bankruptcy costs, agency costs of debt, the loss of non-debt tax shields (such as accelerated depreciation and investment tax credits). The additional leverage related costs mean that firms seek to balance the tax benefits of debt and the leverage-related costs. @miao2005optimal show that the choice of financing mix relates to these non-debt tax shields, in addition to financial and trade cycles. Hence the capital structure is firm-specific and mean-reverting. Still, the capital structure theories cannot explain the observed under-leveraged firms. Moreover, while the profit motive drives commercial firms, the capital structure theories may not fully apply to hybrid firms with a dual mission, like MFIs.

The institutional theory does have some congruence with the capital (financial) structure of MFIs. The observed rise in debt financing and the concurrent drop in donations could point to a shift by MFIs towards a financially sustainable MFI model. The pressure to move towards the financial sustainability model could reflect a broader change in the MF industry or result from pressure from donors, signalling fatigue and the intent to withdraw or reduce funding. The pressure would be incredibly intense for MFIs that are highly dependent on donations [@powell2012new], underlining the role of donors such as USAID in the push towards sustainability [@bateman2010doesn]. Although the institutional theory cannot fully account for the MFIs that have not changed from NGOs to commercial models, the changing capital structures indicate that financial sustainability is gaining traction. Figure 6.4 shows that even without a change in legal forms, the proportion of donations to MFIs in Africa is dropping. The following section details the empirical approach adopted in the study. 

## Method

The study adopts the fixed and random effects models depending on the outcome of the Hausman tests (see appendix 2). Following @roberts2013endogeneity. We consider the model that follows.


$Y_{it} = \beta_{0} + \beta_{1}X_{it} + \mu_{it}$


Further, assume that,


$\mu_{it} = C_{i} + \epsilon_{it}$


Where  $c_{i}$ captures the aggregate effects of the unobserved, time-invariant explanatory variables for $Y_{it}$ . Further, assume that $e_{it}$ has zero mean conditional on $X_{it}$. In the case where $C_{i}$ and $X_{it}$ are correlated, then $C_{t}$ is a fixed effect; otherwise, it is a random effect. Note that the existence of fixed effects implies the presence of endogeneity. For random effects, on the other hand, endogeneity is not a concern. However, the random-effects model affects the computation of standard errors (Roberts & Whited, 2013).

Thus, the fixed effects models seek the causes of changes within an entity. The fixed-effects model does this by controlling for all time-invariant differences between the individuals, so the estimated coefficients of the fixed-effects models cannot be biased because of omitted time-invariant characteristics, such as culture [@torres2007panel]. To deal with the endogeneity inherent in the fixed effects model, researchers recommend two strategies. The first approach involves the inclusion of firm-specific intercepts by running the least squares dummy variable regression. The method is not feasible with medium to large datasets. In the alternative within-estimator approach, researchers apply OLS to the deviations-from-the-within estimator, eliminating the fixed effect prone to endogeneity. The within-estimator regression is as follows ^[For a more detailed but simplified discussion on the derivation and application of the within-estimator, refer to Roberts and Whited (2013), pp. 558.]. 

\begin{equation}
Y_{it} = \beta_{1} \Delta X_{it} + \Delta \mu_{it}
\end{equation}

However, the model does not deal with the potential endogeneity between  $\Delta X_{it}$ and $\mu_{it}$. Differencing also reduces the efficiency of estimates if the fixed effect (differenced out of the model) and the dependent variable correlate strongly [@clark2015should]. Consequently, we run both fixed and random effects, even where the Hausmann test recommends one over the other.

### Variables Definitions and Data Sources 

We source panel data from the Microfinance Information Exchange (MIX) pooled database, the Worldwide Governance Indicators (WGI), and World Development Indicators (WDI) from the World Bank databases. Table 6. 2 below describes the variables.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
tribble(~ Variable_Description, 

"1. Debt-to-Equity Ratio: The ratio of total liabilities to equity, the amount of leverage supported by each unit of capital contributed by shareholders. The ratio shows how an MFI finances its portfolio of assets beyond equity capital to cushion or absorb losses when total assets fall short of all liabilities. Much of the extant research examines the debt-equity mix and its relationship with the performance of MFIs",

"2. Deposits to Total Assets: The ratio of deposits to assets that aids in determining the extent to which MFIs use deposits to finance assets. NGOs transitioning to the commercial model can mobilise deposits  to fund their operations over and above donations and equity",

"3. Capital to Assets Ratio: The ratio of total equity to total assets and a slightly modified reciprocal debt-to-equity ratio. Hence, it captures the ability to meet obligations and to absorb unexpected losses using capital contributions by the owner (Kimmel, Weygandt, & Kieso, 2018)",
        
"4. Current Legal Status: The legal forms of registration of an MFI are as follows; Commercial Bank, Non-Bank Financial Institution (NBFI), Non-Governmental Organization (NGO), Credit Union/ Cooperative, or Rural Bank. The legal status may dictate the profit orientation and sources of capital for the MFIs. The legal status of an MFI may impact the financing structure in several ways. First, legal status or form typically restricts NGOs from taking deposits, which lowers the debt-equity ratio and deposits to assets, raising the capital asset ratio. Also, NGOs may not venture into capital markets for funds, given their mostly not-for-profit orientation. The opposite is the case for MFIs of commercial banks legal form whose legal status allows for deposits.", "", 
        
"5.	Age: MIX classifies MFIs into three categories depending on the time that has elapsed since the MFI started operations- new (0-4 years), young (4-8 years) and mature (over eight years). The variable is hence a dummy. Older firms are likely better established, have a solid reputation and hence likely to attract more debt and deposits. The institutional life cycle view of Bayai and Ikhide (2016) captures the correspondence between age and debt.", "", 

"6. Legal Tradition (Legal): The indicator is a dummy variable with common law countries coded 0, civil law countries 1, and 2 otherwise as per the classification by Oto-PeralÃ­as and Romero-Ãvila (2014). Typically, common law countries have relatively better financial infrastructure that allows firms to access financial markets easily. Hence, MFIs in common law countries may exhibit higher debt and equity ratios in their capital structures than those in common law and other legal traditions. (Schnyder, Gerhard, Mathias Siems, & Ruth V. Aguilera, 2018)", "", 

"7. Size (Log of Total Assets): We proxy the size of MFI with the natural logarithm of total assets, again using MIX data. Assets are supported by the sum of capital and liabilities or, equivalently, the total value of resources owned or controlled by the MFI resulting from past and current activities and from which the MFI derives future benefits. We expect firms with more assets to have a higher debt capacity and more debt-to-equity ratios, and lower capital to equity ratios. Large firms draw their strength from holding diversified investments and hence higher capacity to absorb risk. Besides, they have easy access to debt markets(Kurshev & Strebulaev, 2015). Furthermore, these firms are likely to attract more deposits, given the trust they inspire in depositors and their marketing reach (Kimmel et al., 2018). We hypothesise that donations vary positively with the size of MFI, as large, older firms have established a reputation with donors.", "", 

"7. Governance/ Institutional Quality (KKM): We create the country level KKM index using the first principal component of the WGI available in the World Bank databases. The index captures the institutional quality in corruption control, government effectiveness, political stability, the rule of law, and voice and accountability (Kaufmann, Kraay, & Mastruzzi, 2011). Firms in countries with better governance can quickly raise debt finance due to ease of contract enforcement â the result, a high debt-equity ratio and a low capital asset ratio. Similarly, the level of deposits mobilisation may be higher in better-governed countries arising from consumer confidence in legislation relating to deposits protection (La Porta, Lopez-de-Silanes, & Shleifer, 2013; Allen et al., 2014). Lastly, MFIs in countries with low KKM may have higher donations as donors opt to circumvent corrupt government channels. We use the terms institutional quality and governance interchangeably throughout the text", "", 

"8. Private Credit to GDP: We capture the total amount of credit advanced to the private sector by financial intermediaries as a proxy for capital markets development concerning the banking sector following Ito and Kawai (2018). The data source is the Global Financial Development Database, GFDD, of the World Bank (See note 4). Private credit to GDP represents the financial resources provided to the private sector by domestic money banks as a share of GDP. Domestic money banks comprise commercial banks and other financial institutions that accept transferable deposits, such as demand deposits. The data is available in WDI. Financial sector development is central to the acquisition of both equity and debt financing. We hypothesise a high debt to equity ratio, and deposits to assets ratios in countries with more robust financial sectors as financial institutions tend to be highly leveraged.", "", 

"9. Stock market capitalisation to GDP: We capture the extent of stock market development using the ratio of stock market capitalisation to GDP to proxy how firms can raise equity capital. Although Africa's equity markets are thin, some relatively large stock markets like South Africa, Kenya, and Ghana exist. The data are from the GFDD.", "", 

"11. Education: Education is the ratio of gross secondary school enrolment to gross primary school enrolment that captures the extent of graduation from elementary to secondary education and the overall literacy rate. The data is available in the WDI. We hypothesise a positive relationship between education and debt/equity ratio, implying a lower capital asset ratio. Similarly, education may enhance the capacity of the populace to use financial products like savings, hence a higher deposit to assets ratio.  Also, education may directly or indirectly influence financial sector development, which eases the acquisition of capital in financial markets (Allen et al., 2014).", "", 

"12. Asset Structure (Tangibility): Asset structure is is measured as the ratio of non-current assets to total assets of an MFI (Microfinance Information Exchange (MIX), 2019). The ratio indicates the extent of investment in physical infrastructure, a significant issue in constraining banking for the poor due to the perceived lack of scale economies to warrant the erection, for instance, of brick and mortar branches (Ledgerwood, 1998). MFIs with a more significant physical presence are likely to attract more deposits. Therefore, they also have a higher capacity to borrow and service debt. Further, tangible assets serve as collateral to protect lenders from the moral hazard problem (Jensen & Meckling, 1976), and hence a positive relationship between debt and asset tangibility (Titman & Wessels, 1988; Kyereboah-Coleman, 2007a).", "", 

"13. Profit Margin: The profit margin is the net operating income divided by financial revenue. The ratio represents the ability of MFIs to generate income from the core mandate of offering financial services like lending, savings, insurance, and so on. Profitability may enhance the capacity of an MFI to secure debt, thus leading to a higher debt to equity ratio and low capital to assets ratio. The opposite is the case when an MFI retains earnings and hence raises the level of equity.", "") %>% 
  
  kbl(., caption = "Description of Variables", 
      
      booktabs = TRUE, longtable = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9, 
                
                latex_options = "repeat_header") %>% 
  
  footnote(number = c("MIX Database on www.themix.org and https://datacatalog.worldbank.org/dataset/mix-market", "WDI on https://databank.worldbank.org/source/world-development-indicators.", "WGI/ KKM on https://databank.worldbank.org/source/worldwide-governance-indicators.", "GFDD on https://www.worldbank.org/en/publication/gfdr/data/global-financial-development-database"), 
           
           number_title = "Notes",
    
           general = "Source: Authors' construction from the literature",
           
           general_title = "")
  
  #knitr::kable(caption = "Description of variables")
```


## Exploratory Data Analysis 

Figure 1 shows the correlation matrix and scatter plots for the numeric variables used in this work's empiricalmodel. Furthermore, the debt-to-equity ratio, capital-to-assets ratio, deposits to assets ratio, and donations to assets ratio (the first four entries of the rows and columns) are the dependent variables. The rest are the independent variables, including the donations to assets ratio. The main diagonal shows the distribution of the representative variables in place of correlations of a variable with themselves. The main diagonal shows that most variables are highly skewed, except for assets. The lower half of the Figure shows the pairwise scatter plots between the variables, with the axis interpreted as we do correlation matrices as described next.

\blandscape

```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  select(debt_to_equity_ratio, capital_asset_ratio, 
         
         deposits_to_total_assets, donations_assets_ratio, 
         
         assets, kkm, education, pcrdbgdp, stmktcap,
         
         gdp_growth_annual, profit_margin  
         
         ) %>% 
  
  skimr::skim_without_charts() %>% 
  
  select(-n_missing, -complete_rate, -skim_type) %>% 
  
  rename(Variable = skim_variable, Mean = numeric.mean, SD = numeric.sd, 
         
         Min = numeric.p0, Q1 = numeric.p25, Median = numeric.p50,
         
         Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  mutate(Variable = stringr::str_to_sentence(Variable)) %>% 
  
  kbl(., caption = "Summary Statistics", booktabs = TRUE) %>% 
  
  kable_paper(full_width = TRUE, font_size = 10) %>% 
  
  footnote( number_title = "Notes",
    
           general = "Authors' construction from MIX data",
           
           general_title = "Source: ")
  
```
\elandscape


\blandscape


```{r, fig.height = 6, fig.width = 9, fig.align='center', fig.cap="Correlation Matrix for Independent Variables", echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  select(debt_to_equity_ratio, capital_asset_ratio, 
         
         deposits_to_total_assets, donations_assets_ratio, 
         
         assets, kkm, pcrdbgdp, stmktcap, profit_margin) %>% 
  
 ggpairs(lower = list(continuous = wrap("points", alpha = 0.2, 
          color = "skyblue"), 
          combo = wrap("dot_no_facet", alpha = 0.1, size = 0.05)))
```


\elandscape

There is a substantial negative and significant relationship between capital-asset-ratio (which captures the ratio of equity capital to total assets) and deposits-assets-ratio for dependent variables. The correlations indicate that for MFIs that garner deposits, the injection of equity capital is not a priority as these MFIs, like commercial banks, tend to leverage on deposits and just put in enough equity to meet regulatory requirements. The debt to equity ratio and the deposits to asset ratio have a significant positive relationship, although the magnitude is not high. The capital to asset ratio and debt to equity ratio has no meaningful association. For the dependent variables, the highest observed correlation is between education on the one hand and the proxies for capital market development; private credit to GDP and stock market capitalisation to GDP, at 0.461 and 0,538, which is in line with the literature [@allen2013resolving; @allen2014african]. Consequently, we exclude education from our regressions. 

Finally, except for the debt to equity ratio, the other three independent variables significantly correlate with the dependent variables. Specifically, the debt to equity ratio has a low but significant correlation with the other dependent and independent variables. The capital asset ratio has no statistically significant correlation with profit margin and stock market capitalisation to GDP. Likewise, donations have no significant correlation with GDP growth and education, while deposits exhibit a substantial correlation with donations, institutional quality/ governance, and stock market capitalisation to GDP. While correlation does not imply causation, these results point to the need for further investigation. The following section on regression models revisits this result for an in-depth interrogation of the relationships. Table 6. 3 shows the summary statistics for the numeric variables while Table 6. 4 summarises the categorical variables. 

Figure 2 shows the breakdown of the dependent variables across MFI legal status. Note that rural banks and commercial banks have the highest median debt to equity and deposits to assets ratios, followed by credit unions, NBFI, and NGOs. The former could indicate ease in accessing capital markets. At the same time, deposits reflect the capacity of banks to mobilise deposits. Their focus on niche rural markets with the unbanked populace makes it easier to garner deposits for rural banks. The visualisation rightly shows that rural banks, commercial banks and cooperatives have the highest deposits to assets ratio.

Consequently, commercial banks, cooperatives, and rural banks have the lowest capital to assets ratio. The results show that commercial banks and rural banks emphasise offering a broader range of financial services, specifically savings products in place of credit alone. For NGOs, Garnering deposits is a challenge due to legal hurdles. Coupled with the emphasis on the social aspect of reaching the poor, NGOs would have a more significant difficulty accessing commercial funding compared to other legal types of MFIs. Reinforcing the welfare approach to microfinance, NGOs have the highest median donations to assets ratios, followed by NBFIs, while commercial banks and rural banks come last. These results arise out of the mission of MFIs, where donors fund MFIs that explicitly focus on social aspects of reaching the unbanked- meaning that donors still do value the welfare approach to microfinance.

Finally, Figure 6.4 shows the trends in the dependent variables over time, with the debt to equity ratio trending gradually upwards while the capital to assets ratio trends downwards. It shows that MFIs have steadily been increasing their debt capital over this period as they grow and get to access capital markets.  Likewise, deposits have been trending upwards as more MFIs reach a higher number of consumers or as they mature and get the legal mandate to garner deposits. The trend for the donations to assets ratio is like literature in microfinance suggests; donors have gradually reduced their relative contribution to MFIs. Alternatively, MFIs are less reliant on donations as they grow, given that donations form a decreasing proportion of their assets base. The implication here is that both donors and MFIs have gradually embraced the financial sustainability approach to microfinance, thus requiring MFIs to be financially sustainable while fulfilling their social mandate. Next, we discuss the results of the regressions. 

\blandscape

```{r, fig.height = 6, fig.width = 9, fig.align='center', fig.cap="Capital Sources by MFI Legal Status", echo = FALSE, message = FALSE, warning = FALSE}

(my_data %>% 
  
  select(currentlegalstatus, debt_to_equity_ratio, capital_asset_ratio, deposits_to_total_assets, 
         
         donations_assets_ratio) %>% 
  
  plotter(x = currentlegalstatus, 
          
          y = debt_to_equity_ratio, 
          
          z = currentlegalstatus, 
          
          xlabel = "Current Legal Status", 
          
          ylabel = "Debt to Equity Ratio", 
          
          title = "Debt to Equity Ratio by Legal Status") +


my_data %>% 
  
  select(currentlegalstatus, debt_to_equity_ratio, capital_asset_ratio, deposits_to_total_assets, 
         
         donations_assets_ratio) %>% 
  
  plotter(x = currentlegalstatus, 
          
          y = capital_asset_ratio, 
          
          z = currentlegalstatus, 
          
          xlabel = "Current Legal Status", 
          
          ylabel = "Capital Asset Ratio", 
          
          title = "Capital Asset Ratio by Legal Status")) /

(my_data %>% 
  
  select(currentlegalstatus, debt_to_equity_ratio, capital_asset_ratio, deposits_to_total_assets, 
         
         donations_assets_ratio) %>% 
  
  plotter(x = currentlegalstatus, 
          
          y = deposits_to_total_assets, 
          
          z = currentlegalstatus, 
          
          xlabel = "Current Legal Status", 
          
          ylabel = "Deposits to Total Assets", 
          
          title = "Deposits to Total_assets by Legal Status") +

my_data %>% 
  
  select(currentlegalstatus, debt_to_equity_ratio, capital_asset_ratio, deposits_to_total_assets, 
         
         donations_assets_ratio) %>% 
  
  plotter(x = currentlegalstatus, 
          
          y = donations_assets_ratio, 
          
          z = currentlegalstatus, 
          
          xlabel = "Current Legal Status", 
          
          ylabel = "Donations Assets Ratio", 
          
          title = "Donations Assets Ratio by Legal Status")) + 
  
  plot_annotation(title = "Capital Sources by MFI Legal Status", 
                  
                  caption = "Source: Authors' construction from MIX data")
```

\elandscape


\blandscape

```{r, fig.height = 6, fig.width = 9, fig.align='center', fig.cap = "Assets, Asset Structure, and Profit margin of MFIs in Africa", echo = FALSE, message = FALSE, warning = FALSE}
######################################
######################################
(my_data %>% 
  
  ggplot(aes(x = fct_reorder(age, asset_structure, mean), y = (asset_structure + 1), fill = age)) + 
   
  geom_violin() +
  
  geom_boxplot() + 
  
  theme(legend.position = "none") + 
  
  coord_trans(y = "log10") + 
   
  labs(x = "Age", y = "Asset Structure", 
       
       title = "Asset Structure by Age") +
   
   

########################################
my_data %>% 
  
  ggplot(aes(x = fct_reorder(age, assets, mean), y = assets, fill = age)) + 
  
  geom_boxplot() + 
  
  theme(legend.position = "none") + 
  
  coord_trans(y = "log10") + 
  
  labs(x = "Age", y = "Assets", title = "Assets of MFIs by Age")) 

```


\elandscape

\blandscape

```{r, fig.height = 6, fig.width = 9, fig.align='center', fig.cap="Trends in Capital, Debt, Deposits, and Donations", echo = FALSE, message = FALSE, warning = FALSE}
###########################################
(my_data %>% 
  
  select(mfiid, year, debt_to_equity_ratio) %>% 
  
  group_by(year) %>% 
  
  mutate(mean_data = mean(debt_to_equity_ratio)) %>% 
  
  ggplot(aes(x = year, y = mean_data)) + 
  
  geom_point() + 
  
  geom_smooth() + 
  
  labs(x = "Year", y = "Debt/Equity Ratio", title = "Trends in Debt to Equity Ratio") +

############################################################
my_data %>% 
  
  select(mfiid, year, capital_asset_ratio) %>% 
  
  group_by(year) %>% 
  
  mutate(mean_data = mean(capital_asset_ratio)) %>% 
  
  ggplot(aes(x = year, y = mean_data)) + 
  
  geom_point() + 
  
  geom_smooth() + 
  
  labs(x = "Year", y = "Capital/Assets Ratio", title = "Trends in Capital to Assets Ratio")) /

##############################################################
(my_data %>% 
  
  select(mfiid, year, deposits_to_total_assets) %>% 
  
  group_by(year) %>% 
  
  mutate(mean_data = mean(deposits_to_total_assets)) %>% 
  
  ggplot(aes(x = year, y = mean_data)) + 
  
  geom_point() + 
  
  geom_smooth() + 
  
  labs(x = "Year", y = "Deposits to Total Assets", title = "Trends in Deposits to Total Assets Ratio") +

###############################################################
my_data %>% 
  
  select(mfiid, year, donations_assets_ratio) %>% 
  
  group_by(year) %>% 
  
  mutate(mean_data = mean(donations_assets_ratio)) %>% 
  
  ggplot(aes(x = year, y = mean_data)) + 
  
  geom_point() + 
  
  geom_smooth() + 
  
  labs(x = "Year", y = "Donations/Assets Ratio", title = "Trends in Donations to Total Assets Ratio")) + 
  
  plot_annotation(title = "Trends in Capital, Debt, Deposits and Donations for MFIs in Africa", 
                  
                  caption = "Source: Authors' construction from MIX data")
```

\elandscape


```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
  
  select(asset_structure, assets, pcrdbgdp, 
         
         stmktcap, profit_margin, 
         
         pcrdbgdp, stmktcap) %>% 
  
  skim_without_charts() %>% 
  
  mutate(N = 4782) %>% 
  
  select(-complete_rate, -n_missing, -skim_type) %>% 

  rename(Variable = skim_variable, 
         
         Mean = numeric.mean, SD = numeric.sd, 
         
         Min = numeric.p0, Q1 = numeric.p25,
         
         Median = numeric.p50, Q3 = numeric.p75, Max = numeric.p100) %>% 
  
  relocate(N, .after = Variable) %>% 
  
  kbl(., caption = "Summary Statistics for Categrical Independent Variables", 
      
      booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9) %>% 
  
  footnote(general = "Source: Authors' construction from the MIX data",
           
           general_title = "",
           
           number = c("Legal status include NGO, Non-Bank Financial Institutions (NBFIs), Credit Unions, and Banks", "Age has mature MFIs older than 8 years, young ones (4 - 8 years), and new ones that are 4 years or less"),
           number_title = "Note: ")
```

## Regression Results
This section discusses the output from the regression models, starting with the debt to equity ratio, the capital to assets ratio, the deposits to total assets ratio, and the donations to assets ratio. Appendix 1 shows the results of the Hausmann Test and the choice over fixed and random effects models [@clark2015should]. For the Hausmann test, the null hypothesis is for the random-effects model [@torres2007panel]. The results favour the random-effects model, except for the model with debt to equity ratio as the response. For robustness, however, we run both fixed and random effects. The data at hand is an unbalanced panel.

For this reason, we ran a random-effects model on the full dataset. We then subset the data for instances with three or more years of data and then five or more years of data. These Figures (three and five) correspond to the mean and median number of years of data per MFI dataset. Finally, we run a pooled OLS and a fixed-effects model using the entire dataset.

### Drivers of Leverage (Debt to Equity Ratio)
Tables 5 shows the output of the relevant regression models with debt to equity ratio as the dependent variable. The regressions indicate that MFI age matters the most in determining the debt to equity ratio at the firm level. At the macro-level, institutional quality is a significant driver of leverage.

#### Age
Regarding age, new MFIs (0-4 years) in Africa have a significantly higher debt to equity ratio than young MFIs (4-8 years), on average. However, there is no significant difference between the leverage of new MFIs and mature MFIs (8 years and above), although the coefficient has a negative sign suggesting lower debt to equity ratio. This result means that the oldest firms and the newest MFIs tend to finance their operations with more equity than debt. Given that equity is riskier than debt, it follows that investors have more confidence in older MFIs and youngest MFIs. The capital structure theory does not mention the age of a firm as a significant driver of capital structure. However, suppose age has a direct correspondence with size. In that case, we expect that older, larger MFIs are more profitable (a source of internal equity) and can attract long term equity funding due to their track record [@barclay2005capital; @barclay2006debt]. The relatively high debt to equity ratio of new MFIs could reflect the emphasis on the financial sustainability of MFIs which makes start-ups resort to relatively more debt to finance their operations due to reduced availability of donations and government subsidies [@gwatidzo2009corporate]. Without the initial support from donors, equity funders deem start-up MFIs too risky. Without the initial seed capital in grants and concessionary funds, the institutional lifecycle theory of @bayai2016financing may not hold. 


#### Institutional Quality (KKM)
Institutional quality or governance (KKM) has an inverse relationship with the debt to equity ratio of MFIs in Africa. Higher KKM corresponds to a lower debt to equity ratio and vice versa, implying that MFIs in high KKM countries rely more on equity than debt. Research on capital structure theory shows that indeed governance matters in determining the ease of contract enforcement and safeguarding property rights [@butkiewicz2006institutional]. Governance also reflects the effective regulation of capital markets, hence better capital markets development [@matias2017there; @ombati2016effects]. In MFIs, better KKM may encourage long term equity investment relative to debt investment and thus the observed relationship.

\blandscape

```{r, results = "asis", echo = FALSE, message = FALSE, warning = FALSE}
########################
fixed_effects_de <- modelling(data = my_data, depvar = my_data$debt_to_equity_ratio)

fixed_effects_de3 <- modelling(data = data3, depvar = data3$debt_to_equity_ratio)

fixed_effects_de5 <- modelling(data = data5, depvar = data5$debt_to_equity_ratio)

random_effects_de <- modelling(data = my_data, depvar = my_data$debt_to_equity_ratio, model = "random")

random_effects_de3 <- modelling(data = data3, depvar = data3$debt_to_equity_ratio, model = "random")

random_effects_de5 <- modelling(data = data5, depvar = data5$debt_to_equity_ratio, model = "random")

pooling_de <- modelling(data = my_data, depvar = my_data$debt_to_equity_ratio, model = "pooling")

#####################################################

inference_m101 <- coeftest(fixed_effects_de, vcov = vcovBK(fixed_effects_de, method = "arellano", type="HC1", cluster = "group"))

inference_m111 <- coeftest(fixed_effects_de3, vcov = vcovBK(fixed_effects_de3, method = "arellano", type="HC1", cluster = "group"))

inference_m121 <- coeftest(fixed_effects_de5 , vcov = vcovBK(fixed_effects_de5 , method = "arellano", type="HC1", cluster = "group"))

inference_m131 <- coeftest(random_effects_de, vcov = vcovBK(random_effects_de, method = "arellano", type="HC1", cluster = "group"))

inference_m141 <- coeftest(random_effects_de3, vcov = vcovBK(random_effects_de3, method = "arellano", type="HC1", cluster = "group"))

inference_m151 <- coeftest(random_effects_de5, vcov = vcovBK(random_effects_de5, method = "arellano", type="HC1", cluster = "group"))


####################################################

stargazer(fixed_effects_de, fixed_effects_de3, 
     
     fixed_effects_de5, random_effects_de, random_effects_de3, random_effects_de5,
     
     se = list(inference_m101[,2], inference_m111[,2], inference_m121[,2], 
     
     inference_m131[,2], inference_m141[,2], inference_m151[,2]),
     
     title = "Regression Output for Debt to Equity Ratio (Standard Errors in Brackets)", 
     
     align = TRUE, font.size = "tiny", header = FALSE, 
     
     omit = c("year.", "Constant"),
     
     add.lines = list(c("Model", "Within", "Within", "Within", 
            
            "Random", "Random", "Random"), 
     
     c("Data", "Full", ">=3 Years", ">=5 Years", 
      
      "Full", ">=3 Years", ">=5 Years")))
```

\elandscape

### Drivers of Capital to Assets Ratio
Regression results for the drivers of the capital-assets ratio among MFIs in Africa appear in Table 6. 6. Capital assets ratio is the ratio of total equity to total assets. Again, legal status, age, legal tradition, and stock market development are related to the equity to total assets ratio. We examine these significant variables in turn. 

#### Current Legal Status
NGOs consistently have higher capital to assets ratio than other legal traditions: banks, cooperatives, NBFIs, and rural banks. The definition of debt to equity ratio means that NGOs finance their operations using more equity than debt. The results align with the institutional life cycle theory, which posits that MFIs often start financing operations using donations and concessionary funds, then switch to equity as they mature [@bayai2016financing]. Debt is often for well established MFIs, at which point they are likely financially sustainable and likely to switch to the commercial model [@d2017ngos]. NBFIs have the second-highest mean and median levels of capital to assets ratio, followed by banks, while cooperative and rural banks come last in that order. These results align with the literature confirming the high leverage of banks [@mettenheim2013back], with the bulk of the capital in deposits.

The results also reflect the market conditions where donations and subsidies are getting less available as donors begin to stress sustainability. Mature firms have a long-running relationship with donors to the extent they have a profitable business model and developed a business profile that allows them to make profits and issue equity. Characteristically, commercial banks and other deposit-taking institutions tend to be more leveraged than other financial intermediaries because they have the license and scale to garner deposits and other debt instruments, explaining the pattern of results. 

#### Age
The capital to asset ratio of MFIs in Africa decreases with age. Young (4-8 years) and mature (8 years and over) MFIs have lower capital to assets ratios, on average than new MFIs (0-4 years). The mean and median capital to assets ratio These results are also in line with the literature on capital structure. Older firms are likely larger with more support to pledge as collateral and quickly raise funds in the debt markets [@barclay2005capital]. Also, as MFIs mature, they are likely to graduate from the loans only model to start accepting deposits which further raises their leverage. Overall, this makes the equity component smaller relative to the debt component. In the capital structure literature, age is not a significant driver of the capital structure except through its link to the size of an MFI, as we discuss next. 

#### Legal Tradition
MFIs located in common law countries have, on average, higher capital to assets ratio than equivalent MFIs in civil law or other legal tradition countries. The results follow from the law and finance literature, showing that common law legal tradition corresponds to a higher level of capital market development, especially stock market development [@la2013law]. Civil law countries have the lowest mean and median capital to assets ratio confirming the law and finance literature in Africa's context [@schnyder2018twenty]. If capital markets and especially equity markets are more developed in common law countries, it means that MFIs can quickly issue equity financial instruments. Also, venture capitalists are more willing to inject private equity in MFIs in common law countries. The public equity markets offer an opportunity to exit the investment once it takes root [@kent2013bankers].

#### Stock Market Development
There is a weak negative but statistically significant relationship between stock market development and capital to assets ratio. It means that MFIs in countries with vulnerable stock markets have more equity relative to assets and vice versa. These results may reflect the bank-based versus capital market-based model of financing. Most economies in Africa follow the bank-based model [@gropp2010determinants], where firms mainly raise funds from commercial banks in loans instead of equity and debt markets. Effectively, there is a weak link between microfinance and the equity and debt market, reflecting the small coefficients [@ahmed2014financial]. MFIs appear to have little linkage with the equity markets, and even where they do, prefer retained earnings and private equity to listing publicly. Available evidence shows very few cases of MFIs that are publicly listed [@hishigsuren2006transformation]. 

#### Other Insignificant Variables
Governance or institutional quality (KKM), asset structure, private credit to GDP, and profit margin are statistically insignificant capital to assets ratio drivers. However, KKM and private credit to GDP both have a positive relationship with capital to assets ratio, reflecting the importance of institutions both in the development of debt and equity markets. The relationship between assets structure and profit margin on the one hand, and capital to assets ratio on the other, shows mixed results, which may highlight the low profitability of MFIs in Africa (see appendix 7). 
 
\blandscape

```{r, results = "asis", echo = FALSE, message = FALSE, warning = FALSE}
#####################################
fixed_effects_car <- modelling(data = my_data, depvar = my_data$capital_asset_ratio)

fixed_effects_car3 <- modelling(data = data3, depvar = data3$capital_asset_ratio)

fixed_effects_car5 <- modelling(data = data5, depvar = data5$capital_asset_ratio)

random_effects_car <- modelling(data = my_data, depvar = my_data$capital_asset_ratio, model = "random")

random_effects_car3 <- modelling(data = data3, depvar = data3$capital_asset_ratio, model = "random")

random_effects_car5 <- modelling(data = data5, depvar = data5$capital_asset_ratio, model = "random")

pooling_car <- modelling(data = my_data, depvar = my_data$capital_asset_ratio, model = "pooling")

##############################################
inference_m201 <- coeftest(fixed_effects_car, vcov = vcovBK(fixed_effects_car, method = "arellano", type="HC1", cluster = "group"))

inference_m211 <- coeftest(fixed_effects_car3, vcov = vcovBK(fixed_effects_car3, method = "arellano", type="HC1", cluster = "group"))

inference_m221 <- coeftest(fixed_effects_car5 , vcov = vcovBK(fixed_effects_car, method = "arellano", type="HC1", cluster = "group"))

inference_m231 <- coeftest(random_effects_car, vcov = vcovBK(random_effects_car, method = "arellano", type="HC1", cluster = "group"))

inference_m241 <- coeftest(random_effects_car3, vcov = vcovBK(random_effects_car3, method = "arellano", type="HC1", cluster = "group"))

inference_m251 <- coeftest(random_effects_car5, vcov = vcovBK(random_effects_car5, method = "arellano", type="HC1", cluster = "group"))


##############################################

stargazer(fixed_effects_car, fixed_effects_car3, 
     
     fixed_effects_car5, random_effects_car, random_effects_car3, random_effects_car5,
     
     title = "Regression Output for Capital to Assets Ratio (Standard Errors in Brackets)", 
     
     align = TRUE, font.size = "tiny", header = FALSE, 
     
     se = list(inference_m201[,2], inference_m211[,2], inference_m221[,2], 
     
     inference_m231[,2], inference_m241[,2], inference_m251[,2]),
     
     omit = c("year.", "Constant"),
     
     add.lines = list(c("Model", "Within", "Within", "Within", 
            
            "Random", "Random", "Random"), 
     
     c("Data", "Full", ">=3 Years", ">=5 Years", 
      
      "Full", ">=3 Years", ">=5 Years")))
```

\elandscape


### Drivers of Deposits to Total Assets
The deposits to assets ratio has a positive relationship with MFI legal form, age, asset structure, size proxied by the logarithm of assets, and profit margin (see Table 6. 7). Significant drivers of the deposits to assets ratio at the country level are legal tradition and institutional quality, KKM. Proxies for capital markets development, that is, private credit to GDP and stock markets capitalisation to GDP do not significantly affect the ratio. We discuss these relationships next. 

#### Current Legal Status
NGOs have lower deposits to assets ratio than commercial banks, credit unions, NBFIs, and rural banks. These results may arise out of the different business models followed by different legal forms of MFIs. NGOs have taken root dependent on donations and subsidies with little emphasis on deposits mobilisation [@d2013unsubsidized; @d2017ngos]. Also, NGOs face legal restrictions on deposit mobilisation given that most are not under the supervision of central banks. Credit unions, on the other hand, thrive on taking deposits from members making them have higher capacity for deposit mobilisation than NGOs [@lauer2008transforming]. As expected, rural banks, commercial banks and cooperatives have the highest mean and median deposits ratios. Like credit unions, commercial banks actively seek donations and are licensed to do so. Hence, commercial banks have higher levels of deposits-driven leverage than NGOs [@abbas2020commercial].

#### Age
Older MFIs have higher deposits to assets ratio than younger MFIs. This result reflects the more comprehensive regional presence of older, larger MFIs, which aligns with the capital structure theory [@barclay2005capital; @barclay2006debt] and enhanced goodwill from the public. Also, older MFIs have invested in information technology to reach people in remote locations [@di2021technology]. Again, older MFIs are likely to have attained deposit mobilisation licenses from relevant regulatory bodies like central banks. The results are in line with capital structure theory, where the size of an MFI, which is also positively related to age, has a significant relationship with leverage. For most financial intermediaries, the largest deposits are the largest source of debt financing [@gale2020bank]. 

#### Legal Tradition
MFIs in countries with civil law and other legal traditions tend to have a higher deposit to assets ratio than those in common law countries, with MFIs in civil law countries having the highest proportion. It means that MFIs in common law countries finance their operations using more equity than civil law countries. These results are in line with the higher levels of capital markets development in common law countries [@la2013law; @schnyder2018twenty] that allows MFIs to quickly raise equity capital and debt capital in a form other than deposits. 

#### Institutional Quality (KKM)
The institutional quality or governance (KKM) has a weak negative relationship with the deposits to assets ratio, holding all other variables constant. In other words, MFIs located in countries with better governance rely less on deposits and more on alternative forms of finance, namely equity and debt, than MFIs with lower governance metrics. These results would imply that as institutional quality improves, people are less likely to maintain deposits, and instead, prefer the capital markets and other sorts of investments. The argument will hold if KKM supports the development of financial and other markets that facilitates investments with better returns than bank deposits offer [@la2013law; @schnyder2018twenty]. Indeed, although primarily insignificant, the degree of capital market development has a negative relationship with the deposits to assets ratio, which could render credence to the argument. Also, with better-developed capital markets, MFIs can access finance from other sources, lowering the relative importance of deposits. 

#### Asset Structure
Asset structure or asset tangibility has a mixed relationship with deposits to assets ratio, ceteris paribus. However, capital structure theory shows that firms can use tangible assets as collateral for debt funding. Thus, firms with more tangible assets usually have more debt at a lower cost than firms with less tangible assets [@campello2011capital; @ombati2016effects]. However, the rise of information technology means that MFIs no longer have to hold high tangible (fixed) assets, especially in property, plant and equipment, to reach the unbanked population [@asadullah2021access]. Except for older firms that had already invested in many branches before information technology took root, asset structure is likely insignificant in deposits mobilisation [@di2021technology]. 

#### Profit Margin
Profit margin has a positive but very weak positive relationship with deposits to assets ratio. The result could hold that profitable MFIs reach more consumers by opening more branches or investing more in information technology [@di2021technology]. Moreover, in line with the capital structure theory, Profitable firms are usually large and mature with free cash flows to support debt repayment and thus hold more debt. Firms take up debt to minimise cash that managers could misallocate. The debtholders act as delegated monitors and further monitor management [@barclay2005capital; @gwatidzo2009corporate; @ombati2016effects]. Finally, both stock market capitalisation to GDP and private credit to GDP has no significant effect on the deposits to assets ratio. 


\blandscape

```{r, results = "asis", eval = TRUE, echo=FALSE, warning=FALSE, message=FALSE}

fixed_effects_depo <- modelling(data = my_data, depvar = my_data$deposits_to_total_assets)

fixed_effects_depo3 <- modelling(data = data3, depvar = data3$deposits_to_total_assets)

fixed_effects_depo5 <- modelling(data = data5, depvar = data5$deposits_to_total_assets)

random_effects_depo <- modelling(data = my_data, depvar = my_data$deposits_to_total_assets, model = "random")

random_effects_depo3 <- modelling(data = data3, depvar = data3$deposits_to_total_assets, model = "random")

random_effects_depo5 <- modelling(data = data5, depvar = data5$deposits_to_total_assets, model = "random")

pooling_depo <- modelling(data = my_data, depvar = my_data$deposits_to_total_assets, model = "pooling")

####################################################
##############################################
inference_m301 <- coeftest(fixed_effects_depo, vcov = vcovBK(fixed_effects_depo, method = "arellano", type="HC1", cluster = "group"))

inference_m311 <- coeftest(fixed_effects_depo3, vcov = vcovBK(fixed_effects_depo3, method = "arellano", type="HC1", cluster = "group"))

inference_m321 <- coeftest(fixed_effects_depo5 , vcov = vcovBK(fixed_effects_depo5, method = "arellano", type="HC1", cluster = "group"))

inference_m331 <- coeftest(random_effects_depo, vcov = vcovBK(random_effects_depo, method = "arellano", type="HC1", cluster = "group"))

inference_m341 <- coeftest(random_effects_depo3, vcov = vcovBK(random_effects_depo3, method = "arellano", type="HC1", cluster = "group"))

inference_m351 <- coeftest(random_effects_depo5, vcov = vcovBK(random_effects_depo5, method = "arellano", type="HC1", cluster = "group"))
####################################################


stargazer(fixed_effects_depo, fixed_effects_depo3, 
     
     fixed_effects_depo5, random_effects_depo, 
     
     random_effects_depo3, random_effects_depo5,
     
     title = "Regression Output for Deposits to Assets Ratio (Standard Errors in Brackets)", 
     
     align = TRUE, font.size = "tiny", header = FALSE, 
     
     se = list(inference_m301[,2], inference_m311[,2], inference_m321[,2], 
     
     inference_m331[,2], inference_m341[,2], inference_m351[,2]),
     
     omit = c("year.", "Constant"),
     
     add.lines = list(c("Model", "Within", "Within", "Within", 
            
      "Random", "Random", "Random"), 
      
      c("Data", "Full", ">=3 Years", ">=5 Years", 
                       
      "Full", ">=3 Years", ">=5 Years")))
```

\elandscape


### Drivers of Donations to Assets Ratio
In Table 6. 9, donations to assets ratio show the most robust relationship with the variables in the regression, except for stock market to GDP ratio. We discuss these relationships next. 

#### Current legal status 
Compared to other legal forms of MFIs, NGOs have the highest proportion of donations to assets. The result is expected because the microfinance industry started as a not-for-profit model with NGO as the legal form of choice [@d2017ngos]. These pioneer NGOs have developed relationships with donors over time than the younger MFIs. Hence, donations are likely to flow to these NGOs from the donors still keen on the welfare approach to microfinance where outreach to the financially excluded is more important than profitability. Late entrants into the microfinance industry find a changed landscape where financial sustainability is also important and hence have to resort to commercial funding [@d2013unsubsidized; @armendariz2013subsidy]. 

#### Age
Older, larger firms have smaller donations to assets ratio than younger, smaller firms. The result holds due to the relatively larger assets base of older MFIs. Table 6. 8 shows that older MFIs (that is, young and mature) still receive more donations in absolute terms than younger ones. Hence, as MFIs grow, the relative importance of contributions diminishes as they build their asset base. However, older MFIs still retain a stronger financial relationship with donors [@armendariz2013subsidy; @cgap2017].

```{r, echo = FALSE, message = FALSE, warning = FALSE}
my_data %>% 
 
 group_by(age) %>% 
 
 summarise(Donations = mean(donations),
      Donations_Assets = mean(donations_assets_ratio), 
      Donations1 = median(donations),
      Donations_Assets1 = median(donations_assets_ratio)) %>% 
 
 set_names(names(.) %>% str_to_sentence()) %>% 
 
 knitr::kable(caption = "Mean and Median Donations and Donations to Assets Ratio", 
        
        booktabs = TRUE) %>% 
 
 add_header_above(c("."=1, "Mean" = 2, "Median" = 2)) %>% 
 
 kable_classic(full_width = TRUE, font_size = 9) %>% 
 
 footnote(number = "Younger MFIs have higher donations to assets ratios but lower absolute donations", 
      
      number_title = "Notes",
  
      general = "Source: Authors' construction from the literature",
      
      general_title = "") 
 

 
 
```

#### Legal tradition
MFIs located in common law countries have higher and statistically significant donations to assets ratio than those in civil law countries. The theoretical link, in this case, is that from the law and finance literature where common law countries exhibit higher levels of financial development [@la2013law; @schnyder2018twenty]. The higher levels of financial development further derive from the better institutional quality. MFIs in countries with better institutional quality are more likely to attract donations, presumably because there is a lower incidence of corruption which may drive donors away. The following section shows that institutional quality positively relates to the donations to assets ratio [@huang2010political].

#### Institutional Quality (KKM)
As the relationship between legal tradition and donations implies, institutional quality has a positive relationship with the donations to assets ratio. The result shows that donors care about the relative levels of accountability in a country before choosing to donate funds to MFIs because there is a higher likelihood that the cash will benefit the intended target, the financially excluded [@kaufmann2011worldwide; @huang2010political]. 

#### Asset structure
Asset structure has a positive relationship with the donations to assets ratio. It follows that MFIs with more property, plant and equipment, which implies they are larger and older, receive more donations than their assets [@cull2018microfinance]. These results could hold given that, as noted earlier, larger, older firms have a long and elaborate relationship with donors than the relatively younger MFIs. 

#### Private credit to GDP
MFIs located in countries with better-developed debt markets have lower donations to assets ratios. For an MFI in a well-developed capital market, there are alternative avenues for raising funds to finance assets that lower donations' relative contribution. Moreover, better developed financial markets could translate to a lower incidence of financial exclusion for donors to fund [@marron2013governing].

#### Profit margin
Profit margin has an inverse relationship with donations to assets ratio. As is the case with private credit to GDP, a more profitable MFI can retain more earnings to finance operations. Consequently, the proportion of donations that goes into financing assets diminishes. Likewise, profitable MFIs are more likely to raise funds from banks which is in line with the capital structure theory [@dorfleitner2017access]. 

\blandscape

```{r, results='asis', echo = FALSE, message = FALSE, warning = FALSE}
fixed_effects_dona <- modelling(data = my_data, depvar = my_data$donations_assets_ratio)

fixed_effects_dona3 <- modelling(data = data3, depvar = data3$donations_assets_ratio)

fixed_effects_dona5 <- modelling(data = data5, depvar = data5$donations_assets_ratio)

random_effects_dona <- modelling(data = my_data, depvar = my_data$donations_assets_ratio, model = "random")

random_effects_dona3 <- modelling(data = data3, depvar = data3$donations_assets_ratio, model = "random")

random_effects_dona5 <- modelling(data = data5, depvar = data5$donations_assets_ratio, model = "random")

pooling_dona <- modelling(data = my_data, depvar = my_data$donations_assets_ratio, model = "pooling")

####################################################
inference_m401 <- coeftest(fixed_effects_dona, vcov = vcovBK(fixed_effects_dona, method = "arellano", type="HC1", cluster = "group"))

inference_m411 <- coeftest(fixed_effects_dona3, vcov = vcovBK(fixed_effects_dona3, method = "arellano", type="HC1", cluster = "group"))

inference_m421 <- coeftest(fixed_effects_dona5, vcov = vcovBK(fixed_effects_dona5, method = "arellano", type="HC1", cluster = "group"))

inference_m431 <- coeftest(random_effects_dona, vcov = vcovBK(random_effects_dona, method = "arellano", type="HC1", cluster = "group"))

inference_m441 <- coeftest(random_effects_dona3, vcov = vcovBK(random_effects_dona3, method = "arellano", type="HC1", cluster = "group"))

inference_m451 <- coeftest(random_effects_dona5, vcov = vcovBK(random_effects_dona5, method = "arellano", type="HC1", cluster = "group"))
####################################################


stargazer(fixed_effects_dona, fixed_effects_dona3, 
     
     fixed_effects_dona5, random_effects_dona, 
     
     random_effects_dona3, random_effects_dona5,
     
     title = "Regression Output for Donations to Assets Ratio (Standard Errors in Brackets)", 
     
     align = TRUE, font.size = "tiny", header = FALSE, 
     
     se = list(inference_m401[,2], inference_m411[,2], inference_m421[,2], 
     
     inference_m431[,2], inference_m441[,2], inference_m451[,2]),
     
     omit = c("year.", "Constant"),
     
     add.lines = list(c("Model", "Within", "Within", "Within", 
            
      "Random", "Random", "Random"), 
      
      c("Data", "Full", ">=3 Years", ">=5 Years", 
                       
      "Full", ">=3 Years", ">=5 Years")))

```

\elandscape

However, in the Appendix (Table 13), when we winsorise the data to remove outliers, age is no longer an essential driver of donations, which would explain the mixed results in Table 6. 9.


## Robustness Checks 
This section highlights the robustness checks on the models run in four areas: extreme values (outliers), heteroscedasticity, autocorrelation, and cross-sectional dependence. In each case, we discuss the corrective measures taken. 

### Extreme values/ Outliers

The likelihood that extreme values could influence the results is highly likely in a panel setting containing different units [@torres2007panel]. To check whether the outliers affect our inference, we winsorise the data by removing the top 10% and the bottom 10% for each continuous variable used in the regression analysis. We then ran regression models on the new dataset with the results displayed in appendix 2 and 3. 

Age and institutional quality remain essential drivers of the debt to equity ratio. The MFI legal form, asset structure and profit margin are also significant when we remove influential observations. Institutional quality retains its inverse relationship with leverage. Regarding age, the association is the opposite of that observed in the regression using the full dataset, with older MFIs more leveraged, in line with the theory [@barclay2005capital]. The current legal status also becomes a significant driver of leverage, with commercial forms of MFIs having a higher debt to equity ratios. This result is also in line with banking literature where deposits-taking intermediaries have higher leverage [@gale2020bank]. Asset structure is also a significant driver of leverage in MFIs, although the direction of the relationship is mixed. Profit margin has a positive relationship with leverage, again confirming the theory on capital structure. 

Turning to capital to assets ratio, MFI legal form and age, country legal tradition and stock market capitalisation remain consistent drivers. After removing outliers, institutional quality or governance (KKM), asset structure, and profit margin positively correlate with the capital to assets ratio. Similarly, the legal form of MFI, age, country legal tradition remains consistent drivers of deposits to assets ratio. While asset structure had a mixed relationship with deposits to assets ratio in the full model, the relationship is consistently negative after removing outliers. In contrast, the profit margin has a negative relationship with deposits. Institutional quality, private credit to GDP and stock market capitalisation to GDP are not important drivers of deposits to assets ratio even after removing outliers. For donations, stock market capitalisation to GDP becomes an important driver after removing outliers. In contrast, the sign of the coefficient of private credit changes to positive and that of profit margin becomes positive. 

### Cross-Sectional Dependence and serial correlation

In panel data settings, cross-sectional dependence (CSD) is an important consideration []. CSD arises when there is a correlation between units in the same cross-section, usually due to unobserved common factors that affect all groups, although probably to differing extents. The omission of common elements in the model results in inconsistent estimates for fixed effects, random effects, and even the first difference model [@henningsen2019analysis]. In our case, we run the Breusch-Pagan LM test of independence with the results shown in appendix 4 and 5. The analyses indicate cross-sectional dependence in the regressions with Capital to Total Assets Ratio and Deposits to Total Assets Ratio as the dependent variables.  

Extant research deals with CSD in three main ways. The traditional method is the use of seemingly unrelated regressions (SUR) of @zellner1962further [@arouri2013econometric]. SUR allows for the estimation of the individual coefficient $\beta_{it}$ and hence estimate the effects of the independent variables on the dependent variables for each unit of analysis, in our case, MFIs [@sarafidis2012cross]. Again, the cross-sectional data is not sufficient for SUR analysis. The second method developed by @esaran2021general - the panel mean groups- works by averaging individual coefficients across panels. Hence, the technique requires panel data where each panel has sufficient data for a regression, which is not possible in this study. Therefore, we implement the third approach, the Panel Corrected Standard Errors (PCSE) [@bailey2011implementing; @croissant2008panel]. PCSE is useful when working with heterogeneous dynamic panel data by correcting autocorrelation and cross-sectional dependence while providing more robust standard errors [@ikpesu2019growth]. The results presented have their standard errors corrected for CSD, resulting in heteroscedastic consistent coefficients. 

## Conclusion 

This article examined the drivers of four typical indicators of the financing structure of MFIs in Africa: Debt to equity ratio, capital to assets ratio, Deposits to assets ratio and Donations to assets ratio. The results show that the size, legal status, and age of MFIs are consistently related to the financing structure. Profit margin is directly related to leverage and inversely to capital to assets ratio, as capital structure theory predicts. Institutional quality (KKM) pertains mainly to deposits and donations, with lower KKM corresponding to more deposits and donations. Education and asset structure relate weakly to leverage, while financial development is surprisingly not a significant factor that contradicts stylized facts on firms' capital structure.  For MFIs, it is the institutional level factors that drive the financing structure. Overall, microfinance in Africa shows a weak linkage to the macro-economy, that is, macroeconomic determinants vis=a-vis the macroeconomic drivers of MFIs activities. 

\newpage 

## Appendix

### Appendix 1: Results of the Hausmann Test

```{r, echo = FALSE, message = FALSE, warning = FALSE}
rbind(hausmann_test(my_data, my_data$debt_to_equity_ratio),

hausmann_test(my_data, my_data$capital_asset_ratio),

hausmann_test(my_data, my_data$deposits_to_total_assets),

hausmann_test(my_data, my_data$donations_assets_ratio)

) %>% 
  
  tibble() %>% 
  
  mutate(Variable = c("Debt-Equity Ratio", "Capital/Asset Ratio", "Deposits/Assets Ratio", 
                      "Donations/Assets Ratio")) %>% 
  
  relocate(Variable) %>% 
  
  set_names(names(.) %>% str_to_sentence()) %>% 
  
  kbl(., caption = "Hausmann Tests", booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9, 
                
                latex_options = "hold_position") %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "", 
           
           number = "Alternative Hypothesis: One model is inconsistent",
           
           number_title = "Note: ")
```

### Appendix 2: Multicollinearity: Variance Inflation Factors

```{r, echo = FALSE, message = FALSE, warning = FALSE}
## Variance Inflation factors
vif1 <- car::vif(random_effects_car)
vif2 <- car::vif(random_effects_de)
vif_final <- cbind(vif1, vif2)
vif_final %>% 
  
  kbl(., caption = "Variance Inflation Factors", booktabs = TRUE) %>% 
  
  kable_classic(full_width = TRUE, font_size = 9, latex_options = "hold_position") %>% 
  
  footnote(general = "Source: Authors' construction from MIX data",
           
           general_title = "", 
           
           number = "The first three rows show VIF for the model on capital asset ratio followed by debt-equity ratio",
           
           number_title = "Note: ")
```


\newpage

\blandscape



```{r, results='asis', fig.cap = "Regressions Using Winsorized Data for Leverage and Capital to Assets Ratio", echo = FALSE, message = FALSE, warning = FALSE}
fixed_effects_car_wins <- modelling(data = data_wins, depvar = data_wins$debt_to_equity_ratio)

random_effects_car_wins <- modelling(data = data_wins, depvar = data_wins$debt_to_equity_ratio, model = "random")

fixed_effects_de_wins <- modelling(data = data_wins, depvar = data_wins$capital_asset_ratio)

random_effects_de_wins <- modelling(data = data_wins, depvar = data_wins$capital_asset_ratio, model = "random")

############################################
inference_m501 <- coeftest(fixed_effects_car_wins, vcov = vcovBK(fixed_effects_car_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m511 <- coeftest(random_effects_car_wins, vcov = vcovBK(random_effects_car_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m521 <- coeftest(fixed_effects_de_wins, vcov = vcovBK(fixed_effects_de_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m531 <- coeftest(random_effects_de_wins, vcov = vcovBK(random_effects_de_wins, method = "arellano", type="HC1", cluster = "group"))
################################################

stargazer(fixed_effects_car_wins, random_effects_car_wins, 
          
          fixed_effects_de_wins, random_effects_de_wins,
          
          title = "Regression Output for Winsorized Data (Standard Errors in Brackets)", 
          
          dep.var.labels = "Fixed and Random Effects with Leverage and Capital to Assets Ratio",
          
          se = list(inference_m501[,2], inference_m511[,2], inference_m521[,2], 
          
          inference_m531[,2]),
          
          align = TRUE, font.size = "tiny", header = FALSE, 
          
          omit = c("year.", "Constant"),
          
          add.lines = list(c("Model", "Within", "Random", "Within", 
                        
                        "Random"), 
                        
          c("Dependent Variable", "Debt/Equity", "Debt/Equity",
                          
                          "Capital/Assets", "Capital/Assets"),
          
          c("Data", "Winsorized", "Winsorized", 
            
            "Winsorized", "Winsorized")))

         
```

\elandscape

\newpage

\blandscape


```{r, results='asis', fig.cap = "Regressions Using Winsorized Data for Deposits and Donations", echo = FALSE, message = FALSE, warning = FALSE}
fixed_effects_deposits_wins <- modelling(data = data_wins, depvar = data_wins$deposits_to_total_assets)

random_effects_deposits_wins <- modelling(data = data_wins, depvar = data_wins$deposits_to_total_assets, model = "random")

fixed_effects_donations_wins <- modelling(data = data_wins, depvar = data_wins$donations_assets_ratio)

random_effects_donations_wins <- modelling(data = data_wins, depvar = data_wins$donations_assets_ratio, model = "random")

######################################
inference_m601 <- coeftest(fixed_effects_deposits_wins, vcov = vcovBK(fixed_effects_deposits_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m611 <- coeftest(random_effects_deposits_wins, vcov = vcovBK(random_effects_deposits_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m621 <- coeftest(fixed_effects_donations_wins, vcov = vcovBK(fixed_effects_donations_wins, method = "arellano", type="HC1", cluster = "group"))

inference_m631 <- coeftest(random_effects_donations_wins, vcov = vcovBK(random_effects_donations_wins, method = "arellano", type="HC1", cluster = "group"))
####################################################


stargazer(fixed_effects_car_wins, random_effects_car_wins, 
          
          fixed_effects_de_wins, random_effects_de_wins,
          
          title = "Regression Output for Winsorized Data (Standard Errors in Brackets)", 
          
          dep.var.labels = "Fixed and Random Effects with Deposits and Donations",
          
          se = list(inference_m601[,2], inference_m611[,2], inference_m621[,2], 
          
          inference_m631[,2]),
          
          align = TRUE, font.size = "tiny", header = FALSE, 
          
          omit = c("year.", "Constant"),
          
          add.lines = list(c("Model", "Within", "Random", "Within", 
                        
                        "Random"), 
                        
                        c("Dependent Variable", "Deposits/Assets", "Deposits/Assets",
                          
                          "Donations/Assets", "Donations/Assets"),
          
          c("Data", "Winsorized", "Winsorized", 
            
            "Winsorized", "Winsorized")))

         
```


\elandscape








